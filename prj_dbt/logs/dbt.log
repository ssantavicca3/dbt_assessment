

============================== 2022-05-04 17:13:51.584279 | 3390b366-2160-4e1d-abd7-6f061a379dd1 ==============================
17:13:51.584279 [info ] [MainThread]: Running with dbt=1.1.0
17:13:51.585274 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
17:13:51.586270 [debug] [MainThread]: Tracking: tracking
17:13:51.588263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC93D35BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC93D35AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC93D35A00>]}
17:13:51.631329 [debug] [MainThread]: Executing "git --help"
17:13:51.734783 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:13:51.735768 [debug] [MainThread]: STDERR: "b''"
17:13:51.739755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC93D095E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC93D09760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC93D09D30>]}


============================== 2022-05-04 17:14:48.403125 | 6b455aee-242d-4fa0-8bc1-54e63566e306 ==============================
17:14:48.403125 [info ] [MainThread]: Running with dbt=1.1.0
17:14:48.405128 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
17:14:48.405128 [debug] [MainThread]: Tracking: tracking
17:14:48.406121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B521F05AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B521F05AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B521F05A00>]}
17:14:49.681064 [debug] [MainThread]: Executing "git --help"
17:14:49.826115 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:14:49.826115 [debug] [MainThread]: STDERR: "b''"
17:14:49.830105 [debug] [MainThread]: Acquiring new snowflake connection "debug"
17:14:49.831102 [debug] [MainThread]: Using snowflake connection "debug"
17:14:49.831102 [debug] [MainThread]: On debug: select 1 as id
17:14:49.831102 [debug] [MainThread]: Opening a new connection, currently in state init
17:17:05.175502 [debug] [MainThread]: Snowflake adapter: Got an error when attempting to open a snowflake connection. No retries attempted: '250001 (08001): Failed to connect to DB. Verify the account name is correct: uq97337.east-us-2.azure.snowflakecomputing.com:443. 000403: HTTP 403: Forbidden'
17:17:05.176499 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
17:17:05.176499 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
17:17:05.177497 [debug] [MainThread]: On debug: No close available on handle
17:17:05.180285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52381DEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52381DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52381DD60>]}
17:17:05.352119 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-05-04 17:17:41.058942 | 25a0e06f-31a4-4d99-a2cf-c77a3978fd70 ==============================
17:17:41.058942 [info ] [MainThread]: Running with dbt=1.1.0
17:17:41.061888 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
17:17:41.061888 [debug] [MainThread]: Tracking: tracking
17:17:41.062888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AC255C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AC255AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AC255B50>]}
17:17:42.373135 [debug] [MainThread]: Executing "git --help"
17:17:42.444996 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:17:42.446145 [debug] [MainThread]: STDERR: "b''"
17:17:42.449264 [debug] [MainThread]: Acquiring new snowflake connection "debug"
17:17:42.450261 [debug] [MainThread]: Using snowflake connection "debug"
17:17:42.450261 [debug] [MainThread]: On debug: select 1 as id
17:17:42.450261 [debug] [MainThread]: Opening a new connection, currently in state init
17:17:43.215495 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.77 seconds
17:17:43.218931 [debug] [MainThread]: On debug: Close
17:17:43.373746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AEB4BEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AEBABCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AEBABB50>]}
17:17:43.515493 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-05-04 17:22:03.427676 | 4cdcb5d2-af36-4c43-a54c-c569bc72ad6b ==============================
17:22:03.427676 [info ] [MainThread]: Running with dbt=1.1.0
17:22:03.428674 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:22:03.429669 [debug] [MainThread]: Tracking: tracking
17:22:03.430667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B0AC8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B0AC8D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B0AC8D90>]}
17:22:03.445586 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
17:22:03.447415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4cdcb5d2-af36-4c43-a54c-c569bc72ad6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B0B2EFA0>]}
17:22:03.526983 [debug] [MainThread]: Parsing macros\adapters.sql
17:22:03.572263 [debug] [MainThread]: Parsing macros\catalog.sql
17:22:03.575254 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
17:22:03.587285 [debug] [MainThread]: Parsing macros\materializations\merge.sql
17:22:03.593269 [debug] [MainThread]: Parsing macros\materializations\seed.sql
17:22:03.601248 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
17:22:03.602246 [debug] [MainThread]: Parsing macros\materializations\table.sql
17:22:03.607179 [debug] [MainThread]: Parsing macros\materializations\view.sql
17:22:03.609172 [debug] [MainThread]: Parsing macros\adapters\columns.sql
17:22:03.621204 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
17:22:03.624197 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
17:22:03.629182 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
17:22:03.636173 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
17:22:03.641216 [debug] [MainThread]: Parsing macros\adapters\relation.sql
17:22:03.652379 [debug] [MainThread]: Parsing macros\adapters\schema.sql
17:22:03.654378 [debug] [MainThread]: Parsing macros\etc\datetime.sql
17:22:03.664347 [debug] [MainThread]: Parsing macros\etc\statement.sql
17:22:03.669366 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
17:22:03.671361 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
17:22:03.672358 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
17:22:03.673360 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
17:22:03.674354 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
17:22:03.676392 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
17:22:03.678397 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
17:22:03.680392 [debug] [MainThread]: Parsing macros\materializations\configs.sql
17:22:03.683386 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
17:22:03.687373 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
17:22:03.692364 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
17:22:03.704484 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
17:22:03.705486 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
17:22:03.721604 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
17:22:03.738602 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
17:22:03.741594 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
17:22:03.748911 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
17:22:03.751909 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
17:22:03.754881 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
17:22:03.756865 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
17:22:03.765876 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
17:22:03.782926 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
17:22:03.789946 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
17:22:03.804047 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
17:22:03.815055 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
17:22:03.817077 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
17:22:03.836058 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
17:22:03.838174 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
17:22:03.843148 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
17:22:03.845205 [debug] [MainThread]: Parsing tests\generic\builtin.sql
17:22:04.103628 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
17:22:04.116607 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
17:22:04.177116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cdcb5d2-af36-4c43-a54c-c569bc72ad6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B1B85850>]}
17:22:04.187828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cdcb5d2-af36-4c43-a54c-c569bc72ad6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B0B32220>]}
17:22:04.188824 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:22:04.189821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cdcb5d2-af36-4c43-a54c-c569bc72ad6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B1B3B5E0>]}
17:22:04.192815 [info ] [MainThread]: 
17:22:04.194812 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:22:04.196596 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
17:22:04.214572 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
17:22:04.214572 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
17:22:04.215579 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:22:05.220247 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
17:22:05.221246 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
17:22:05.418562 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:22:05.427567 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:22:05.428532 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
17:22:05.429532 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:22:06.210368 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.78 seconds
17:22:06.211365 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
17:22:06.335113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cdcb5d2-af36-4c43-a54c-c569bc72ad6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B1BB1A60>]}
17:22:06.336177 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:22:06.337146 [info ] [MainThread]: 
17:22:06.355106 [debug] [Thread-1  ]: Began running node model.prj_dbt.my_first_dbt_model
17:22:06.355106 [info ] [Thread-1  ]: 1 of 2 START table model CUSTOMERS.my_first_dbt_model .......................... [RUN]
17:22:06.356089 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.my_first_dbt_model"
17:22:06.357086 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.my_first_dbt_model
17:22:06.357086 [debug] [Thread-1  ]: Compiling model.prj_dbt.my_first_dbt_model
17:22:06.360079 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.my_first_dbt_model"
17:22:06.364071 [debug] [Thread-1  ]: finished collecting timing info
17:22:06.365069 [debug] [Thread-1  ]: Began executing node model.prj_dbt.my_first_dbt_model
17:22:06.398633 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.my_first_dbt_model"
17:22:06.404587 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.my_first_dbt_model"
17:22:06.404587 [debug] [Thread-1  ]: On model.prj_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.my_first_dbt_model"} */


      create or replace transient table FLEETIO_DBT.CUSTOMERS.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
17:22:06.405623 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:22:08.614067 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.21 seconds
17:22:08.625213 [debug] [Thread-1  ]: finished collecting timing info
17:22:08.626256 [debug] [Thread-1  ]: On model.prj_dbt.my_first_dbt_model: Close
17:22:08.748344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cdcb5d2-af36-4c43-a54c-c569bc72ad6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B1DD4310>]}
17:22:08.749368 [info ] [Thread-1  ]: 1 of 2 OK created table model CUSTOMERS.my_first_dbt_model ..................... [[32mSUCCESS 1[0m in 2.39s]
17:22:08.750340 [debug] [Thread-1  ]: Finished running node model.prj_dbt.my_first_dbt_model
17:22:08.753331 [debug] [Thread-3  ]: Began running node model.prj_dbt.my_second_dbt_model
17:22:08.754334 [info ] [Thread-3  ]: 2 of 2 START view model CUSTOMERS.my_second_dbt_model .......................... [RUN]
17:22:08.755331 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.my_second_dbt_model"
17:22:08.756386 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.my_second_dbt_model
17:22:08.756494 [debug] [Thread-3  ]: Compiling model.prj_dbt.my_second_dbt_model
17:22:08.759325 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.my_second_dbt_model"
17:22:08.760323 [debug] [Thread-3  ]: finished collecting timing info
17:22:08.761320 [debug] [Thread-3  ]: Began executing node model.prj_dbt.my_second_dbt_model
17:22:08.790603 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.my_second_dbt_model"
17:22:08.793567 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.my_second_dbt_model"
17:22:08.793567 [debug] [Thread-3  ]: On model.prj_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.my_second_dbt_model"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from FLEETIO_DBT.CUSTOMERS.my_first_dbt_model
where id = 1
  );
17:22:08.793567 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:22:09.661693 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.87 seconds
17:22:09.663688 [debug] [Thread-3  ]: finished collecting timing info
17:22:09.663688 [debug] [Thread-3  ]: On model.prj_dbt.my_second_dbt_model: Close
17:22:09.780394 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cdcb5d2-af36-4c43-a54c-c569bc72ad6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B1D7DA00>]}
17:22:09.781404 [info ] [Thread-3  ]: 2 of 2 OK created view model CUSTOMERS.my_second_dbt_model ..................... [[32mSUCCESS 1[0m in 1.03s]
17:22:09.782389 [debug] [Thread-3  ]: Finished running node model.prj_dbt.my_second_dbt_model
17:22:09.785381 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:22:09.785381 [info ] [MainThread]: 
17:22:09.786378 [info ] [MainThread]: Finished running 1 table model, 1 view model in 5.59s.
17:22:09.787407 [debug] [MainThread]: Connection 'master' was properly closed.
17:22:09.787407 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
17:22:09.787407 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
17:22:09.788405 [debug] [MainThread]: Connection 'model.prj_dbt.my_first_dbt_model' was properly closed.
17:22:09.788405 [debug] [MainThread]: Connection 'model.prj_dbt.my_second_dbt_model' was properly closed.
17:22:09.800343 [info ] [MainThread]: 
17:22:09.801339 [info ] [MainThread]: [32mCompleted successfully[0m
17:22:09.802337 [info ] [MainThread]: 
17:22:09.804332 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
17:22:09.805328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B0B012B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B1BB1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B1F33AF0>]}


============================== 2022-05-04 17:47:22.570341 | e1560568-14d5-4c5f-8b64-eaf19f44b233 ==============================
17:47:22.570341 [info ] [MainThread]: Running with dbt=1.1.0
17:47:22.571344 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:47:22.572343 [debug] [MainThread]: Tracking: tracking
17:47:22.572343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7334489A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F733448A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F733448A60>]}
17:47:22.641182 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
17:47:22.642181 [debug] [MainThread]: Partial parsing: deleted file: prj_dbt://models\example\my_first_dbt_model.sql
17:47:22.642181 [debug] [MainThread]: Partial parsing: deleted file: prj_dbt://models\example\my_second_dbt_model.sql
17:47:22.646138 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

17:47:22.662126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1560568-14d5-4c5f-8b64-eaf19f44b233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F733532F10>]}
17:47:22.670095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1560568-14d5-4c5f-8b64-eaf19f44b233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F733510EE0>]}
17:47:22.671075 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:47:22.672071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1560568-14d5-4c5f-8b64-eaf19f44b233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F733510E20>]}
17:47:22.672071 [info ] [MainThread]: 
17:47:22.673068 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
17:47:22.681047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73351ED60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F733510D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F733510DF0>]}


============================== 2022-05-04 18:00:32.990307 | 4922347b-9789-4365-9a18-3c2f9d12fe1c ==============================
18:00:32.990307 [info ] [MainThread]: Running with dbt=1.1.0
18:00:32.991305 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
18:00:32.992272 [debug] [MainThread]: Tracking: tracking
18:00:32.993271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11E8C8C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11E8C8CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11E8B1910>]}
18:00:33.058128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
18:00:33.058128 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\example\schema.yml
18:00:33.065107 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
18:00:33.068070 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
18:00:33.103007 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.unique_my_first_dbt_model_id.16e066b321' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
18:00:33.104007 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_my_first_dbt_model_id.5fb22c2710' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
18:00:33.105005 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.unique_my_second_dbt_model_id.57a0f8c493' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
18:00:33.105969 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_my_second_dbt_model_id.151b76d778' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
18:00:33.111990 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

18:00:33.122926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4922347b-9789-4365-9a18-3c2f9d12fe1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11EA15DC0>]}
18:00:33.132896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4922347b-9789-4365-9a18-3c2f9d12fe1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11E988AF0>]}
18:00:33.133894 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:00:33.134914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4922347b-9789-4365-9a18-3c2f9d12fe1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11E988A30>]}
18:00:33.135892 [info ] [MainThread]: 
18:00:33.136897 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
18:00:33.146860 [info ] [MainThread]: 
18:00:33.147858 [info ] [MainThread]: [32mCompleted successfully[0m
18:00:33.148854 [info ] [MainThread]: 
18:00:33.150848 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
18:00:33.151846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11E927FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11E927C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11E988A60>]}


============================== 2022-05-04 18:04:25.080873 | f7d6b85c-cc27-47ab-87b4-b7e3f6a31ab3 ==============================
18:04:25.080873 [info ] [MainThread]: Running with dbt=1.1.0
18:04:25.081872 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
18:04:25.082853 [debug] [MainThread]: Tracking: tracking
18:04:25.082853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C7497D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C7497D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C7497DC0>]}
18:04:25.152684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
18:04:25.153679 [debug] [MainThread]: Partial parsing: added file: prj_dbt://seeds\opportunities.csv
18:04:25.153679 [debug] [MainThread]: Partial parsing: added file: prj_dbt://seeds\contacts.csv
18:04:25.153679 [debug] [MainThread]: Partial parsing: added file: prj_dbt://seeds\accounts.csv
18:04:25.154676 [debug] [MainThread]: Partial parsing: added file: prj_dbt://seeds\leads.csv
18:04:25.187560 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

18:04:25.195536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7d6b85c-cc27-47ab-87b4-b7e3f6a31ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C75E3760>]}
18:04:25.205511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7d6b85c-cc27-47ab-87b4-b7e3f6a31ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C756F790>]}
18:04:25.206508 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
18:04:25.206508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7d6b85c-cc27-47ab-87b4-b7e3f6a31ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C756F6D0>]}
18:04:25.208526 [info ] [MainThread]: 
18:04:25.209499 [debug] [MainThread]: Acquiring new snowflake connection "master"
18:04:25.211494 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
18:04:25.231441 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
18:04:25.231441 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
18:04:25.231441 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:04:25.973573 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.74 seconds
18:04:25.975579 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
18:04:26.353947 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
18:04:26.362920 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
18:04:26.363918 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
18:04:26.364913 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:04:26.996876 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.63 seconds
18:04:27.000864 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
18:04:27.092143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7d6b85c-cc27-47ab-87b4-b7e3f6a31ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C77C6E50>]}
18:04:27.093115 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:04:27.094100 [info ] [MainThread]: 
18:04:27.104112 [debug] [Thread-1  ]: Began running node seed.prj_dbt.accounts
18:04:27.104112 [debug] [Thread-2  ]: Began running node seed.prj_dbt.contacts
18:04:27.104112 [debug] [Thread-3  ]: Began running node seed.prj_dbt.leads
18:04:27.105127 [info ] [Thread-1  ]: 1 of 4 START seed file CUSTOMERS.accounts ...................................... [RUN]
18:04:27.105127 [debug] [Thread-4  ]: Began running node seed.prj_dbt.opportunities
18:04:27.106068 [info ] [Thread-2  ]: 2 of 4 START seed file CUSTOMERS.contacts ...................................... [RUN]
18:04:27.106068 [info ] [Thread-3  ]: 3 of 4 START seed file CUSTOMERS.leads ......................................... [RUN]
18:04:27.108089 [debug] [Thread-1  ]: Acquiring new snowflake connection "seed.prj_dbt.accounts"
18:04:27.108089 [info ] [Thread-4  ]: 4 of 4 START seed file CUSTOMERS.opportunities ................................. [RUN]
18:04:27.111055 [debug] [Thread-2  ]: Acquiring new snowflake connection "seed.prj_dbt.contacts"
18:04:27.111055 [debug] [Thread-1  ]: Began compiling node seed.prj_dbt.accounts
18:04:27.112055 [debug] [Thread-3  ]: Acquiring new snowflake connection "seed.prj_dbt.leads"
18:04:27.113057 [debug] [Thread-2  ]: Began compiling node seed.prj_dbt.contacts
18:04:27.113057 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.prj_dbt.opportunities"
18:04:27.114075 [debug] [Thread-1  ]: finished collecting timing info
18:04:27.114075 [debug] [Thread-3  ]: Began compiling node seed.prj_dbt.leads
18:04:27.115043 [debug] [Thread-2  ]: finished collecting timing info
18:04:27.115043 [debug] [Thread-4  ]: Began compiling node seed.prj_dbt.opportunities
18:04:27.116045 [debug] [Thread-1  ]: Began executing node seed.prj_dbt.accounts
18:04:27.116045 [debug] [Thread-3  ]: finished collecting timing info
18:04:27.117038 [debug] [Thread-2  ]: Began executing node seed.prj_dbt.contacts
18:04:27.117038 [debug] [Thread-4  ]: finished collecting timing info
18:04:27.142992 [debug] [Thread-3  ]: Began executing node seed.prj_dbt.leads
18:04:27.155967 [debug] [Thread-4  ]: Began executing node seed.prj_dbt.opportunities
18:04:27.274363 [debug] [Thread-1  ]: Using snowflake connection "seed.prj_dbt.accounts"
18:04:27.274363 [debug] [Thread-1  ]: On seed.prj_dbt.accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "seed.prj_dbt.accounts"} */

    create table FLEETIO_DBT.CUSTOMERS.accounts (id text,company text,primary_contact_id text,country text,state text,city text,industry text,fleet_size text)
18:04:27.275362 [debug] [Thread-1  ]: Opening a new connection, currently in state init
18:04:27.281378 [debug] [Thread-2  ]: Using snowflake connection "seed.prj_dbt.contacts"
18:04:27.281378 [debug] [Thread-2  ]: On seed.prj_dbt.contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "seed.prj_dbt.contacts"} */

    create table FLEETIO_DBT.CUSTOMERS.contacts (id text,first_name text,last_name text,job_title text,email text,account_id text,lead_id text,created_at timestamp without time zone)
18:04:27.281378 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:04:27.287368 [debug] [Thread-4  ]: Using snowflake connection "seed.prj_dbt.opportunities"
18:04:27.288358 [debug] [Thread-4  ]: On seed.prj_dbt.opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "seed.prj_dbt.opportunities"} */

    create table FLEETIO_DBT.CUSTOMERS.opportunities (id text,account_id text,created_at timestamp without time zone,closed_at timestamp without time zone,is_closed boolean,is_won boolean,country text,state text,city text)
18:04:27.288358 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:04:27.292347 [debug] [Thread-3  ]: Using snowflake connection "seed.prj_dbt.leads"
18:04:27.292347 [debug] [Thread-3  ]: On seed.prj_dbt.leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "seed.prj_dbt.leads"} */

    create table FLEETIO_DBT.CUSTOMERS.leads (id text,first_name text,last_name text,job_title text,email text,company text,created_at timestamp without time zone,converted_at timestamp without time zone,source text,country text,city text,state text,industry text,fleet_size text)
18:04:27.293357 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:04:28.184513 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.9 seconds
18:04:28.216466 [debug] [Thread-2  ]: Using snowflake connection "seed.prj_dbt.contacts"
18:04:28.217427 [debug] [Thread-2  ]: On seed.prj_dbt.contacts: BEGIN
18:04:28.222432 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.95 seconds
18:04:28.241393 [debug] [Thread-1  ]: Using snowflake connection "seed.prj_dbt.accounts"
18:04:28.243359 [debug] [Thread-1  ]: On seed.prj_dbt.accounts: BEGIN
18:04:28.328578 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.11 seconds
18:04:28.361522 [debug] [Thread-2  ]: Using snowflake connection "seed.prj_dbt.contacts"
18:04:28.361522 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
18:04:28.362341 [debug] [Thread-2  ]: On seed.prj_dbt.contacts: insert into FLEETIO_DBT.CUSTOMERS.contacts (id, first_name, last_name, job_title, email, account_id, lead_id, created_at) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,...
18:04:28.395286 [debug] [Thread-1  ]: Using snowflake connection "seed.prj_dbt.accounts"
18:04:28.396255 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.11 seconds
18:04:28.411213 [debug] [Thread-1  ]: On seed.prj_dbt.accounts: insert into FLEETIO_DBT.CUSTOMERS.accounts (id, company, primary_contact_id, country, state, city, industry, fleet_size) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%...
18:04:28.412210 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.12 seconds
18:04:28.430188 [debug] [Thread-4  ]: Using snowflake connection "seed.prj_dbt.opportunities"
18:04:28.490034 [debug] [Thread-3  ]: Using snowflake connection "seed.prj_dbt.leads"
18:04:28.492029 [debug] [Thread-4  ]: On seed.prj_dbt.opportunities: BEGIN
18:04:28.493993 [debug] [Thread-3  ]: On seed.prj_dbt.leads: BEGIN
18:04:28.692673 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.19 seconds
18:04:28.694656 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.2 seconds
18:04:28.792379 [debug] [Thread-4  ]: Using snowflake connection "seed.prj_dbt.opportunities"
18:04:28.804346 [debug] [Thread-4  ]: On seed.prj_dbt.opportunities: insert into FLEETIO_DBT.CUSTOMERS.opportunities (id, account_id, created_at, closed_at, is_closed, is_won, country, state, city) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
18:04:28.910064 [debug] [Thread-3  ]: Using snowflake connection "seed.prj_dbt.leads"
18:04:28.911073 [debug] [Thread-3  ]: On seed.prj_dbt.leads: insert into FLEETIO_DBT.CUSTOMERS.leads (id, first_name, last_name, job_title, email, company, created_at, converted_at, source, country, city, state, industry, fleet_size) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
18:04:29.757878 [debug] [Thread-4  ]: SQL status: SUCCESS 461 in 0.92 seconds
18:04:29.758844 [debug] [Thread-4  ]: Using snowflake connection "seed.prj_dbt.opportunities"
18:04:29.758844 [debug] [Thread-4  ]: On seed.prj_dbt.opportunities: COMMIT
18:04:29.763858 [debug] [Thread-2  ]: SQL status: SUCCESS 461 in 1.37 seconds
18:04:29.764899 [debug] [Thread-2  ]: Using snowflake connection "seed.prj_dbt.contacts"
18:04:29.764899 [debug] [Thread-2  ]: On seed.prj_dbt.contacts: COMMIT
18:04:29.999602 [debug] [Thread-1  ]: SQL status: SUCCESS 461 in 1.57 seconds
18:04:30.000560 [debug] [Thread-1  ]: Using snowflake connection "seed.prj_dbt.accounts"
18:04:30.000560 [debug] [Thread-1  ]: On seed.prj_dbt.accounts: COMMIT
18:04:30.132785 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.37 seconds
18:04:30.137755 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.prj_dbt.opportunities"
18:04:30.157701 [debug] [Thread-4  ]: finished collecting timing info
18:04:30.158699 [debug] [Thread-4  ]: On seed.prj_dbt.opportunities: Close
18:04:30.159697 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.39 seconds
18:04:30.162034 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.prj_dbt.contacts"
18:04:30.167045 [debug] [Thread-2  ]: finished collecting timing info
18:04:30.167045 [debug] [Thread-2  ]: On seed.prj_dbt.contacts: Close
18:04:30.236824 [debug] [Thread-3  ]: SQL status: SUCCESS 946 in 1.32 seconds
18:04:30.237823 [debug] [Thread-3  ]: Using snowflake connection "seed.prj_dbt.leads"
18:04:30.237823 [debug] [Thread-3  ]: On seed.prj_dbt.leads: COMMIT
18:04:30.270764 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7d6b85c-cc27-47ab-87b4-b7e3f6a31ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C78F9910>]}
18:04:30.271735 [info ] [Thread-4  ]: 4 of 4 OK loaded seed file CUSTOMERS.opportunities ............................. [[32mINSERT 461[0m in 3.16s]
18:04:30.272728 [debug] [Thread-4  ]: Finished running node seed.prj_dbt.opportunities
18:04:30.440529 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.44 seconds
18:04:30.443498 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.prj_dbt.accounts"
18:04:30.459427 [debug] [Thread-1  ]: finished collecting timing info
18:04:30.460453 [debug] [Thread-1  ]: On seed.prj_dbt.accounts: Close
18:04:30.569580 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7d6b85c-cc27-47ab-87b4-b7e3f6a31ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C7BF7220>]}
18:04:30.570576 [info ] [Thread-2  ]: 2 of 4 OK loaded seed file CUSTOMERS.contacts .................................. [[32mINSERT 461[0m in 3.46s]
18:04:30.571579 [debug] [Thread-2  ]: Finished running node seed.prj_dbt.contacts
18:04:30.583573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7d6b85c-cc27-47ab-87b4-b7e3f6a31ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C7BF70A0>]}
18:04:30.584539 [info ] [Thread-1  ]: 1 of 4 OK loaded seed file CUSTOMERS.accounts .................................. [[32mINSERT 461[0m in 3.48s]
18:04:30.585536 [debug] [Thread-1  ]: Finished running node seed.prj_dbt.accounts
18:04:30.701939 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.46 seconds
18:04:30.702936 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.prj_dbt.leads"
18:04:30.707923 [debug] [Thread-3  ]: finished collecting timing info
18:04:30.707923 [debug] [Thread-3  ]: On seed.prj_dbt.leads: Close
18:04:30.824830 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7d6b85c-cc27-47ab-87b4-b7e3f6a31ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C79332E0>]}
18:04:30.825827 [info ] [Thread-3  ]: 3 of 4 OK loaded seed file CUSTOMERS.leads ..................................... [[32mINSERT 946[0m in 3.71s]
18:04:30.826824 [debug] [Thread-3  ]: Finished running node seed.prj_dbt.leads
18:04:30.829817 [debug] [MainThread]: Acquiring new snowflake connection "master"
18:04:30.829817 [info ] [MainThread]: 
18:04:30.830812 [info ] [MainThread]: Finished running 4 seeds in 5.62s.
18:04:30.831809 [debug] [MainThread]: Connection 'master' was properly closed.
18:04:30.832807 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
18:04:30.832807 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
18:04:30.832807 [debug] [MainThread]: Connection 'seed.prj_dbt.accounts' was properly closed.
18:04:30.832807 [debug] [MainThread]: Connection 'seed.prj_dbt.contacts' was properly closed.
18:04:30.833804 [debug] [MainThread]: Connection 'seed.prj_dbt.leads' was properly closed.
18:04:30.833804 [debug] [MainThread]: Connection 'seed.prj_dbt.opportunities' was properly closed.
18:04:30.844775 [info ] [MainThread]: 
18:04:30.845773 [info ] [MainThread]: [32mCompleted successfully[0m
18:04:30.846770 [info ] [MainThread]: 
18:04:30.848766 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
18:04:30.849776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C7807340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C7807AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9C756F340>]}


============================== 2022-05-05 19:45:31.775952 | 959e1d2e-e75f-40b9-b076-4508734d356c ==============================
19:45:31.775952 [info ] [MainThread]: Running with dbt=1.1.0
19:45:31.776983 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:45:31.777981 [debug] [MainThread]: Tracking: tracking
19:45:31.778974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208034C5C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208034C5CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208034C5D30>]}
19:45:31.875480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
19:45:31.875480 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\staging\stg_conversion_date.sql
19:45:31.876507 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\staging\stg_leads.sql
19:45:31.876507 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\staging\stg_opportunities.sql
19:45:31.889600 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_conversion_date.sql
19:45:31.903770 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_leads.sql
19:45:31.906905 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_opportunities.sql
19:45:31.913889 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

19:45:31.924861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '959e1d2e-e75f-40b9-b076-4508734d356c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208045E51F0>]}
19:45:31.941840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '959e1d2e-e75f-40b9-b076-4508734d356c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208045739D0>]}
19:45:31.942840 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
19:45:31.944804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959e1d2e-e75f-40b9-b076-4508734d356c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020804573E50>]}
19:45:31.947797 [info ] [MainThread]: 
19:45:31.948826 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:45:31.950788 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
19:45:31.970738 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
19:45:31.970738 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
19:45:31.970738 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:45:32.809012 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.84 seconds
19:45:32.810008 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
19:45:32.937971 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
19:45:32.945992 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
19:45:32.946118 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
19:45:32.946118 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:45:33.854848 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.91 seconds
19:45:33.856811 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
19:45:34.007721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959e1d2e-e75f-40b9-b076-4508734d356c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208047A06D0>]}
19:45:34.009716 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:45:34.012669 [info ] [MainThread]: 
19:45:34.042583 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
19:45:34.042583 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
19:45:34.042583 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
19:45:34.043580 [info ] [Thread-1  ]: 1 of 3 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
19:45:34.044294 [info ] [Thread-2  ]: 2 of 3 START view model CUSTOMERS.stg_leads .................................... [RUN]
19:45:34.045333 [info ] [Thread-3  ]: 3 of 3 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
19:45:34.046292 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
19:45:34.047292 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
19:45:34.048287 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
19:45:34.048287 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
19:45:34.049287 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
19:45:34.049287 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
19:45:34.050285 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
19:45:34.050285 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
19:45:34.052303 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
19:45:34.053285 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
19:45:34.054271 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
19:45:34.056298 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
19:45:34.059268 [debug] [Thread-2  ]: finished collecting timing info
19:45:34.059268 [debug] [Thread-1  ]: finished collecting timing info
19:45:34.060255 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
19:45:34.060255 [debug] [Thread-3  ]: finished collecting timing info
19:45:34.060255 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
19:45:34.102143 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
19:45:34.103140 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
19:45:34.106132 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
19:45:34.110121 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
19:45:34.113113 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
19:45:34.115109 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
19:45:34.115109 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as "lead_id",
    converted_at,
    date_part('month', converted_at) as "MONTH",
    date_part('week', converted_at) as "WEEK",
    date_part('day', converted_at) as "DAY",
    to_char(converted_at, 'Mon') as "MONTH_NAME",
    to_char(converted_at, 'Dy') as "DAY_NAME"
from v1
where IS_CONVERTED = 1;
19:45:34.119097 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
19:45:34.119097 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id,
    converted_at,
    case
        when converted_at is null then 0
        else 1
    end as "IS_CONVERTED",
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
19:45:34.120095 [debug] [Thread-1  ]: Opening a new connection, currently in state init
19:45:34.120095 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    contacts.account_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as "IS_CLOSED",
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as "IS_WON"
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
19:45:34.121095 [debug] [Thread-2  ]: Opening a new connection, currently in state init
19:45:34.124087 [debug] [Thread-3  ]: Opening a new connection, currently in state init
19:45:34.938628 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a411b7-0c03-01a6-0000-00024a1ec189
19:45:34.939626 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 22 unexpected ';'.
19:45:34.939626 [debug] [Thread-1  ]: finished collecting timing info
19:45:34.939626 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
19:45:34.957063 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.84 seconds
19:45:34.967149 [debug] [Thread-2  ]: finished collecting timing info
19:45:34.968148 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
19:45:35.002752 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.88 seconds
19:45:35.003720 [debug] [Thread-3  ]: finished collecting timing info
19:45:35.004717 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
19:45:35.040621 [debug] [Thread-1  ]: Database Error in model stg_conversion_date (models\staging\stg_conversion_date.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 22 unexpected ';'.
  compiled SQL at target\run\prj_dbt\models\staging\stg_conversion_date.sql
19:45:35.040621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959e1d2e-e75f-40b9-b076-4508734d356c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020804AD92B0>]}
19:45:35.040621 [error] [Thread-1  ]: 1 of 3 ERROR creating view model CUSTOMERS.stg_conversion_date ................. [[31mERROR[0m in 0.99s]
19:45:35.041619 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
19:45:35.059571 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959e1d2e-e75f-40b9-b076-4508734d356c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020804AD9D00>]}
19:45:35.059571 [info ] [Thread-2  ]: 2 of 3 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.01s]
19:45:35.060568 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
19:45:35.116418 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959e1d2e-e75f-40b9-b076-4508734d356c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002080493D370>]}
19:45:35.117415 [info ] [Thread-3  ]: 3 of 3 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.07s]
19:45:35.118413 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
19:45:35.122401 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:45:35.123411 [info ] [MainThread]: 
19:45:35.124430 [info ] [MainThread]: Finished running 3 view models in 3.17s.
19:45:35.124430 [debug] [MainThread]: Connection 'master' was properly closed.
19:45:35.125420 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
19:45:35.125420 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
19:45:35.125420 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
19:45:35.126419 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
19:45:35.126419 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
19:45:35.137361 [info ] [MainThread]: 
19:45:35.138358 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:45:35.139356 [info ] [MainThread]: 
19:45:35.140352 [error] [MainThread]: [33mDatabase Error in model stg_conversion_date (models\staging\stg_conversion_date.sql)[0m
19:45:35.140352 [error] [MainThread]:   001003 (42000): SQL compilation error:
19:45:35.141350 [error] [MainThread]:   syntax error line 15 at position 22 unexpected ';'.
19:45:35.142347 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\stg_conversion_date.sql
19:45:35.143347 [info ] [MainThread]: 
19:45:35.144344 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
19:45:35.145342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002080462F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208046190D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020804573AF0>]}


============================== 2022-05-05 19:57:39.061821 | 04f021fd-c5e6-48ad-839e-19499c452b76 ==============================
19:57:39.061821 [info ] [MainThread]: Running with dbt=1.1.0
19:57:39.062817 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:57:39.063814 [debug] [MainThread]: Tracking: tracking
19:57:39.063814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AB24B7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AB24B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AB24B8B0>]}
19:57:39.141951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:57:39.141951 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_conversion_date.sql
19:57:39.154022 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_conversion_date.sql
19:57:39.169282 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

19:57:39.178259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04f021fd-c5e6-48ad-839e-19499c452b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AC3670A0>]}
19:57:39.187388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04f021fd-c5e6-48ad-839e-19499c452b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AB2AE9A0>]}
19:57:39.188386 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
19:57:39.189403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04f021fd-c5e6-48ad-839e-19499c452b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AB26EF70>]}
19:57:39.190380 [info ] [MainThread]: 
19:57:39.191378 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:57:39.193371 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
19:57:39.212319 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
19:57:39.213349 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
19:57:39.213349 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:57:40.207817 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.99 seconds
19:57:40.209808 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
19:57:40.318190 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
19:57:40.326143 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
19:57:40.326143 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
19:57:40.327190 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:57:40.858550 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.53 seconds
19:57:40.860540 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
19:57:41.253634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04f021fd-c5e6-48ad-839e-19499c452b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AB26E0A0>]}
19:57:41.254631 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:57:41.255627 [info ] [MainThread]: 
19:57:41.265601 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
19:57:41.266598 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
19:57:41.266598 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
19:57:41.267597 [info ] [Thread-1  ]: 1 of 3 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
19:57:41.268594 [info ] [Thread-2  ]: 2 of 3 START view model CUSTOMERS.stg_leads .................................... [RUN]
19:57:41.269591 [info ] [Thread-3  ]: 3 of 3 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
19:57:41.271586 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
19:57:41.272584 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
19:57:41.272584 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
19:57:41.273583 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
19:57:41.273583 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
19:57:41.274580 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
19:57:41.274580 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
19:57:41.275577 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
19:57:41.277577 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
19:57:41.278589 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
19:57:41.280564 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
19:57:41.284551 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
19:57:41.285548 [debug] [Thread-1  ]: finished collecting timing info
19:57:41.285548 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
19:57:41.295524 [debug] [Thread-2  ]: finished collecting timing info
19:57:41.327483 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
19:57:41.342426 [debug] [Thread-3  ]: finished collecting timing info
19:57:41.349522 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
19:57:41.352511 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
19:57:41.352511 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
19:57:41.356700 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
19:57:41.358695 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
19:57:41.359692 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as "lead_id",
    converted_at,
    date_part('month', converted_at) as "MONTH",
    date_part('week', converted_at) as "WEEK",
    date_part('day', converted_at) as "DAY",
    to_char(converted_at, 'Mon') as "MONTH_NAME",
    to_char(converted_at, 'Dy') as "DAY_NAME"
from leads
where converted_at is not null;
19:57:41.359692 [debug] [Thread-1  ]: Opening a new connection, currently in state init
19:57:41.360689 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
19:57:41.361686 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
19:57:41.364682 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id,
    converted_at,
    case
        when converted_at is null then 0
        else 1
    end as "IS_CONVERTED",
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
19:57:41.364682 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    contacts.account_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as "IS_CLOSED",
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as "IS_WON"
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
19:57:41.365677 [debug] [Thread-2  ]: Opening a new connection, currently in state init
19:57:41.366868 [debug] [Thread-3  ]: Opening a new connection, currently in state init
19:57:42.248855 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a411c3-0c03-007f-0000-00024a1ee0e5
19:57:42.248855 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 30 unexpected ';'.
19:57:42.249881 [debug] [Thread-1  ]: finished collecting timing info
19:57:42.249881 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
19:57:42.380087 [debug] [Thread-1  ]: Database Error in model stg_conversion_date (models\staging\stg_conversion_date.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 30 unexpected ';'.
  compiled SQL at target\run\prj_dbt\models\staging\stg_conversion_date.sql
19:57:42.382090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f021fd-c5e6-48ad-839e-19499c452b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AC706400>]}
19:57:42.384084 [error] [Thread-1  ]: 1 of 3 ERROR creating view model CUSTOMERS.stg_conversion_date ................. [[31mERROR[0m in 1.11s]
19:57:42.386042 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
19:57:42.469657 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.1 seconds
19:57:42.476883 [debug] [Thread-3  ]: finished collecting timing info
19:57:42.477880 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
19:57:42.572917 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.21 seconds
19:57:42.574912 [debug] [Thread-2  ]: finished collecting timing info
19:57:42.574912 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
19:57:42.589211 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f021fd-c5e6-48ad-839e-19499c452b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AC710910>]}
19:57:42.589211 [info ] [Thread-3  ]: 3 of 3 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.32s]
19:57:42.590214 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
19:57:42.680757 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f021fd-c5e6-48ad-839e-19499c452b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AC706D00>]}
19:57:42.680757 [info ] [Thread-2  ]: 2 of 3 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.41s]
19:57:42.681753 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
19:57:42.684746 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:57:42.685744 [info ] [MainThread]: 
19:57:42.686743 [info ] [MainThread]: Finished running 3 view models in 3.49s.
19:57:42.686743 [debug] [MainThread]: Connection 'master' was properly closed.
19:57:42.687777 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
19:57:42.687777 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
19:57:42.687777 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
19:57:42.687777 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
19:57:42.688735 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
19:57:42.700705 [info ] [MainThread]: 
19:57:42.701704 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:57:42.702718 [info ] [MainThread]: 
19:57:42.703698 [error] [MainThread]: [33mDatabase Error in model stg_conversion_date (models\staging\stg_conversion_date.sql)[0m
19:57:42.704721 [error] [MainThread]:   001003 (42000): SQL compilation error:
19:57:42.704721 [error] [MainThread]:   syntax error line 15 at position 30 unexpected ';'.
19:57:42.705690 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\stg_conversion_date.sql
19:57:42.706689 [info ] [MainThread]: 
19:57:42.707685 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
19:57:42.708684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AC394400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AB26E8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263AB26E0D0>]}


============================== 2022-05-05 19:58:32.535650 | aff89670-3667-480e-82c3-c068d050b3c0 ==============================
19:58:32.535650 [info ] [MainThread]: Running with dbt=1.1.0
19:58:32.536649 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:58:32.537688 [debug] [MainThread]: Tracking: tracking
19:58:32.537688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281DFE289D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281DFE28A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281DFE28A60>]}
19:58:32.621167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:58:32.622164 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_conversion_date.sql
19:58:32.634282 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_conversion_date.sql
19:58:32.654237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

19:58:32.666532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aff89670-3667-480e-82c3-c068d050b3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281DFF77460>]}
19:58:32.676510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aff89670-3667-480e-82c3-c068d050b3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281DFE927C0>]}
19:58:32.677503 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
19:58:32.678501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aff89670-3667-480e-82c3-c068d050b3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281DFE6D880>]}
19:58:32.680495 [info ] [MainThread]: 
19:58:32.681493 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:58:32.684485 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
19:58:32.703433 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
19:58:32.704430 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
19:58:32.705428 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:58:33.352534 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.65 seconds
19:58:33.354527 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
19:58:33.461347 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
19:58:33.469538 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
19:58:33.469538 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
19:58:33.469538 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:58:34.301010 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.83 seconds
19:58:34.304954 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
19:58:34.414325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aff89670-3667-480e-82c3-c068d050b3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E012EA30>]}
19:58:34.414325 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:58:34.415317 [info ] [MainThread]: 
19:58:34.427286 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
19:58:34.428289 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
19:58:34.429293 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
19:58:34.429293 [info ] [Thread-1  ]: 1 of 3 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
19:58:34.430278 [info ] [Thread-2  ]: 2 of 3 START view model CUSTOMERS.stg_leads .................................... [RUN]
19:58:34.431284 [info ] [Thread-3  ]: 3 of 3 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
19:58:34.432287 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
19:58:34.433269 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
19:58:34.434281 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
19:58:34.434281 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
19:58:34.434281 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
19:58:34.435314 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
19:58:34.435314 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
19:58:34.436289 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
19:58:34.437287 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
19:58:34.438273 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
19:58:34.441251 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
19:58:34.444240 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
19:58:34.445238 [debug] [Thread-1  ]: finished collecting timing info
19:58:34.445238 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
19:58:34.490118 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
19:58:34.491115 [debug] [Thread-3  ]: finished collecting timing info
19:58:34.491115 [debug] [Thread-2  ]: finished collecting timing info
19:58:34.492117 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
19:58:34.492117 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
19:58:34.495104 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
19:58:34.499093 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
19:58:34.500119 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
19:58:34.500119 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as "lead_id",
    converted_at,
    date_part('month', converted_at) as "MONTH",
    date_part('week', converted_at) as "WEEK",
    date_part('day', converted_at) as "DAY",
    to_char(converted_at, 'Mon') as "MONTH_NAME",
    to_char(converted_at, 'Dy') as "DAY_NAME"
from leads
where converted_at is not null
  );
19:58:34.501089 [debug] [Thread-1  ]: Opening a new connection, currently in state init
19:58:34.503084 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
19:58:34.505082 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
19:58:34.506196 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    contacts.account_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as "IS_CLOSED",
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as "IS_WON"
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
19:58:34.508202 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id,
    converted_at,
    case
        when converted_at is null then 0
        else 1
    end as "IS_CONVERTED",
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
19:58:34.508202 [debug] [Thread-3  ]: Opening a new connection, currently in state init
19:58:34.509194 [debug] [Thread-2  ]: Opening a new connection, currently in state init
19:58:35.310973 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.8 seconds
19:58:35.317372 [debug] [Thread-3  ]: finished collecting timing info
19:58:35.317372 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
19:58:35.419922 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aff89670-3667-480e-82c3-c068d050b3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E01B2520>]}
19:58:35.420875 [info ] [Thread-3  ]: 3 of 3 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 0.98s]
19:58:35.423916 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
19:58:35.499308 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.99 seconds
19:58:35.502298 [debug] [Thread-2  ]: finished collecting timing info
19:58:35.503296 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
19:58:35.610942 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aff89670-3667-480e-82c3-c068d050b3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E01B2310>]}
19:58:35.611942 [info ] [Thread-2  ]: 2 of 3 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.18s]
19:58:35.612907 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
19:58:56.238403 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 21.74 seconds
19:58:56.240398 [debug] [Thread-1  ]: finished collecting timing info
19:58:56.240398 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
19:58:56.353126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aff89670-3667-480e-82c3-c068d050b3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E03216A0>]}
19:58:56.354137 [info ] [Thread-1  ]: 1 of 3 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 21.92s]
19:58:56.355091 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
19:58:56.358083 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:58:56.358083 [info ] [MainThread]: 
19:58:56.359080 [info ] [MainThread]: Finished running 3 view models in 23.68s.
19:58:56.360077 [debug] [MainThread]: Connection 'master' was properly closed.
19:58:56.360077 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
19:58:56.360077 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
19:58:56.360077 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
19:58:56.361075 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
19:58:56.361075 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
19:58:56.371051 [info ] [MainThread]: 
19:58:56.372054 [info ] [MainThread]: [32mCompleted successfully[0m
19:58:56.373062 [info ] [MainThread]: 
19:58:56.374074 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
19:58:56.375042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281DFE6D280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281DFE6D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E0185760>]}


============================== 2022-05-05 20:03:50.729800 | f7c67362-103a-4cad-9b3a-6ad6ae732337 ==============================
20:03:50.729800 [info ] [MainThread]: Running with dbt=1.1.0
20:03:50.730798 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
20:03:50.731795 [debug] [MainThread]: Tracking: tracking
20:03:50.731795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF87A2B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF87A2BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF87A2C40>]}
20:03:50.819913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:03:50.820909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:03:50.821907 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

20:03:50.830884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7c67362-103a-4cad-9b3a-6ad6ae732337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF889EF70>]}
20:03:50.843980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7c67362-103a-4cad-9b3a-6ad6ae732337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF8793CA0>]}
20:03:50.844976 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
20:03:50.846968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7c67362-103a-4cad-9b3a-6ad6ae732337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF87E0FD0>]}
20:03:50.848118 [info ] [MainThread]: 
20:03:50.850111 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
20:03:50.860086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF8793880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF87F20A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF87F20D0>]}


============================== 2022-05-05 20:05:03.906224 | 0d6b10d5-d6cf-4f22-8e2b-f6f476d9bd84 ==============================
20:05:03.906224 [info ] [MainThread]: Running with dbt=1.1.0
20:05:03.908197 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
20:05:03.908197 [debug] [MainThread]: Tracking: tracking
20:05:03.909184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149BC3C8D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149BC3C8D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149BC3C8DF0>]}
20:05:03.985571 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 3 files changed.
20:05:03.986596 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_conversion_date.sql
20:05:03.986596 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_leads.sql
20:05:03.987592 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_opportunities.sql
20:05:03.999689 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_conversion_date.sql
20:05:04.011847 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_leads.sql
20:05:04.014839 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_opportunities.sql
20:05:04.020945 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

20:05:04.032913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d6b10d5-d6cf-4f22-8e2b-f6f476d9bd84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149BC517CD0>]}
20:05:04.044882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d6b10d5-d6cf-4f22-8e2b-f6f476d9bd84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149BC42C130>]}
20:05:04.045879 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
20:05:04.046875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d6b10d5-d6cf-4f22-8e2b-f6f476d9bd84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149BC42C5B0>]}
20:05:04.048873 [info ] [MainThread]: 
20:05:04.049870 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
20:05:04.062833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149BC4A0FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149BC3C82B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149BC42C550>]}


============================== 2022-05-05 20:05:11.985712 | 5d91945d-39bc-425c-80d8-00b07913850b ==============================
20:05:11.985712 [info ] [MainThread]: Running with dbt=1.1.0
20:05:11.986740 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:05:11.986740 [debug] [MainThread]: Tracking: tracking
20:05:11.987704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F15DA7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F15DA7D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F15DAC9D0>]}
20:05:12.077513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:05:12.078510 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:05:12.078510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

20:05:12.087515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d91945d-39bc-425c-80d8-00b07913850b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F15E93490>]}
20:05:12.098459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d91945d-39bc-425c-80d8-00b07913850b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F15DE0490>]}
20:05:12.099454 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
20:05:12.100451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d91945d-39bc-425c-80d8-00b07913850b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F15DE0580>]}
20:05:12.101448 [info ] [MainThread]: 
20:05:12.103446 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:05:12.105445 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
20:05:12.132366 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
20:05:12.133367 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
20:05:12.133367 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:05:20.371362 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 8.24 seconds
20:05:20.372358 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
20:05:20.696426 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
20:05:20.703410 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
20:05:20.704407 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
20:05:20.704407 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:05:24.835998 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 4.13 seconds
20:05:24.838999 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
20:05:25.347032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d91945d-39bc-425c-80d8-00b07913850b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F160635E0>]}
20:05:25.348061 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:05:25.349022 [info ] [MainThread]: 
20:05:25.360990 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
20:05:25.361988 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
20:05:25.361988 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
20:05:25.361988 [info ] [Thread-1  ]: 1 of 3 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
20:05:25.363014 [info ] [Thread-2  ]: 2 of 3 START view model CUSTOMERS.stg_leads .................................... [RUN]
20:05:25.363014 [info ] [Thread-3  ]: 3 of 3 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
20:05:25.364982 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
20:05:25.366975 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
20:05:25.366975 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
20:05:25.367972 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
20:05:25.367972 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
20:05:25.369002 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
20:05:25.369002 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
20:05:25.369967 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
20:05:25.370996 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
20:05:25.371991 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
20:05:25.372989 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
20:05:25.374953 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
20:05:25.375951 [debug] [Thread-1  ]: finished collecting timing info
20:05:25.376951 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
20:05:25.424849 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
20:05:25.425847 [debug] [Thread-2  ]: finished collecting timing info
20:05:25.425847 [debug] [Thread-3  ]: finished collecting timing info
20:05:25.426815 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
20:05:25.426815 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
20:05:25.430803 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
20:05:25.434795 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
20:05:25.435792 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
20:05:25.436790 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as "lead_id",
    converted_at,
    date_part('month', converted_at) as "MONTH",
    date_part('week', converted_at) as "WEEK",
    date_part('day', converted_at) as "DAY",
    to_char(converted_at, 'Mon') as "MONTH_NAME",
    to_char(converted_at, 'Dy') as "DAY_NAME"
from leads
where converted_at is not null;
20:05:25.437785 [debug] [Thread-1  ]: Opening a new connection, currently in state init
20:05:25.440776 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
20:05:25.442772 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id,
    converted_at,
    case
        when converted_at is null then 0
        else 1
    end as "IS_CONVERTED",
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads;
20:05:25.446761 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
20:05:25.447761 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:05:25.448758 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    contacts.account_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as "IS_CLOSED",
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as "IS_WON"
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id);
20:05:25.450750 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:05:29.383444 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a411cb-0c03-01a6-0000-00024a1ec1a5
20:05:29.383444 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 22 unexpected ';'.
20:05:29.384473 [debug] [Thread-3  ]: finished collecting timing info
20:05:29.384473 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
20:05:30.076751 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a411cb-0c03-0216-0000-00024a1ea1a9
20:05:30.076751 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 30 unexpected ';'.
20:05:30.076751 [debug] [Thread-1  ]: finished collecting timing info
20:05:30.077749 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
20:05:30.105508 [debug] [Thread-3  ]: Database Error in model stg_opportunities (models\staging\stg_opportunities.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 22 unexpected ';'.
  compiled SQL at target\run\prj_dbt\models\staging\stg_opportunities.sql
20:05:30.105508 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d91945d-39bc-425c-80d8-00b07913850b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F161C57F0>]}
20:05:30.106505 [error] [Thread-3  ]: 3 of 3 ERROR creating view model CUSTOMERS.stg_opportunities ................... [[31mERROR[0m in 4.74s]
20:05:30.107502 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
20:05:31.805666 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a411cb-0c03-01e9-0000-00024a1e9181
20:05:31.805666 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 10 unexpected ';'.
20:05:31.806647 [debug] [Thread-2  ]: finished collecting timing info
20:05:31.806647 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
20:05:32.972259 [debug] [Thread-2  ]: Database Error in model stg_leads (models\staging\stg_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 10 unexpected ';'.
  compiled SQL at target\run\prj_dbt\models\staging\stg_leads.sql
20:05:32.973262 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d91945d-39bc-425c-80d8-00b07913850b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F160C5790>]}
20:05:32.974227 [error] [Thread-2  ]: 2 of 3 ERROR creating view model CUSTOMERS.stg_leads ........................... [[31mERROR[0m in 7.61s]
20:05:32.976222 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
20:05:33.854400 [debug] [Thread-1  ]: Database Error in model stg_conversion_date (models\staging\stg_conversion_date.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 30 unexpected ';'.
  compiled SQL at target\run\prj_dbt\models\staging\stg_conversion_date.sql
20:05:33.855719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d91945d-39bc-425c-80d8-00b07913850b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F160AA7C0>]}
20:05:33.857751 [error] [Thread-1  ]: 1 of 3 ERROR creating view model CUSTOMERS.stg_conversion_date ................. [[31mERROR[0m in 8.49s]
20:05:33.859763 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
20:05:33.866698 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:05:33.868691 [info ] [MainThread]: 
20:05:33.869679 [info ] [MainThread]: Finished running 3 view models in 21.77s.
20:05:33.869679 [debug] [MainThread]: Connection 'master' was properly closed.
20:05:33.870714 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
20:05:33.870714 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
20:05:33.870714 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
20:05:33.870714 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
20:05:33.871711 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
20:05:33.880651 [info ] [MainThread]: 
20:05:33.881647 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
20:05:33.883641 [info ] [MainThread]: 
20:05:33.884643 [error] [MainThread]: [33mDatabase Error in model stg_opportunities (models\staging\stg_opportunities.sql)[0m
20:05:33.886633 [error] [MainThread]:   001003 (42000): SQL compilation error:
20:05:33.887630 [error] [MainThread]:   syntax error line 23 at position 22 unexpected ';'.
20:05:33.888628 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\stg_opportunities.sql
20:05:33.889626 [info ] [MainThread]: 
20:05:33.890622 [error] [MainThread]: [33mDatabase Error in model stg_leads (models\staging\stg_leads.sql)[0m
20:05:33.891620 [error] [MainThread]:   001003 (42000): SQL compilation error:
20:05:33.892617 [error] [MainThread]:   syntax error line 18 at position 10 unexpected ';'.
20:05:33.894611 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\stg_leads.sql
20:05:33.894611 [info ] [MainThread]: 
20:05:33.896610 [error] [MainThread]: [33mDatabase Error in model stg_conversion_date (models\staging\stg_conversion_date.sql)[0m
20:05:33.897610 [error] [MainThread]:   001003 (42000): SQL compilation error:
20:05:33.898601 [error] [MainThread]:   syntax error line 15 at position 30 unexpected ';'.
20:05:33.899600 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\stg_conversion_date.sql
20:05:33.900612 [info ] [MainThread]: 
20:05:33.901592 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
20:05:33.902590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F160B6880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F160B6C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F160B6B20>]}


============================== 2022-05-05 20:06:20.459924 | 558349f1-a8eb-4422-bbf4-b7019f4a36f9 ==============================
20:06:20.459924 [info ] [MainThread]: Running with dbt=1.1.0
20:06:20.460953 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:06:20.461948 [debug] [MainThread]: Tracking: tracking
20:06:20.461948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234655B8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234655B89A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234655B8A00>]}
20:06:20.535979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
20:06:20.535979 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_conversion_date.sql
20:06:20.537006 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_leads.sql
20:06:20.537006 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_opportunities.sql
20:06:20.549077 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_conversion_date.sql
20:06:20.562172 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_leads.sql
20:06:20.564167 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_opportunities.sql
20:06:20.571286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

20:06:20.581279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '558349f1-a8eb-4422-bbf4-b7019f4a36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234666D70A0>]}
20:06:20.591233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '558349f1-a8eb-4422-bbf4-b7019f4a36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002346665CD60>]}
20:06:20.591233 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
20:06:20.592230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '558349f1-a8eb-4422-bbf4-b7019f4a36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002346665CBB0>]}
20:06:20.593227 [info ] [MainThread]: 
20:06:20.595236 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:06:20.596222 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
20:06:20.618162 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
20:06:20.619188 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
20:06:20.619188 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:06:21.938444 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.32 seconds
20:06:21.942429 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
20:06:22.176384 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
20:06:22.184365 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
20:06:22.184365 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
20:06:22.184365 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:06:23.826414 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.64 seconds
20:06:23.828408 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
20:06:23.923234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '558349f1-a8eb-4422-bbf4-b7019f4a36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023463DA79D0>]}
20:06:23.923234 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:06:23.924247 [info ] [MainThread]: 
20:06:23.934230 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
20:06:23.935202 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
20:06:23.935202 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
20:06:23.935202 [info ] [Thread-1  ]: 1 of 3 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
20:06:23.936201 [info ] [Thread-2  ]: 2 of 3 START view model CUSTOMERS.stg_leads .................................... [RUN]
20:06:23.936201 [info ] [Thread-3  ]: 3 of 3 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
20:06:23.938195 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
20:06:23.938195 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
20:06:23.939192 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
20:06:23.939192 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
20:06:23.940217 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
20:06:23.940217 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
20:06:23.942211 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
20:06:23.944180 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
20:06:23.944180 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
20:06:23.945176 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
20:06:23.946173 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
20:06:23.948170 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
20:06:23.949165 [debug] [Thread-1  ]: finished collecting timing info
20:06:23.949165 [debug] [Thread-2  ]: finished collecting timing info
20:06:23.950162 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
20:06:23.950162 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
20:06:23.977089 [debug] [Thread-3  ]: finished collecting timing info
20:06:23.988063 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
20:06:23.991052 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
20:06:23.992052 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
20:06:23.999032 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
20:06:24.002024 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
20:06:24.003030 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
20:06:24.004025 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id,
    converted_at,
    case
        when converted_at is null then 0
        else 1
    end as "IS_CONVERTED",
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
20:06:24.004025 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as "lead_id",
    converted_at,
    date_part('month', converted_at) as "MONTH",
    date_part('week', converted_at) as "WEEK",
    date_part('day', converted_at) as "DAY",
    to_char(converted_at, 'Mon') as "MONTH_NAME",
    to_char(converted_at, 'Dy') as "DAY_NAME"
from leads
where converted_at is not null
  );
20:06:24.006014 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
20:06:24.006014 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:06:24.007015 [debug] [Thread-1  ]: Opening a new connection, currently in state init
20:06:24.007015 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    contacts.account_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as "IS_CLOSED",
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as "IS_WON"
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
20:06:24.011998 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:06:25.432659 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.43 seconds
20:06:25.450643 [debug] [Thread-1  ]: finished collecting timing info
20:06:25.450643 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
20:06:25.896367 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.89 seconds
20:06:25.898364 [debug] [Thread-2  ]: finished collecting timing info
20:06:25.899359 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
20:06:25.974596 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558349f1-a8eb-4422-bbf4-b7019f4a36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023466A5F790>]}
20:06:25.975593 [info ] [Thread-1  ]: 1 of 3 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 2.04s]
20:06:25.976566 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
20:06:26.975739 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558349f1-a8eb-4422-bbf4-b7019f4a36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023466A5EEB0>]}
20:06:26.976766 [info ] [Thread-2  ]: 2 of 3 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 3.04s]
20:06:26.977764 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
20:06:27.290238 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.28 seconds
20:06:27.293214 [debug] [Thread-3  ]: finished collecting timing info
20:06:27.293214 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
20:06:28.568130 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558349f1-a8eb-4422-bbf4-b7019f4a36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023466A5FFA0>]}
20:06:28.569127 [info ] [Thread-3  ]: 3 of 3 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 4.62s]
20:06:28.570087 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
20:06:28.573070 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:06:28.574068 [info ] [MainThread]: 
20:06:28.575093 [info ] [MainThread]: Finished running 3 view models in 7.98s.
20:06:28.576070 [debug] [MainThread]: Connection 'master' was properly closed.
20:06:28.576070 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
20:06:28.576070 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
20:06:28.576070 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
20:06:28.577095 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
20:06:28.577095 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
20:06:28.586051 [info ] [MainThread]: 
20:06:28.588030 [info ] [MainThread]: [32mCompleted successfully[0m
20:06:28.590026 [info ] [MainThread]: 
20:06:28.591023 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
20:06:28.592020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234656143D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234655B8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234668D5610>]}


============================== 2022-05-05 20:10:05.500306 | 42df215b-a6c0-450f-8438-973b29cf2064 ==============================
20:10:05.500306 [info ] [MainThread]: Running with dbt=1.1.0
20:10:05.501303 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:10:05.502312 [debug] [MainThread]: Tracking: tracking
20:10:05.502312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB49A6C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB49A6C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB49A6CD0>]}
20:10:05.577435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
20:10:05.578431 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_conversion_date.sql
20:10:05.578431 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_leads.sql
20:10:05.591503 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_conversion_date.sql
20:10:05.603633 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_leads.sql
20:10:05.609719 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

20:10:05.620693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42df215b-a6c0-450f-8438-973b29cf2064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB4AF5C10>]}
20:10:05.630661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42df215b-a6c0-450f-8438-973b29cf2064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB4A79C40>]}
20:10:05.631659 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
20:10:05.633666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42df215b-a6c0-450f-8438-973b29cf2064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB4A798E0>]}
20:10:05.634661 [info ] [MainThread]: 
20:10:05.636650 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:10:05.637643 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
20:10:05.662575 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
20:10:05.663576 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
20:10:05.664572 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:10:07.409132 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.74 seconds
20:10:07.411129 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
20:10:07.573088 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
20:10:07.581066 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
20:10:07.582095 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
20:10:07.582095 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:10:08.474304 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.89 seconds
20:10:08.475302 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
20:10:08.666790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42df215b-a6c0-450f-8438-973b29cf2064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB4C8CE20>]}
20:10:08.667787 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:10:08.668785 [info ] [MainThread]: 
20:10:08.684742 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
20:10:08.684742 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
20:10:08.685740 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
20:10:08.685740 [info ] [Thread-1  ]: 1 of 3 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
20:10:08.686737 [info ] [Thread-2  ]: 2 of 3 START view model CUSTOMERS.stg_leads .................................... [RUN]
20:10:08.688732 [info ] [Thread-3  ]: 3 of 3 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
20:10:08.690727 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
20:10:08.691724 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
20:10:08.692721 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
20:10:08.693722 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
20:10:08.694716 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
20:10:08.694716 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
20:10:08.695713 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
20:10:08.695713 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
20:10:08.698705 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
20:10:08.699702 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
20:10:08.702694 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
20:10:08.706684 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
20:10:08.707682 [debug] [Thread-1  ]: finished collecting timing info
20:10:08.708679 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
20:10:08.727630 [debug] [Thread-2  ]: finished collecting timing info
20:10:08.727630 [debug] [Thread-3  ]: finished collecting timing info
20:10:08.752563 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
20:10:08.752563 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
20:10:08.753560 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
20:10:08.759542 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
20:10:08.762565 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
20:10:08.765764 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
20:10:08.766764 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as lead_id,
    converted_at,
    date_part('month', converted_at) as "month",
    date_part('week', converted_at) as "week",
    date_part('day', converted_at) as "day",
    to_char(converted_at, 'Mon') as month_name,
    to_char(converted_at, 'Dy') as day_name
from leads
where converted_at is not null
  );
20:10:08.766764 [debug] [Thread-1  ]: Opening a new connection, currently in state init
20:10:08.768787 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
20:10:08.770754 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id,
    case
        when converted_at is null then 0
        else 1
    end as is_converted,
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
20:10:08.771748 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
20:10:08.771748 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:10:08.772747 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    contacts.account_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as "IS_CLOSED",
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as "IS_WON"
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
20:10:08.775741 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:10:09.860754 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.09 seconds
20:10:09.868760 [debug] [Thread-1  ]: finished collecting timing info
20:10:09.869731 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
20:10:09.874755 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.1 seconds
20:10:09.875744 [debug] [Thread-3  ]: finished collecting timing info
20:10:09.876753 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
20:10:09.994181 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42df215b-a6c0-450f-8438-973b29cf2064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB4CA61C0>]}
20:10:09.994181 [info ] [Thread-3  ]: 3 of 3 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.30s]
20:10:09.995179 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
20:10:10.169366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42df215b-a6c0-450f-8438-973b29cf2064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB4B442B0>]}
20:10:10.169366 [info ] [Thread-1  ]: 1 of 3 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.48s]
20:10:10.170367 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
20:10:10.389845 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.62 seconds
20:10:10.392826 [debug] [Thread-2  ]: finished collecting timing info
20:10:10.392826 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
20:10:10.494709 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42df215b-a6c0-450f-8438-973b29cf2064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB4CA6070>]}
20:10:10.494709 [info ] [Thread-2  ]: 2 of 3 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.80s]
20:10:10.496098 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
20:10:10.499093 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:10:10.500090 [info ] [MainThread]: 
20:10:10.501087 [info ] [MainThread]: Finished running 3 view models in 4.86s.
20:10:10.501087 [debug] [MainThread]: Connection 'master' was properly closed.
20:10:10.502123 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
20:10:10.502123 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
20:10:10.502123 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
20:10:10.502123 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
20:10:10.503112 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
20:10:10.514186 [info ] [MainThread]: 
20:10:10.515185 [info ] [MainThread]: [32mCompleted successfully[0m
20:10:10.516304 [info ] [MainThread]: 
20:10:10.517301 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
20:10:10.518301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB21C7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB49A6F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB4CF64F0>]}


============================== 2022-05-05 21:05:07.419934 | 09869af9-8a1f-4cc2-94b5-5cb2a3d9a8b0 ==============================
21:05:07.419934 [info ] [MainThread]: Running with dbt=1.1.0
21:05:07.420943 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:05:07.421928 [debug] [MainThread]: Tracking: tracking
21:05:07.421928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D349638970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3496389D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D349638A30>]}
21:05:07.535623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
21:05:07.536622 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\count_converted_time_source.sql
21:05:07.536622 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\count_converted_time.sql
21:05:07.537618 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_leads.sql
21:05:07.538615 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_opportunities.sql
21:05:07.554574 [debug] [MainThread]: 1699: static parser successfully parsed count_converted_time_source.sql
21:05:07.572556 [debug] [MainThread]: 1699: static parser successfully parsed count_converted_time.sql
21:05:07.576711 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_leads.sql
21:05:07.580700 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_opportunities.sql
21:05:07.586927 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

21:05:07.595902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09869af9-8a1f-4cc2-94b5-5cb2a3d9a8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D34978A760>]}
21:05:07.606873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09869af9-8a1f-4cc2-94b5-5cb2a3d9a8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D349638F70>]}
21:05:07.607871 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
21:05:07.608868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09869af9-8a1f-4cc2-94b5-5cb2a3d9a8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D349638F40>]}
21:05:07.609869 [info ] [MainThread]: 
21:05:07.610865 [debug] [MainThread]: Acquiring new snowflake connection "master"
21:05:07.612858 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
21:05:07.633803 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
21:05:07.633803 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
21:05:07.634798 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:05:08.378944 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.74 seconds
21:05:08.380970 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
21:05:08.763497 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
21:05:08.769700 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
21:05:08.769700 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
21:05:08.769700 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:05:09.464342 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.69 seconds
21:05:09.466337 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
21:05:09.581182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09869af9-8a1f-4cc2-94b5-5cb2a3d9a8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3497CA4F0>]}
21:05:09.582182 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
21:05:09.583178 [info ] [MainThread]: 
21:05:09.595150 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
21:05:09.596142 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
21:05:09.596142 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
21:05:09.597170 [info ] [Thread-1  ]: 1 of 5 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
21:05:09.597170 [info ] [Thread-2  ]: 2 of 5 START view model CUSTOMERS.stg_leads .................................... [RUN]
21:05:09.598139 [info ] [Thread-3  ]: 3 of 5 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
21:05:09.600133 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
21:05:09.601128 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
21:05:09.602126 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
21:05:09.602126 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
21:05:09.603155 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
21:05:09.603155 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
21:05:09.604122 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
21:05:09.604122 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
21:05:09.607113 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
21:05:09.607113 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
21:05:09.609111 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
21:05:09.613097 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
21:05:09.614094 [debug] [Thread-1  ]: finished collecting timing info
21:05:09.615091 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
21:05:09.616088 [debug] [Thread-2  ]: finished collecting timing info
21:05:09.642019 [debug] [Thread-3  ]: finished collecting timing info
21:05:09.663287 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
21:05:09.663287 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
21:05:09.664285 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
21:05:09.668274 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
21:05:09.673260 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
21:05:09.674258 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
21:05:09.675255 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as lead_id,
    converted_at,
    date_part('month', converted_at) as "month",
    date_part('week', converted_at) as "week",
    date_part('day', converted_at) as "day",
    to_char(converted_at, 'Mon') as month_name,
    to_char(converted_at, 'Dy') as day_name
from leads
where converted_at is not null
  );
21:05:09.676254 [debug] [Thread-1  ]: Opening a new connection, currently in state init
21:05:09.679244 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
21:05:09.681239 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id as lead_id,
    case
        when converted_at is null then 0
        else 1
    end as is_converted,
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
21:05:09.682237 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:05:09.684230 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
21:05:09.687223 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as "is_closed",
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as "is_won"
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
21:05:09.688220 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:05:10.652435 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.97 seconds
21:05:10.660380 [debug] [Thread-2  ]: finished collecting timing info
21:05:10.662374 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.97 seconds
21:05:10.663395 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
21:05:10.665366 [debug] [Thread-3  ]: finished collecting timing info
21:05:10.668391 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
21:05:10.761734 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09869af9-8a1f-4cc2-94b5-5cb2a3d9a8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D349B25B20>]}
21:05:10.762732 [info ] [Thread-2  ]: 2 of 5 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.16s]
21:05:10.763735 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.09 seconds
21:05:10.767752 [debug] [Thread-1  ]: finished collecting timing info
21:05:10.767752 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
21:05:10.768718 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
21:05:10.769716 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09869af9-8a1f-4cc2-94b5-5cb2a3d9a8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D349959430>]}
21:05:10.770713 [info ] [Thread-3  ]: 3 of 5 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.17s]
21:05:10.772707 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
21:05:10.895399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09869af9-8a1f-4cc2-94b5-5cb2a3d9a8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3499BC970>]}
21:05:10.896398 [info ] [Thread-1  ]: 1 of 5 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.30s]
21:05:10.898371 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
21:05:10.899390 [debug] [Thread-5  ]: Began running node model.prj_dbt.count_converted_time
21:05:10.899390 [debug] [Thread-6  ]: Began running node model.prj_dbt.count_converted_time_source
21:05:10.900390 [info ] [Thread-5  ]: 4 of 5 START view model CUSTOMERS.count_converted_time ......................... [RUN]
21:05:10.900390 [info ] [Thread-6  ]: 5 of 5 START view model CUSTOMERS.count_converted_time_source .................. [RUN]
21:05:10.901387 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time"
21:05:10.902384 [debug] [Thread-5  ]: Began compiling node model.prj_dbt.count_converted_time
21:05:10.902384 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time_source"
21:05:10.902384 [debug] [Thread-5  ]: Compiling model.prj_dbt.count_converted_time
21:05:10.903373 [debug] [Thread-6  ]: Began compiling node model.prj_dbt.count_converted_time_source
21:05:10.904379 [debug] [Thread-6  ]: Compiling model.prj_dbt.count_converted_time_source
21:05:10.907345 [debug] [Thread-5  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time"
21:05:10.911336 [debug] [Thread-6  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time_source"
21:05:10.914327 [debug] [Thread-5  ]: finished collecting timing info
21:05:10.914327 [debug] [Thread-5  ]: Began executing node model.prj_dbt.count_converted_time
21:05:10.915324 [debug] [Thread-6  ]: finished collecting timing info
21:05:10.922305 [debug] [Thread-5  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time"
21:05:10.923303 [debug] [Thread-6  ]: Began executing node model.prj_dbt.count_converted_time_source
21:05:10.929289 [debug] [Thread-6  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time_source"
21:05:10.931282 [debug] [Thread-5  ]: Using snowflake connection "model.prj_dbt.count_converted_time"
21:05:10.931282 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time
  
   as (
    --

select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  );
21:05:10.932279 [debug] [Thread-5  ]: Opening a new connection, currently in state init
21:05:10.933276 [debug] [Thread-6  ]: Using snowflake connection "model.prj_dbt.count_converted_time_source"
21:05:10.936268 [debug] [Thread-6  ]: On model.prj_dbt.count_converted_time_source: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time_source"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time_source
  
   as (
    --

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

)

select
    *
    leads.source,
from conversion_date
left join leads
    using (lead_id)
  );
21:05:10.938265 [debug] [Thread-6  ]: Opening a new connection, currently in state init
21:05:11.965182 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.03 seconds
21:05:11.969175 [debug] [Thread-5  ]: finished collecting timing info
21:05:11.969175 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time: Close
21:05:12.011456 [debug] [Thread-6  ]: Snowflake adapter: Snowflake query id: 01a41207-0c03-01e9-0000-00024a1e920d
21:05:12.012449 [debug] [Thread-6  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 4 unexpected 'leads'.
21:05:12.012449 [debug] [Thread-6  ]: finished collecting timing info
21:05:12.013445 [debug] [Thread-6  ]: On model.prj_dbt.count_converted_time_source: Close
21:05:12.096922 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09869af9-8a1f-4cc2-94b5-5cb2a3d9a8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D349959790>]}
21:05:12.097949 [info ] [Thread-5  ]: 4 of 5 OK created view model CUSTOMERS.count_converted_time .................... [[32mSUCCESS 1[0m in 1.20s]
21:05:12.098913 [debug] [Thread-5  ]: Finished running node model.prj_dbt.count_converted_time
21:05:12.118082 [debug] [Thread-6  ]: Database Error in model count_converted_time_source (models\count_converted_time_source.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'leads'.
  compiled SQL at target\run\prj_dbt\models\count_converted_time_source.sql
21:05:12.119071 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09869af9-8a1f-4cc2-94b5-5cb2a3d9a8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3499BCF10>]}
21:05:12.119071 [error] [Thread-6  ]: 5 of 5 ERROR creating view model CUSTOMERS.count_converted_time_source ......... [[31mERROR[0m in 1.22s]
21:05:12.120068 [debug] [Thread-6  ]: Finished running node model.prj_dbt.count_converted_time_source
21:05:12.123060 [debug] [MainThread]: Acquiring new snowflake connection "master"
21:05:12.124056 [info ] [MainThread]: 
21:05:12.124056 [info ] [MainThread]: Finished running 5 view models in 4.51s.
21:05:12.125054 [debug] [MainThread]: Connection 'master' was properly closed.
21:05:12.126052 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
21:05:12.126052 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
21:05:12.126052 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
21:05:12.127079 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
21:05:12.127284 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
21:05:12.127284 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time' was properly closed.
21:05:12.127284 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time_source' was properly closed.
21:05:12.136378 [info ] [MainThread]: 
21:05:12.136378 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
21:05:12.137377 [info ] [MainThread]: 
21:05:12.138374 [error] [MainThread]: [33mDatabase Error in model count_converted_time_source (models\count_converted_time_source.sql)[0m
21:05:12.140367 [error] [MainThread]:   001003 (42000): SQL compilation error:
21:05:12.141364 [error] [MainThread]:   syntax error line 20 at position 4 unexpected 'leads'.
21:05:12.141364 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\count_converted_time_source.sql
21:05:12.143360 [info ] [MainThread]: 
21:05:12.144356 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
21:05:12.145353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3499C87F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D34970BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D349694370>]}


============================== 2022-05-06 14:21:40.673344 | 93caabf4-1191-4831-bd4f-b50360cfc18e ==============================
14:21:40.673344 [info ] [MainThread]: Running with dbt=1.1.0
14:21:40.674352 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
14:21:40.675340 [debug] [MainThread]: Tracking: tracking
14:21:40.676338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028343758B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028343758BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028343758C10>]}
14:21:40.787945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:21:40.787945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:21:40.788931 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

14:21:40.801896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93caabf4-1191-4831-bd4f-b50360cfc18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028343847AF0>]}
14:21:40.812867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93caabf4-1191-4831-bd4f-b50360cfc18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028343797C40>]}
14:21:40.813865 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
14:21:40.814862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93caabf4-1191-4831-bd4f-b50360cfc18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028343797B20>]}
14:21:40.817855 [info ] [MainThread]: 
14:21:40.818853 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
14:21:40.829821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028343743850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028343743C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028343797490>]}


============================== 2022-05-06 16:55:55.804255 | 87e4c360-d56f-4345-9998-3d932ba2c099 ==============================
16:55:55.804255 [info ] [MainThread]: Running with dbt=1.1.0
16:55:55.805256 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:55:55.805256 [debug] [MainThread]: Tracking: tracking
16:55:55.806250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114F2DD7CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114F2DD7D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114F2DD7D60>]}
16:55:55.857239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114F2E32E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114F2E2D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114F2E2D340>]}


============================== 2022-05-06 16:58:17.680343 | e2afca71-d654-496a-9c75-2d5e402fb096 ==============================
16:58:17.680343 [info ] [MainThread]: Running with dbt=1.1.0
16:58:17.681341 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:58:17.682368 [debug] [MainThread]: Tracking: tracking
16:58:17.682368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D34E8B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D34E8BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D34E8C40>]}
16:58:17.782689 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 4 files added, 3 files changed.
16:58:17.782689 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\regression_ML\leads_comprehensive.sql
16:58:17.783685 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\staging\schema.yml
16:58:17.783685 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\dashboard\count_converted_time.sql
16:58:17.784684 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\dashboard\count_converted_time_source.sql
16:58:17.784684 [debug] [MainThread]: Partial parsing: deleted file: prj_dbt://models\count_converted_time.sql
16:58:17.784684 [debug] [MainThread]: Partial parsing: deleted file: prj_dbt://models\count_converted_time_source.sql
16:58:17.785786 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_opportunities.sql
16:58:17.785786 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_conversion_date.sql
16:58:17.785786 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_leads.sql
16:58:17.806452 [debug] [MainThread]: 1699: static parser successfully parsed mart\regression_ML\leads_comprehensive.sql
16:58:17.822331 [debug] [MainThread]: 1699: static parser successfully parsed mart\dashboard\count_converted_time.sql
16:58:17.824325 [debug] [MainThread]: 1699: static parser successfully parsed mart\dashboard\count_converted_time_source.sql
16:58:17.827451 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_opportunities.sql
16:58:17.829449 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_conversion_date.sql
16:58:17.832438 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_leads.sql
16:58:17.843632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D35DE3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D363EE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D363EF40>]}


============================== 2022-05-06 16:59:09.478692 | f7ec564b-dff9-4e8d-85ea-d6d5c84c5a35 ==============================
16:59:09.478692 [info ] [MainThread]: Running with dbt=1.1.0
16:59:09.479661 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:59:09.480661 [debug] [MainThread]: Tracking: tracking
16:59:09.480661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D4669B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D4669B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D4669BE0>]}
16:59:09.572500 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 4 files added, 3 files changed.
16:59:09.573497 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\regression_ML\leads_comprehensive.sql
16:59:09.575492 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\dashboard\count_converted_time.sql
16:59:09.575492 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\dashboard\count_converted_time_source.sql
16:59:09.576728 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\staging\schema.yml
16:59:09.577759 [debug] [MainThread]: Partial parsing: deleted file: prj_dbt://models\count_converted_time_source.sql
16:59:09.577759 [debug] [MainThread]: Partial parsing: deleted file: prj_dbt://models\count_converted_time.sql
16:59:09.578722 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_opportunities.sql
16:59:09.579754 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_leads.sql
16:59:09.579754 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_conversion_date.sql
16:59:09.593942 [debug] [MainThread]: 1699: static parser successfully parsed mart\regression_ML\leads_comprehensive.sql
16:59:09.610926 [debug] [MainThread]: 1699: static parser successfully parsed mart\dashboard\count_converted_time.sql
16:59:09.613891 [debug] [MainThread]: 1699: static parser successfully parsed mart\dashboard\count_converted_time_source.sql
16:59:09.616883 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_opportunities.sql
16:59:09.619875 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_leads.sql
16:59:09.622867 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_conversion_date.sql
16:59:09.641845 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_conversion_dates' in the 'models' section of file 'models\staging\schema.yml'
16:59:09.718484 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.unique_stg_conversion_dates_lead_id.b1ec00ccec' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
16:59:09.719481 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_lead_id.85352c1233' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
16:59:09.720478 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_converted_at.9adca99aba' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
16:59:09.721476 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_month.b79d2fee61' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
16:59:09.722473 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_week.0ccef7f02c' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
16:59:09.723480 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_day.37451531ea' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
16:59:09.724468 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_month_name.abaac3491c' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
16:59:09.725465 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_day_name.c23f98e5d7' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
16:59:09.735439 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

16:59:09.747566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7ec564b-dff9-4e8d-85ea-d6d5c84c5a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D47FFF40>]}
16:59:09.760528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7ec564b-dff9-4e8d-85ea-d6d5c84c5a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D474F1F0>]}
16:59:09.761526 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
16:59:09.762524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ec564b-dff9-4e8d-85ea-d6d5c84c5a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D474F070>]}
16:59:09.765515 [info ] [MainThread]: 
16:59:09.766797 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:59:09.768792 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
16:59:09.787959 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
16:59:09.788985 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
16:59:09.788985 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:59:10.647883 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.86 seconds
16:59:10.649879 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
16:59:10.784363 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
16:59:10.801318 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
16:59:10.802315 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
16:59:10.802315 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:59:11.594091 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.79 seconds
16:59:11.597086 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
16:59:11.792678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ec564b-dff9-4e8d-85ea-d6d5c84c5a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D49B3820>]}
16:59:11.792678 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:59:11.793675 [info ] [MainThread]: 
16:59:11.814620 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
16:59:11.815655 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
16:59:11.815655 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
16:59:11.816616 [info ] [Thread-1  ]: 1 of 6 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
16:59:11.817614 [info ] [Thread-2  ]: 2 of 6 START view model CUSTOMERS.stg_leads .................................... [RUN]
16:59:11.818621 [info ] [Thread-3  ]: 3 of 6 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
16:59:11.820604 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
16:59:11.821603 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
16:59:11.821603 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
16:59:11.822600 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
16:59:11.822600 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
16:59:11.822600 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
16:59:11.823597 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
16:59:11.823597 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
16:59:11.825590 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
16:59:11.825590 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
16:59:11.828585 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
16:59:11.831577 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
16:59:11.832572 [debug] [Thread-1  ]: finished collecting timing info
16:59:11.833570 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
16:59:11.867478 [debug] [Thread-2  ]: finished collecting timing info
16:59:11.875456 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
16:59:11.875456 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
16:59:11.876454 [debug] [Thread-3  ]: finished collecting timing info
16:59:11.879445 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
16:59:11.880443 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
16:59:11.881440 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
16:59:11.886430 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
16:59:11.887435 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as "lead_id",
    converted_at,
    date_part('month', converted_at) as "month",
    date_part('week', converted_at) as "week",
    date_part('day', converted_at) as "day",
    to_char(converted_at, 'Mon') as "month_name",
    to_char(converted_at, 'Dy') as "day_name"
from leads
where converted_at is not null
  );
16:59:11.890418 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
16:59:11.890418 [debug] [Thread-1  ]: Opening a new connection, currently in state init
16:59:11.891414 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id as "lead_id",
    case
        when converted_at is null then 0
        else 1
    end as "is_converted",
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
16:59:11.895404 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
16:59:11.898395 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:59:11.900392 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as "is_closed",
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as "is_won"
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
16:59:11.904380 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:59:12.995518 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.1 seconds
16:59:13.003528 [debug] [Thread-2  ]: finished collecting timing info
16:59:13.003528 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
16:59:13.157796 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ec564b-dff9-4e8d-85ea-d6d5c84c5a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D4B94490>]}
16:59:13.158795 [info ] [Thread-2  ]: 2 of 6 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.34s]
16:59:13.160789 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
16:59:13.195695 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.29 seconds
16:59:13.197689 [debug] [Thread-3  ]: finished collecting timing info
16:59:13.197689 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
16:59:13.233921 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.34 seconds
16:59:13.235936 [debug] [Thread-1  ]: finished collecting timing info
16:59:13.235936 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
16:59:13.314847 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ec564b-dff9-4e8d-85ea-d6d5c84c5a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D4B94D60>]}
16:59:13.315846 [info ] [Thread-3  ]: 3 of 6 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.49s]
16:59:13.317063 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
16:59:13.589859 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ec564b-dff9-4e8d-85ea-d6d5c84c5a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D4B4E0A0>]}
16:59:13.589859 [info ] [Thread-1  ]: 1 of 6 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.77s]
16:59:13.591855 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
16:59:13.595808 [debug] [Thread-5  ]: Began running node model.prj_dbt.count_converted_time
16:59:13.595808 [debug] [Thread-6  ]: Began running node model.prj_dbt.count_converted_time_source
16:59:13.596810 [debug] [Thread-7  ]: Began running node model.prj_dbt.leads_comprehensive
16:59:13.596810 [info ] [Thread-5  ]: 4 of 6 START view model CUSTOMERS.count_converted_time ......................... [RUN]
16:59:13.597804 [info ] [Thread-6  ]: 5 of 6 START view model CUSTOMERS.count_converted_time_source .................. [RUN]
16:59:13.598835 [info ] [Thread-7  ]: 6 of 6 START view model CUSTOMERS.leads_comprehensive .......................... [RUN]
16:59:13.600799 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time"
16:59:13.601795 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time_source"
16:59:13.602790 [debug] [Thread-5  ]: Began compiling node model.prj_dbt.count_converted_time
16:59:13.602790 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.prj_dbt.leads_comprehensive"
16:59:13.603791 [debug] [Thread-6  ]: Began compiling node model.prj_dbt.count_converted_time_source
16:59:13.603791 [debug] [Thread-5  ]: Compiling model.prj_dbt.count_converted_time
16:59:13.604786 [debug] [Thread-7  ]: Began compiling node model.prj_dbt.leads_comprehensive
16:59:13.604786 [debug] [Thread-6  ]: Compiling model.prj_dbt.count_converted_time_source
16:59:13.608772 [debug] [Thread-5  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time"
16:59:13.609770 [debug] [Thread-7  ]: Compiling model.prj_dbt.leads_comprehensive
16:59:13.611794 [debug] [Thread-6  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time_source"
16:59:13.614756 [debug] [Thread-7  ]: Writing injected SQL for node "model.prj_dbt.leads_comprehensive"
16:59:13.618747 [debug] [Thread-6  ]: finished collecting timing info
16:59:13.618747 [debug] [Thread-5  ]: finished collecting timing info
16:59:13.619744 [debug] [Thread-6  ]: Began executing node model.prj_dbt.count_converted_time_source
16:59:13.619744 [debug] [Thread-7  ]: finished collecting timing info
16:59:13.619744 [debug] [Thread-5  ]: Began executing node model.prj_dbt.count_converted_time
16:59:13.623735 [debug] [Thread-6  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time_source"
16:59:13.623735 [debug] [Thread-7  ]: Began executing node model.prj_dbt.leads_comprehensive
16:59:13.626762 [debug] [Thread-5  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time"
16:59:13.629747 [debug] [Thread-7  ]: Writing runtime SQL for node "model.prj_dbt.leads_comprehensive"
16:59:13.634703 [debug] [Thread-5  ]: Using snowflake connection "model.prj_dbt.count_converted_time"
16:59:13.636707 [debug] [Thread-6  ]: Using snowflake connection "model.prj_dbt.count_converted_time_source"
16:59:13.636707 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time
  
   as (
    --

select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  );
16:59:13.638728 [debug] [Thread-7  ]: Using snowflake connection "model.prj_dbt.leads_comprehensive"
16:59:13.638728 [debug] [Thread-6  ]: On model.prj_dbt.count_converted_time_source: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time_source"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time_source
  
   as (
    --

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

)

select
    *
    leads.source,
from conversion_date
left join leads
    using (lead_id)
  );
16:59:13.639690 [debug] [Thread-5  ]: Opening a new connection, currently in state init
16:59:13.639690 [debug] [Thread-7  ]: On model.prj_dbt.leads_comprehensive: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.leads_comprehensive"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.leads_comprehensive
  
   as (
    -- MODEL TO FACILITATE REGRESSION AND ML ANALYSES

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select
      lead_id,
      month,
      week,
      day,
      month_name,
      day_name
    from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

),

opportunities as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_opportunities

)

select
    *
from leads
inner join conversion_date
    using (lead_id)
inner join stg_opportunities
    using (lead_id)
  );
16:59:13.639690 [debug] [Thread-6  ]: Opening a new connection, currently in state init
16:59:13.641684 [debug] [Thread-7  ]: Opening a new connection, currently in state init
16:59:14.491692 [debug] [Thread-6  ]: Snowflake adapter: Snowflake query id: 01a416b1-0c03-02c6-0002-4a1e0001105e
16:59:14.491692 [debug] [Thread-6  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 4 unexpected 'leads'.
16:59:14.492718 [debug] [Thread-6  ]: finished collecting timing info
16:59:14.492718 [debug] [Thread-6  ]: On model.prj_dbt.count_converted_time_source: Close
16:59:14.571405 [debug] [Thread-7  ]: Snowflake adapter: Snowflake query id: 01a416b1-0c03-020d-0002-4a1e00012062
16:59:14.572405 [debug] [Thread-7  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 6
invalid identifier 'LEAD_ID'
16:59:14.572405 [debug] [Thread-7  ]: finished collecting timing info
16:59:14.573400 [debug] [Thread-7  ]: On model.prj_dbt.leads_comprehensive: Close
16:59:14.610609 [debug] [Thread-6  ]: Database Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'leads'.
  compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
16:59:14.610609 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ec564b-dff9-4e8d-85ea-d6d5c84c5a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D4BF2E50>]}
16:59:14.610609 [error] [Thread-6  ]: 5 of 6 ERROR creating view model CUSTOMERS.count_converted_time_source ......... [[31mERROR[0m in 1.01s]
16:59:14.611607 [debug] [Thread-6  ]: Finished running node model.prj_dbt.count_converted_time_source
16:59:14.668483 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.03 seconds
16:59:14.670464 [debug] [Thread-5  ]: finished collecting timing info
16:59:14.670464 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time: Close
16:59:14.682589 [debug] [Thread-7  ]: Database Error in model leads_comprehensive (models\mart\regression_ML\leads_comprehensive.sql)
  000904 (42000): SQL compilation error: error line 15 at position 6
  invalid identifier 'LEAD_ID'
  compiled SQL at target\run\prj_dbt\models\mart\regression_ML\leads_comprehensive.sql
16:59:14.682589 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ec564b-dff9-4e8d-85ea-d6d5c84c5a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D4BF93A0>]}
16:59:14.683600 [error] [Thread-7  ]: 6 of 6 ERROR creating view model CUSTOMERS.leads_comprehensive ................. [[31mERROR[0m in 1.08s]
16:59:14.684583 [debug] [Thread-7  ]: Finished running node model.prj_dbt.leads_comprehensive
16:59:14.782296 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ec564b-dff9-4e8d-85ea-d6d5c84c5a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D4BD0D90>]}
16:59:14.783324 [info ] [Thread-5  ]: 4 of 6 OK created view model CUSTOMERS.count_converted_time .................... [[32mSUCCESS 1[0m in 1.18s]
16:59:14.784294 [debug] [Thread-5  ]: Finished running node model.prj_dbt.count_converted_time
16:59:14.786293 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:59:14.787283 [info ] [MainThread]: 
16:59:14.788305 [info ] [MainThread]: Finished running 6 view models in 5.02s.
16:59:14.788305 [debug] [MainThread]: Connection 'master' was properly closed.
16:59:14.789303 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
16:59:14.789303 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
16:59:14.789303 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
16:59:14.790301 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
16:59:14.790301 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
16:59:14.790301 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time' was properly closed.
16:59:14.790301 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time_source' was properly closed.
16:59:14.791272 [debug] [MainThread]: Connection 'model.prj_dbt.leads_comprehensive' was properly closed.
16:59:14.805234 [info ] [MainThread]: 
16:59:14.806231 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
16:59:14.807231 [info ] [MainThread]: 
16:59:14.809225 [error] [MainThread]: [33mDatabase Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)[0m
16:59:14.810221 [error] [MainThread]:   001003 (42000): SQL compilation error:
16:59:14.811219 [error] [MainThread]:   syntax error line 20 at position 4 unexpected 'leads'.
16:59:14.813213 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
16:59:14.814210 [info ] [MainThread]: 
16:59:14.815207 [error] [MainThread]: [33mDatabase Error in model leads_comprehensive (models\mart\regression_ML\leads_comprehensive.sql)[0m
16:59:14.817209 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 15 at position 6
16:59:14.818202 [error] [MainThread]:   invalid identifier 'LEAD_ID'
16:59:14.819200 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\mart\regression_ML\leads_comprehensive.sql
16:59:14.821224 [info ] [MainThread]: 
16:59:14.822191 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
16:59:14.823196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D473FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D474F2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D474F310>]}


============================== 2022-05-06 17:04:25.196812 | 190e0c8a-68f6-4689-b157-3dcdf54d00f9 ==============================
17:04:25.196812 [info ] [MainThread]: Running with dbt=1.1.0
17:04:25.197809 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:04:25.197809 [debug] [MainThread]: Tracking: tracking
17:04:25.198807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026170C08B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026170C08BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026170C08C40>]}
17:04:25.280146 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
17:04:25.281150 [debug] [MainThread]: Partial parsing: deleted file: prj_dbt://models\mart\dashboard\count_converted_time.sql
17:04:25.281150 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_conversion_date.sql
17:04:25.282139 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_leads.sql
17:04:25.294208 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_conversion_date.sql
17:04:25.306516 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_leads.sql
17:04:25.349915 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

17:04:25.362909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '190e0c8a-68f6-4689-b157-3dcdf54d00f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026170D68E80>]}
17:04:25.375845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '190e0c8a-68f6-4689-b157-3dcdf54d00f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026170D10B80>]}
17:04:25.376843 [info ] [MainThread]: Found 5 models, 12 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
17:04:25.377839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '190e0c8a-68f6-4689-b157-3dcdf54d00f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026170CD1640>]}
17:04:25.380833 [info ] [MainThread]: 
17:04:25.381831 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:04:25.383825 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:04:25.401774 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:04:25.401774 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
17:04:25.401774 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:04:26.171863 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.77 seconds
17:04:26.178255 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
17:04:26.270262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '190e0c8a-68f6-4689-b157-3dcdf54d00f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026170CD1550>]}
17:04:26.271259 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:04:26.271259 [info ] [MainThread]: 
17:04:26.283444 [debug] [Thread-1  ]: Began running node test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3
17:04:26.284442 [debug] [Thread-2  ]: Began running node test.prj_dbt.not_null_stg_leads_industry.756be64d1e
17:04:26.284442 [debug] [Thread-3  ]: Began running node test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50
17:04:26.284442 [info ] [Thread-1  ]: 1 of 12 START test not_null_stg_leads_fleet_size ............................... [RUN]
17:04:26.285439 [debug] [Thread-4  ]: Began running node test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9
17:04:26.285439 [debug] [Thread-5  ]: Began running node test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b
17:04:26.285439 [debug] [Thread-6  ]: Began running node test.prj_dbt.not_null_stg_leads_source.4210778975
17:04:26.286542 [debug] [Thread-7  ]: Began running node test.prj_dbt.not_null_stg_leads_state.9404fcc7f8
17:04:26.286645 [info ] [Thread-2  ]: 2 of 12 START test not_null_stg_leads_industry ................................. [RUN]
17:04:26.286645 [debug] [Thread-8  ]: Began running node test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7
17:04:26.286645 [debug] [Thread-9  ]: Began running node test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54
17:04:26.286645 [debug] [Thread-10 ]: Began running node test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21
17:04:26.287642 [info ] [Thread-3  ]: 3 of 12 START test not_null_stg_leads_is_converted ............................. [RUN]
17:04:26.287642 [info ] [Thread-4  ]: 4 of 12 START test not_null_stg_leads_job_title ................................ [RUN]
17:04:26.288640 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3"
17:04:26.289637 [info ] [Thread-5  ]: 5 of 12 START test not_null_stg_leads_lead_id .................................. [RUN]
17:04:26.289637 [info ] [Thread-6  ]: 6 of 12 START test not_null_stg_leads_source ................................... [RUN]
17:04:26.290635 [info ] [Thread-7  ]: 7 of 12 START test not_null_stg_leads_state .................................... [RUN]
17:04:26.291632 [info ] [Thread-8  ]: 8 of 12 START test not_null_stg_opportunities_is_closed ........................ [RUN]
17:04:26.292639 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_industry.756be64d1e"
17:04:26.293670 [info ] [Thread-9  ]: 9 of 12 START test not_null_stg_opportunities_is_won ........................... [RUN]
17:04:26.293670 [info ] [Thread-10 ]: 10 of 12 START test not_null_stg_opportunities_lead_id ......................... [RUN]
17:04:26.295624 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50"
17:04:26.295624 [debug] [Thread-1  ]: Began compiling node test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3
17:04:26.295624 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9"
17:04:26.296833 [debug] [Thread-5  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b"
17:04:26.297831 [debug] [Thread-6  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_source.4210778975"
17:04:26.298838 [debug] [Thread-7  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_state.9404fcc7f8"
17:04:26.299830 [debug] [Thread-2  ]: Began compiling node test.prj_dbt.not_null_stg_leads_industry.756be64d1e
17:04:26.299830 [debug] [Thread-8  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7"
17:04:26.305824 [debug] [Thread-8  ]: Began compiling node test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7
17:04:26.301819 [debug] [Thread-3  ]: Began compiling node test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50
17:04:26.302829 [debug] [Thread-10 ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21"
17:04:26.302829 [debug] [Thread-1  ]: Compiling test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3
17:04:26.302829 [debug] [Thread-4  ]: Began compiling node test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9
17:04:26.303855 [debug] [Thread-5  ]: Began compiling node test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b
17:04:26.303855 [debug] [Thread-6  ]: Began compiling node test.prj_dbt.not_null_stg_leads_source.4210778975
17:04:26.304811 [debug] [Thread-7  ]: Began compiling node test.prj_dbt.not_null_stg_leads_state.9404fcc7f8
17:04:26.304811 [debug] [Thread-2  ]: Compiling test.prj_dbt.not_null_stg_leads_industry.756be64d1e
17:04:26.301819 [debug] [Thread-9  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54"
17:04:26.306806 [debug] [Thread-8  ]: Compiling test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7
17:04:26.306806 [debug] [Thread-3  ]: Compiling test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50
17:04:26.307846 [debug] [Thread-10 ]: Began compiling node test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21
17:04:26.320769 [debug] [Thread-1  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3"
17:04:26.321766 [debug] [Thread-4  ]: Compiling test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9
17:04:26.322765 [debug] [Thread-5  ]: Compiling test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b
17:04:26.322765 [debug] [Thread-6  ]: Compiling test.prj_dbt.not_null_stg_leads_source.4210778975
17:04:26.322765 [debug] [Thread-7  ]: Compiling test.prj_dbt.not_null_stg_leads_state.9404fcc7f8
17:04:26.328749 [debug] [Thread-2  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_industry.756be64d1e"
17:04:26.329764 [debug] [Thread-9  ]: Began compiling node test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54
17:04:26.332767 [debug] [Thread-8  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7"
17:04:26.335730 [debug] [Thread-3  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50"
17:04:26.336728 [debug] [Thread-10 ]: Compiling test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21
17:04:26.340749 [debug] [Thread-4  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9"
17:04:26.345732 [debug] [Thread-5  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b"
17:04:26.349691 [debug] [Thread-6  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_source.4210778975"
17:04:26.353683 [debug] [Thread-7  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_state.9404fcc7f8"
17:04:26.354678 [debug] [Thread-9  ]: Compiling test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54
17:04:26.354678 [debug] [Thread-1  ]: finished collecting timing info
17:04:26.361660 [debug] [Thread-10 ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21"
17:04:26.361660 [debug] [Thread-2  ]: finished collecting timing info
17:04:26.362656 [debug] [Thread-8  ]: finished collecting timing info
17:04:26.364652 [debug] [Thread-3  ]: finished collecting timing info
17:04:26.370636 [debug] [Thread-9  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54"
17:04:26.370636 [debug] [Thread-4  ]: finished collecting timing info
17:04:26.371632 [debug] [Thread-5  ]: finished collecting timing info
17:04:26.371632 [debug] [Thread-1  ]: Began executing node test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3
17:04:26.372630 [debug] [Thread-6  ]: finished collecting timing info
17:04:26.373627 [debug] [Thread-2  ]: Began executing node test.prj_dbt.not_null_stg_leads_industry.756be64d1e
17:04:26.373627 [debug] [Thread-7  ]: finished collecting timing info
17:04:26.374625 [debug] [Thread-8  ]: Began executing node test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7
17:04:26.374625 [debug] [Thread-3  ]: Began executing node test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50
17:04:26.374625 [debug] [Thread-10 ]: finished collecting timing info
17:04:26.375625 [debug] [Thread-4  ]: Began executing node test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9
17:04:26.376750 [debug] [Thread-5  ]: Began executing node test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b
17:04:26.384727 [debug] [Thread-9  ]: finished collecting timing info
17:04:26.404790 [debug] [Thread-1  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3"
17:04:26.405787 [debug] [Thread-6  ]: Began executing node test.prj_dbt.not_null_stg_leads_source.4210778975
17:04:26.408779 [debug] [Thread-2  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_industry.756be64d1e"
17:04:26.409776 [debug] [Thread-7  ]: Began executing node test.prj_dbt.not_null_stg_leads_state.9404fcc7f8
17:04:26.411773 [debug] [Thread-8  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7"
17:04:26.414765 [debug] [Thread-3  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50"
17:04:26.414765 [debug] [Thread-10 ]: Began executing node test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21
17:04:26.418752 [debug] [Thread-4  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9"
17:04:26.421744 [debug] [Thread-5  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b"
17:04:26.421744 [debug] [Thread-9  ]: Began executing node test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54
17:04:26.424736 [debug] [Thread-6  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_source.4210778975"
17:04:26.427729 [debug] [Thread-7  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_state.9404fcc7f8"
17:04:26.431717 [debug] [Thread-10 ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21"
17:04:26.433714 [debug] [Thread-1  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3"
17:04:26.435709 [debug] [Thread-2  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_industry.756be64d1e"
17:04:26.436708 [debug] [Thread-8  ]: Using snowflake connection "test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7"
17:04:26.437701 [debug] [Thread-3  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50"
17:04:26.440695 [debug] [Thread-9  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54"
17:04:26.441693 [debug] [Thread-4  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9"
17:04:26.443687 [debug] [Thread-5  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b"
17:04:26.444683 [debug] [Thread-1  ]: On test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fleet_size
from FLEETIO_DBT.CUSTOMERS.stg_leads
where fleet_size is null



      
    ) dbt_internal_test
17:04:26.445681 [debug] [Thread-6  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_source.4210778975"
17:04:26.446677 [debug] [Thread-2  ]: On test.prj_dbt.not_null_stg_leads_industry.756be64d1e: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_industry.756be64d1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select industry
from FLEETIO_DBT.CUSTOMERS.stg_leads
where industry is null



      
    ) dbt_internal_test
17:04:26.447678 [debug] [Thread-10 ]: Using snowflake connection "test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21"
17:04:26.448672 [debug] [Thread-7  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_state.9404fcc7f8"
17:04:26.448672 [debug] [Thread-8  ]: On test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_closed
from FLEETIO_DBT.CUSTOMERS.stg_opportunities
where is_closed is null



      
    ) dbt_internal_test
17:04:26.449671 [debug] [Thread-3  ]: On test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_converted
from FLEETIO_DBT.CUSTOMERS.stg_leads
where is_converted is null



      
    ) dbt_internal_test
17:04:26.449671 [debug] [Thread-4  ]: On test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select job_title
from FLEETIO_DBT.CUSTOMERS.stg_leads
where job_title is null



      
    ) dbt_internal_test
17:04:26.450666 [debug] [Thread-5  ]: On test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lead_id
from FLEETIO_DBT.CUSTOMERS.stg_leads
where lead_id is null



      
    ) dbt_internal_test
17:04:26.450666 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:04:26.451664 [debug] [Thread-6  ]: On test.prj_dbt.not_null_stg_leads_source.4210778975: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_source.4210778975"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select source
from FLEETIO_DBT.CUSTOMERS.stg_leads
where source is null



      
    ) dbt_internal_test
17:04:26.452691 [debug] [Thread-9  ]: Using snowflake connection "test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54"
17:04:26.452691 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:04:26.453660 [debug] [Thread-10 ]: On test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lead_id
from FLEETIO_DBT.CUSTOMERS.stg_opportunities
where lead_id is null



      
    ) dbt_internal_test
17:04:26.453660 [debug] [Thread-7  ]: On test.prj_dbt.not_null_stg_leads_state.9404fcc7f8: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_state.9404fcc7f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select state
from FLEETIO_DBT.CUSTOMERS.stg_leads
where state is null



      
    ) dbt_internal_test
17:04:26.453660 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:04:26.454656 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:04:26.454656 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:04:26.455653 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:04:26.458645 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:04:26.459643 [debug] [Thread-9  ]: On test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_won
from FLEETIO_DBT.CUSTOMERS.stg_opportunities
where is_won is null



      
    ) dbt_internal_test
17:04:26.463632 [debug] [Thread-10 ]: Opening a new connection, currently in state init
17:04:26.466627 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:04:26.490560 [debug] [Thread-9  ]: Opening a new connection, currently in state init
17:04:27.514319 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.06 seconds
17:04:27.531272 [debug] [Thread-1  ]: finished collecting timing info
17:04:27.535261 [debug] [Thread-1  ]: On test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3: Close
17:04:27.694952 [info ] [Thread-1  ]: 1 of 12 PASS not_null_stg_leads_fleet_size ..................................... [[32mPASS[0m in 1.41s]
17:04:27.697959 [debug] [Thread-1  ]: Finished running node test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3
17:04:27.699966 [debug] [Thread-1  ]: Began running node test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf
17:04:27.701933 [info ] [Thread-1  ]: 11 of 12 START test unique_stg_leads_lead_id ................................... [RUN]
17:04:27.708914 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf"
17:04:27.714904 [debug] [Thread-1  ]: Began compiling node test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf
17:04:27.718890 [debug] [Thread-1  ]: Compiling test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf
17:04:27.728861 [debug] [Thread-1  ]: Writing injected SQL for node "test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf"
17:04:27.746815 [debug] [Thread-1  ]: finished collecting timing info
17:04:27.749844 [debug] [Thread-1  ]: Began executing node test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf
17:04:27.757812 [debug] [Thread-1  ]: Writing runtime SQL for node "test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf"
17:04:27.785933 [debug] [Thread-1  ]: Using snowflake connection "test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf"
17:04:27.792911 [debug] [Thread-1  ]: On test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    lead_id as unique_field,
    count(*) as n_records

from FLEETIO_DBT.CUSTOMERS.stg_leads
where lead_id is not null
group by lead_id
having count(*) > 1



      
    ) dbt_internal_test
17:04:27.808899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:04:28.773771 [debug] [Thread-8  ]: Snowflake adapter: Snowflake query id: 01a416b6-0c03-02fe-0000-00024a1ef091
17:04:28.774795 [debug] [Thread-8  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'IS_CLOSED'
17:04:28.774795 [debug] [Thread-8  ]: finished collecting timing info
17:04:28.775792 [debug] [Thread-8  ]: On test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7: Close
17:04:28.817683 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a416b6-0c03-0218-0002-4a1e0001403a
17:04:28.817683 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'IS_CONVERTED'
17:04:28.817683 [debug] [Thread-3  ]: finished collecting timing info
17:04:28.818679 [debug] [Thread-3  ]: On test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50: Close
17:04:28.848570 [debug] [Thread-9  ]: Snowflake adapter: Snowflake query id: 01a416b6-0c03-0218-0002-4a1e00014036
17:04:28.848570 [debug] [Thread-9  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'IS_WON'
17:04:28.849567 [debug] [Thread-9  ]: finished collecting timing info
17:04:28.850611 [debug] [Thread-9  ]: On test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54: Close
17:04:28.873503 [debug] [Thread-8  ]: Database Error in test not_null_stg_opportunities_is_closed (models\staging\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'IS_CLOSED'
  compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_opportunities_is_closed.sql
17:04:28.873503 [error] [Thread-8  ]: 8 of 12 ERROR not_null_stg_opportunities_is_closed ............................. [[31mERROR[0m in 2.57s]
17:04:28.874501 [debug] [Thread-8  ]: Finished running node test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7
17:04:28.874501 [debug] [Thread-8  ]: Began running node test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d
17:04:28.875498 [info ] [Thread-8  ]: 12 of 12 START test unique_stg_opportunities_lead_id ........................... [RUN]
17:04:28.876542 [debug] [Thread-8  ]: Acquiring new snowflake connection "test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d"
17:04:28.876542 [debug] [Thread-8  ]: Began compiling node test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d
17:04:28.876542 [debug] [Thread-8  ]: Compiling test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d
17:04:28.881481 [debug] [Thread-8  ]: Writing injected SQL for node "test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d"
17:04:28.883477 [debug] [Thread-8  ]: finished collecting timing info
17:04:28.886469 [debug] [Thread-8  ]: Began executing node test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d
17:04:28.888463 [debug] [Thread-8  ]: Writing runtime SQL for node "test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d"
17:04:28.893450 [debug] [Thread-8  ]: Using snowflake connection "test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d"
17:04:28.893450 [debug] [Thread-8  ]: On test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    lead_id as unique_field,
    count(*) as n_records

from FLEETIO_DBT.CUSTOMERS.stg_opportunities
where lead_id is not null
group by lead_id
having count(*) > 1



      
    ) dbt_internal_test
17:04:28.894448 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
17:04:28.909409 [debug] [Thread-3  ]: Database Error in test not_null_stg_leads_is_converted (models\staging\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'IS_CONVERTED'
  compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_leads_is_converted.sql
17:04:28.909409 [error] [Thread-3  ]: 3 of 12 ERROR not_null_stg_leads_is_converted .................................. [[31mERROR[0m in 2.61s]
17:04:28.910405 [debug] [Thread-3  ]: Finished running node test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50
17:04:28.949309 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a416b6-0c03-0218-0002-4a1e00014042
17:04:28.949309 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a416b6-0c03-0218-0002-4a1e0001403e
17:04:28.950299 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'LEAD_ID'
17:04:28.950299 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'LEAD_ID'
17:04:28.951311 [debug] [Thread-5  ]: finished collecting timing info
17:04:28.951311 [debug] [Thread-1  ]: finished collecting timing info
17:04:28.952294 [debug] [Thread-5  ]: On test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b: Close
17:04:28.952294 [debug] [Thread-1  ]: On test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf: Close
17:04:28.963263 [debug] [Thread-9  ]: Database Error in test not_null_stg_opportunities_is_won (models\staging\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'IS_WON'
  compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_opportunities_is_won.sql
17:04:28.966257 [error] [Thread-9  ]: 9 of 12 ERROR not_null_stg_opportunities_is_won ................................ [[31mERROR[0m in 2.67s]
17:04:28.967254 [debug] [Thread-9  ]: Finished running node test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54
17:04:29.150044 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.68 seconds
17:04:29.151038 [debug] [Thread-5  ]: Database Error in test not_null_stg_leads_lead_id (models\staging\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'LEAD_ID'
  compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_leads_lead_id.sql
17:04:29.165111 [debug] [Thread-1  ]: Database Error in test unique_stg_leads_lead_id (models\staging\schema.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'LEAD_ID'
  compiled SQL at target\run\prj_dbt\models\staging\schema.yml\unique_stg_leads_lead_id.sql
17:04:29.182472 [debug] [Thread-7  ]: finished collecting timing info
17:04:29.187589 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.73 seconds
17:04:29.194600 [error] [Thread-5  ]: 5 of 12 ERROR not_null_stg_leads_lead_id ....................................... [[31mERROR[0m in 2.90s]
17:04:29.195731 [error] [Thread-1  ]: 11 of 12 ERROR unique_stg_leads_lead_id ........................................ [[31mERROR[0m in 1.49s]
17:04:29.198724 [debug] [Thread-7  ]: On test.prj_dbt.not_null_stg_leads_state.9404fcc7f8: Close
17:04:29.200719 [debug] [Thread-2  ]: finished collecting timing info
17:04:29.210693 [debug] [Thread-5  ]: Finished running node test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b
17:04:29.225834 [debug] [Thread-1  ]: Finished running node test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf
17:04:29.228813 [debug] [Thread-2  ]: On test.prj_dbt.not_null_stg_leads_industry.756be64d1e: Close
17:04:29.317073 [info ] [Thread-2  ]: 2 of 12 PASS not_null_stg_leads_industry ....................................... [[32mPASS[0m in 3.02s]
17:04:29.318100 [debug] [Thread-2  ]: Finished running node test.prj_dbt.not_null_stg_leads_industry.756be64d1e
17:04:29.325079 [info ] [Thread-7  ]: 7 of 12 PASS not_null_stg_leads_state .......................................... [[32mPASS[0m in 3.03s]
17:04:29.327057 [debug] [Thread-7  ]: Finished running node test.prj_dbt.not_null_stg_leads_state.9404fcc7f8
17:04:29.844260 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.38 seconds
17:04:29.848458 [debug] [Thread-10 ]: finished collecting timing info
17:04:29.848458 [debug] [Thread-10 ]: On test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21: Close
17:04:29.864997 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.41 seconds
17:04:29.867023 [debug] [Thread-4  ]: finished collecting timing info
17:04:29.867023 [debug] [Thread-4  ]: On test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9: Close
17:04:29.939852 [info ] [Thread-10 ]: 10 of 12 PASS not_null_stg_opportunities_lead_id ............................... [[32mPASS[0m in 3.64s]
17:04:29.940818 [debug] [Thread-10 ]: Finished running node test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21
17:04:29.969362 [info ] [Thread-4  ]: 4 of 12 PASS not_null_stg_leads_job_title ...................................... [[32mPASS[0m in 3.67s]
17:04:29.970359 [debug] [Thread-4  ]: Finished running node test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9
17:04:30.020198 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.56 seconds
17:04:30.022193 [debug] [Thread-6  ]: finished collecting timing info
17:04:30.022193 [debug] [Thread-6  ]: On test.prj_dbt.not_null_stg_leads_source.4210778975: Close
17:04:30.138703 [info ] [Thread-6  ]: 6 of 12 PASS not_null_stg_leads_source ......................................... [[32mPASS[0m in 3.84s]
17:04:30.139700 [debug] [Thread-6  ]: Finished running node test.prj_dbt.not_null_stg_leads_source.4210778975
17:04:30.181241 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.29 seconds
17:04:30.183236 [debug] [Thread-8  ]: finished collecting timing info
17:04:30.184234 [debug] [Thread-8  ]: On test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d: Close
17:04:30.271913 [info ] [Thread-8  ]: 12 of 12 PASS unique_stg_opportunities_lead_id ................................. [[32mPASS[0m in 1.40s]
17:04:30.272910 [debug] [Thread-8  ]: Finished running node test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d
17:04:30.275906 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:04:30.277019 [info ] [MainThread]: 
17:04:30.278018 [info ] [MainThread]: Finished running 12 tests in 4.90s.
17:04:30.279016 [debug] [MainThread]: Connection 'master' was properly closed.
17:04:30.279016 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
17:04:30.279016 [debug] [MainThread]: Connection 'test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf' was properly closed.
17:04:30.279016 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_leads_industry.756be64d1e' was properly closed.
17:04:30.280012 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_leads_is_converted.f72b3edb50' was properly closed.
17:04:30.280012 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9' was properly closed.
17:04:30.280012 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b' was properly closed.
17:04:30.280012 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_leads_source.4210778975' was properly closed.
17:04:30.281026 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_leads_state.9404fcc7f8' was properly closed.
17:04:30.281026 [debug] [MainThread]: Connection 'test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d' was properly closed.
17:04:30.281026 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54' was properly closed.
17:04:30.281026 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21' was properly closed.
17:04:30.351434 [info ] [MainThread]: 
17:04:30.352432 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
17:04:30.354425 [info ] [MainThread]: 
17:04:30.355438 [error] [MainThread]: [33mDatabase Error in test not_null_stg_opportunities_is_closed (models\staging\schema.yml)[0m
17:04:30.356526 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 12 at position 7
17:04:30.357523 [error] [MainThread]:   invalid identifier 'IS_CLOSED'
17:04:30.359518 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_opportunities_is_closed.sql
17:04:30.360517 [info ] [MainThread]: 
17:04:30.361514 [error] [MainThread]: [33mDatabase Error in test not_null_stg_leads_is_converted (models\staging\schema.yml)[0m
17:04:30.362526 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 12 at position 7
17:04:30.363507 [error] [MainThread]:   invalid identifier 'IS_CONVERTED'
17:04:30.364504 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_leads_is_converted.sql
17:04:30.365502 [info ] [MainThread]: 
17:04:30.366499 [error] [MainThread]: [33mDatabase Error in test not_null_stg_opportunities_is_won (models\staging\schema.yml)[0m
17:04:30.367496 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 12 at position 7
17:04:30.368494 [error] [MainThread]:   invalid identifier 'IS_WON'
17:04:30.369491 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_opportunities_is_won.sql
17:04:30.371486 [info ] [MainThread]: 
17:04:30.372483 [error] [MainThread]: [33mDatabase Error in test not_null_stg_leads_lead_id (models\staging\schema.yml)[0m
17:04:30.373480 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 12 at position 7
17:04:30.374477 [error] [MainThread]:   invalid identifier 'LEAD_ID'
17:04:30.376473 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_leads_lead_id.sql
17:04:30.377470 [info ] [MainThread]: 
17:04:30.378468 [error] [MainThread]: [33mDatabase Error in test unique_stg_leads_lead_id (models\staging\schema.yml)[0m
17:04:30.380461 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 11 at position 4
17:04:30.381459 [error] [MainThread]:   invalid identifier 'LEAD_ID'
17:04:30.382456 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\schema.yml\unique_stg_leads_lead_id.sql
17:04:30.383453 [info ] [MainThread]: 
17:04:30.384451 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=5 SKIP=0 TOTAL=12
17:04:30.385448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026170F7A970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026170B62B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026170B62730>]}


============================== 2022-05-06 17:05:38.529618 | ee2d3499-a8a6-484b-ac98-773608c90e4b ==============================
17:05:38.529618 [info ] [MainThread]: Running with dbt=1.1.0
17:05:38.530630 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:05:38.530630 [debug] [MainThread]: Tracking: tracking
17:05:38.531613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1AE48BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1AE48C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1AE48C70>]}
17:05:38.614745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:05:38.615827 [debug] [MainThread]: Partial parsing: update schema file: prj_dbt://models\staging\schema.yml
17:05:38.626949 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_leads.sql
17:05:38.652136 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_conversion_dates' in the 'models' section of file 'models\staging\schema.yml'
17:05:38.698014 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.unique_stg_conversion_dates_lead_id.b1ec00ccec' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
17:05:38.699011 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_lead_id.85352c1233' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
17:05:38.699978 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_month.b79d2fee61' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
17:05:38.701006 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_week.0ccef7f02c' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
17:05:38.702004 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_day.37451531ea' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
17:05:38.703001 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_month_name.abaac3491c' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
17:05:38.703981 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.prj_dbt.not_null_stg_conversion_dates_day_name.c23f98e5d7' (models\staging\schema.yml) depends on a node named 'stg_conversion_dates' which was not found
17:05:38.712946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

17:05:38.722945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee2d3499-a8a6-484b-ac98-773608c90e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1BF47460>]}
17:05:38.736880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee2d3499-a8a6-484b-ac98-773608c90e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1BEE6C70>]}
17:05:38.737876 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
17:05:38.738874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee2d3499-a8a6-484b-ac98-773608c90e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1BEE6AF0>]}
17:05:38.741869 [info ] [MainThread]: 
17:05:38.742888 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:05:38.744891 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:05:38.765802 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:05:38.766802 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
17:05:38.766802 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:05:39.527074 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.76 seconds
17:05:39.529069 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
17:05:39.663248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee2d3499-a8a6-484b-ac98-773608c90e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1BEE0A00>]}
17:05:39.665295 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:05:39.667642 [info ] [MainThread]: 
17:05:39.677640 [debug] [Thread-1  ]: Began running node test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3
17:05:39.678607 [debug] [Thread-2  ]: Began running node test.prj_dbt.not_null_stg_leads_industry.756be64d1e
17:05:39.678607 [debug] [Thread-3  ]: Began running node test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9
17:05:39.678607 [info ] [Thread-1  ]: 1 of 11 START test not_null_stg_leads_fleet_size ............................... [RUN]
17:05:39.678607 [debug] [Thread-4  ]: Began running node test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b
17:05:39.679604 [debug] [Thread-5  ]: Began running node test.prj_dbt.not_null_stg_leads_source.4210778975
17:05:39.679604 [debug] [Thread-6  ]: Began running node test.prj_dbt.not_null_stg_leads_state.9404fcc7f8
17:05:39.679604 [info ] [Thread-2  ]: 2 of 11 START test not_null_stg_leads_industry ................................. [RUN]
17:05:39.679604 [debug] [Thread-7  ]: Began running node test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7
17:05:39.680631 [debug] [Thread-8  ]: Began running node test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54
17:05:39.680631 [debug] [Thread-9  ]: Began running node test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21
17:05:39.680631 [info ] [Thread-3  ]: 3 of 11 START test not_null_stg_leads_job_title ................................ [RUN]
17:05:39.680631 [debug] [Thread-10 ]: Began running node test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf
17:05:39.682597 [info ] [Thread-4  ]: 4 of 11 START test not_null_stg_leads_lead_id .................................. [RUN]
17:05:39.682597 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3"
17:05:39.683593 [info ] [Thread-5  ]: 5 of 11 START test not_null_stg_leads_source ................................... [RUN]
17:05:39.683593 [info ] [Thread-6  ]: 6 of 11 START test not_null_stg_leads_state .................................... [RUN]
17:05:39.684636 [info ] [Thread-7  ]: 7 of 11 START test not_null_stg_opportunities_is_closed ........................ [RUN]
17:05:39.685617 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_industry.756be64d1e"
17:05:39.685617 [info ] [Thread-8  ]: 8 of 11 START test not_null_stg_opportunities_is_won ........................... [RUN]
17:05:39.686620 [info ] [Thread-9  ]: 9 of 11 START test not_null_stg_opportunities_lead_id .......................... [RUN]
17:05:39.686620 [info ] [Thread-10 ]: 10 of 11 START test unique_stg_leads_lead_id ................................... [RUN]
17:05:39.687594 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9"
17:05:39.688580 [debug] [Thread-1  ]: Began compiling node test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3
17:05:39.688580 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b"
17:05:39.690597 [debug] [Thread-5  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_source.4210778975"
17:05:39.691592 [debug] [Thread-6  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_leads_state.9404fcc7f8"
17:05:39.691592 [debug] [Thread-2  ]: Began compiling node test.prj_dbt.not_null_stg_leads_industry.756be64d1e
17:05:39.692584 [debug] [Thread-7  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7"
17:05:39.693565 [debug] [Thread-8  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54"
17:05:39.694563 [debug] [Thread-9  ]: Acquiring new snowflake connection "test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21"
17:05:39.694563 [debug] [Thread-3  ]: Began compiling node test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9
17:05:39.695560 [debug] [Thread-10 ]: Acquiring new snowflake connection "test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf"
17:05:39.695560 [debug] [Thread-1  ]: Compiling test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3
17:05:39.695560 [debug] [Thread-4  ]: Began compiling node test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b
17:05:39.695560 [debug] [Thread-5  ]: Began compiling node test.prj_dbt.not_null_stg_leads_source.4210778975
17:05:39.696560 [debug] [Thread-6  ]: Began compiling node test.prj_dbt.not_null_stg_leads_state.9404fcc7f8
17:05:39.696560 [debug] [Thread-2  ]: Compiling test.prj_dbt.not_null_stg_leads_industry.756be64d1e
17:05:39.697586 [debug] [Thread-7  ]: Began compiling node test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7
17:05:39.697586 [debug] [Thread-8  ]: Began compiling node test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54
17:05:39.697586 [debug] [Thread-9  ]: Began compiling node test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21
17:05:39.698552 [debug] [Thread-3  ]: Compiling test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9
17:05:39.698552 [debug] [Thread-10 ]: Began compiling node test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf
17:05:39.712514 [debug] [Thread-1  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3"
17:05:39.713512 [debug] [Thread-4  ]: Compiling test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b
17:05:39.713512 [debug] [Thread-5  ]: Compiling test.prj_dbt.not_null_stg_leads_source.4210778975
17:05:39.714510 [debug] [Thread-6  ]: Compiling test.prj_dbt.not_null_stg_leads_state.9404fcc7f8
17:05:39.718499 [debug] [Thread-2  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_industry.756be64d1e"
17:05:39.719543 [debug] [Thread-7  ]: Compiling test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7
17:05:39.719543 [debug] [Thread-8  ]: Compiling test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54
17:05:39.720494 [debug] [Thread-9  ]: Compiling test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21
17:05:39.723517 [debug] [Thread-3  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9"
17:05:39.724483 [debug] [Thread-10 ]: Compiling test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf
17:05:39.728503 [debug] [Thread-4  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b"
17:05:39.733461 [debug] [Thread-5  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_source.4210778975"
17:05:39.737480 [debug] [Thread-6  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_leads_state.9404fcc7f8"
17:05:39.737480 [debug] [Thread-1  ]: finished collecting timing info
17:05:39.741468 [debug] [Thread-7  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7"
17:05:39.745462 [debug] [Thread-8  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54"
17:05:39.749417 [debug] [Thread-9  ]: Writing injected SQL for node "test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21"
17:05:39.749417 [debug] [Thread-2  ]: finished collecting timing info
17:05:39.758426 [debug] [Thread-10 ]: Writing injected SQL for node "test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf"
17:05:39.759406 [debug] [Thread-3  ]: finished collecting timing info
17:05:39.760386 [debug] [Thread-1  ]: Began executing node test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3
17:05:39.761384 [debug] [Thread-4  ]: finished collecting timing info
17:05:39.762381 [debug] [Thread-5  ]: finished collecting timing info
17:05:39.762381 [debug] [Thread-6  ]: finished collecting timing info
17:05:39.763378 [debug] [Thread-2  ]: Began executing node test.prj_dbt.not_null_stg_leads_industry.756be64d1e
17:05:39.764376 [debug] [Thread-7  ]: finished collecting timing info
17:05:39.764376 [debug] [Thread-3  ]: Began executing node test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9
17:05:39.765374 [debug] [Thread-8  ]: finished collecting timing info
17:05:39.765374 [debug] [Thread-9  ]: finished collecting timing info
17:05:39.786318 [debug] [Thread-1  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3"
17:05:39.786318 [debug] [Thread-10 ]: finished collecting timing info
17:05:39.786318 [debug] [Thread-4  ]: Began executing node test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b
17:05:39.787330 [debug] [Thread-5  ]: Began executing node test.prj_dbt.not_null_stg_leads_source.4210778975
17:05:39.787330 [debug] [Thread-6  ]: Began executing node test.prj_dbt.not_null_stg_leads_state.9404fcc7f8
17:05:39.792312 [debug] [Thread-2  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_industry.756be64d1e"
17:05:39.792312 [debug] [Thread-7  ]: Began executing node test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7
17:05:39.795322 [debug] [Thread-3  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9"
17:05:39.795322 [debug] [Thread-8  ]: Began executing node test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54
17:05:39.796348 [debug] [Thread-9  ]: Began executing node test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21
17:05:39.797289 [debug] [Thread-10 ]: Began executing node test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf
17:05:39.799282 [debug] [Thread-4  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b"
17:05:39.802277 [debug] [Thread-5  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_source.4210778975"
17:05:39.804284 [debug] [Thread-6  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_leads_state.9404fcc7f8"
17:05:39.805267 [debug] [Thread-1  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3"
17:05:39.809519 [debug] [Thread-7  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7"
17:05:39.812510 [debug] [Thread-8  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54"
17:05:39.813552 [debug] [Thread-2  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_industry.756be64d1e"
17:05:39.815726 [debug] [Thread-9  ]: Writing runtime SQL for node "test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21"
17:05:39.817751 [debug] [Thread-10 ]: Writing runtime SQL for node "test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf"
17:05:39.818730 [debug] [Thread-3  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9"
17:05:39.819720 [debug] [Thread-1  ]: On test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fleet_size
from FLEETIO_DBT.CUSTOMERS.stg_leads
where fleet_size is null



      
    ) dbt_internal_test
17:05:39.822719 [debug] [Thread-4  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b"
17:05:39.822719 [debug] [Thread-2  ]: On test.prj_dbt.not_null_stg_leads_industry.756be64d1e: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_industry.756be64d1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select industry
from FLEETIO_DBT.CUSTOMERS.stg_leads
where industry is null



      
    ) dbt_internal_test
17:05:39.824703 [debug] [Thread-5  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_source.4210778975"
17:05:39.825888 [debug] [Thread-6  ]: Using snowflake connection "test.prj_dbt.not_null_stg_leads_state.9404fcc7f8"
17:05:39.826886 [debug] [Thread-7  ]: Using snowflake connection "test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7"
17:05:39.828880 [debug] [Thread-8  ]: Using snowflake connection "test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54"
17:05:39.828880 [debug] [Thread-3  ]: On test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select job_title
from FLEETIO_DBT.CUSTOMERS.stg_leads
where job_title is null



      
    ) dbt_internal_test
17:05:39.829880 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:05:39.830875 [debug] [Thread-9  ]: Using snowflake connection "test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21"
17:05:39.831871 [debug] [Thread-4  ]: On test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lead_id
from FLEETIO_DBT.CUSTOMERS.stg_leads
where lead_id is null



      
    ) dbt_internal_test
17:05:39.831871 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:05:39.832870 [debug] [Thread-10 ]: Using snowflake connection "test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf"
17:05:39.832870 [debug] [Thread-5  ]: On test.prj_dbt.not_null_stg_leads_source.4210778975: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_source.4210778975"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select source
from FLEETIO_DBT.CUSTOMERS.stg_leads
where source is null



      
    ) dbt_internal_test
17:05:39.833869 [debug] [Thread-6  ]: On test.prj_dbt.not_null_stg_leads_state.9404fcc7f8: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_leads_state.9404fcc7f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select state
from FLEETIO_DBT.CUSTOMERS.stg_leads
where state is null



      
    ) dbt_internal_test
17:05:39.833869 [debug] [Thread-7  ]: On test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_closed
from FLEETIO_DBT.CUSTOMERS.stg_opportunities
where is_closed is null



      
    ) dbt_internal_test
17:05:39.834895 [debug] [Thread-8  ]: On test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_won
from FLEETIO_DBT.CUSTOMERS.stg_opportunities
where is_won is null



      
    ) dbt_internal_test
17:05:39.834895 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:05:39.837124 [debug] [Thread-9  ]: On test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lead_id
from FLEETIO_DBT.CUSTOMERS.stg_opportunities
where lead_id is null



      
    ) dbt_internal_test
17:05:39.838118 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:05:39.842078 [debug] [Thread-10 ]: On test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    lead_id as unique_field,
    count(*) as n_records

from FLEETIO_DBT.CUSTOMERS.stg_leads
where lead_id is not null
group by lead_id
having count(*) > 1



      
    ) dbt_internal_test
17:05:39.842078 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:05:39.844082 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:05:39.844082 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:05:39.845070 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:05:39.848257 [debug] [Thread-9  ]: Opening a new connection, currently in state init
17:05:39.851251 [debug] [Thread-10 ]: Opening a new connection, currently in state init
17:05:41.262821 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.43 seconds
17:05:41.264814 [debug] [Thread-2  ]: finished collecting timing info
17:05:41.264814 [debug] [Thread-2  ]: On test.prj_dbt.not_null_stg_leads_industry.756be64d1e: Close
17:05:41.282206 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.44 seconds
17:05:41.284014 [debug] [Thread-5  ]: finished collecting timing info
17:05:41.285012 [debug] [Thread-5  ]: On test.prj_dbt.not_null_stg_leads_source.4210778975: Close
17:05:41.289001 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.44 seconds
17:05:41.289998 [debug] [Thread-6  ]: finished collecting timing info
17:05:41.290995 [debug] [Thread-6  ]: On test.prj_dbt.not_null_stg_leads_state.9404fcc7f8: Close
17:05:41.339463 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a416b7-0c03-02c8-0002-4a1e000130aa
17:05:41.340493 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'LEAD_ID'
17:05:41.340493 [debug] [Thread-4  ]: finished collecting timing info
17:05:41.340493 [debug] [Thread-4  ]: On test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b: Close
17:05:41.356448 [debug] [Thread-10 ]: Snowflake adapter: Snowflake query id: 01a416b7-0c03-02c6-0002-4a1e00011082
17:05:41.356448 [debug] [Thread-10 ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'LEAD_ID'
17:05:41.357445 [debug] [Thread-10 ]: finished collecting timing info
17:05:41.357445 [debug] [Thread-10 ]: On test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf: Close
17:05:41.361434 [info ] [Thread-2  ]: 2 of 11 PASS not_null_stg_leads_industry ....................................... [[32mPASS[0m in 1.68s]
17:05:41.362400 [debug] [Thread-2  ]: Finished running node test.prj_dbt.not_null_stg_leads_industry.756be64d1e
17:05:41.363398 [debug] [Thread-2  ]: Began running node test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d
17:05:41.363398 [info ] [Thread-2  ]: 11 of 11 START test unique_stg_opportunities_lead_id ........................... [RUN]
17:05:41.364396 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d"
17:05:41.364396 [debug] [Thread-2  ]: Began compiling node test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d
17:05:41.365394 [debug] [Thread-2  ]: Compiling test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d
17:05:41.369409 [debug] [Thread-2  ]: Writing injected SQL for node "test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d"
17:05:41.372377 [debug] [Thread-2  ]: finished collecting timing info
17:05:41.373372 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.54 seconds
17:05:41.373372 [debug] [Thread-2  ]: Began executing node test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d
17:05:41.376365 [debug] [Thread-1  ]: finished collecting timing info
17:05:41.380353 [debug] [Thread-2  ]: Writing runtime SQL for node "test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d"
17:05:41.380353 [debug] [Thread-1  ]: On test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3: Close
17:05:41.385341 [debug] [Thread-2  ]: Using snowflake connection "test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d"
17:05:41.386337 [debug] [Thread-2  ]: On test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    lead_id as unique_field,
    count(*) as n_records

from FLEETIO_DBT.CUSTOMERS.stg_opportunities
where lead_id is not null
group by lead_id
having count(*) > 1



      
    ) dbt_internal_test
17:05:41.390326 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:05:41.412267 [info ] [Thread-5  ]: 5 of 11 PASS not_null_stg_leads_source ......................................... [[32mPASS[0m in 1.72s]
17:05:41.413265 [debug] [Thread-5  ]: Finished running node test.prj_dbt.not_null_stg_leads_source.4210778975
17:05:41.434208 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.6 seconds
17:05:41.436203 [debug] [Thread-3  ]: finished collecting timing info
17:05:41.437201 [debug] [Thread-3  ]: On test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9: Close
17:05:41.462134 [info ] [Thread-6  ]: 6 of 11 PASS not_null_stg_leads_state .......................................... [[32mPASS[0m in 1.77s]
17:05:41.463175 [debug] [Thread-6  ]: Finished running node test.prj_dbt.not_null_stg_leads_state.9404fcc7f8
17:05:41.472108 [debug] [Thread-10 ]: Database Error in test unique_stg_leads_lead_id (models\staging\schema.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'LEAD_ID'
  compiled SQL at target\run\prj_dbt\models\staging\schema.yml\unique_stg_leads_lead_id.sql
17:05:41.472108 [error] [Thread-10 ]: 10 of 11 ERROR unique_stg_leads_lead_id ........................................ [[31mERROR[0m in 1.78s]
17:05:41.474103 [debug] [Thread-10 ]: Finished running node test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf
17:05:41.485074 [debug] [Thread-4  ]: Database Error in test not_null_stg_leads_lead_id (models\staging\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'LEAD_ID'
  compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_leads_lead_id.sql
17:05:41.486072 [error] [Thread-4  ]: 4 of 11 ERROR not_null_stg_leads_lead_id ....................................... [[31mERROR[0m in 1.80s]
17:05:41.488068 [debug] [Thread-4  ]: Finished running node test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b
17:05:41.495045 [debug] [Thread-7  ]: Snowflake adapter: Snowflake query id: 01a416b7-0c03-020d-0002-4a1e0001208e
17:05:41.496043 [debug] [Thread-7  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'IS_CLOSED'
17:05:41.496043 [debug] [Thread-7  ]: finished collecting timing info
17:05:41.497043 [debug] [Thread-7  ]: On test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7: Close
17:05:41.577969 [info ] [Thread-1  ]: 1 of 11 PASS not_null_stg_leads_fleet_size ..................................... [[32mPASS[0m in 1.90s]
17:05:41.625060 [debug] [Thread-1  ]: Finished running node test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3
17:05:41.626034 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 1.78 seconds
17:05:41.637028 [info ] [Thread-3  ]: 3 of 11 PASS not_null_stg_leads_job_title ...................................... [[32mPASS[0m in 1.95s]
17:05:41.647969 [debug] [Thread-9  ]: finished collecting timing info
17:05:41.650961 [debug] [Thread-3  ]: Finished running node test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9
17:05:41.650961 [debug] [Thread-9  ]: On test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21: Close
17:05:41.671313 [debug] [Thread-8  ]: Snowflake adapter: Snowflake query id: 01a416b7-0c03-02c8-0002-4a1e000130b2
17:05:41.675308 [debug] [Thread-8  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'IS_WON'
17:05:41.676308 [debug] [Thread-8  ]: finished collecting timing info
17:05:41.677295 [debug] [Thread-8  ]: On test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54: Close
17:05:41.865863 [info ] [Thread-9  ]: 9 of 11 PASS not_null_stg_opportunities_lead_id ................................ [[32mPASS[0m in 2.17s]
17:05:41.866862 [debug] [Thread-9  ]: Finished running node test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21
17:05:41.873842 [debug] [Thread-8  ]: Database Error in test not_null_stg_opportunities_is_won (models\staging\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'IS_WON'
  compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_opportunities_is_won.sql
17:05:41.873842 [error] [Thread-8  ]: 8 of 11 ERROR not_null_stg_opportunities_is_won ................................ [[31mERROR[0m in 2.18s]
17:05:41.874839 [debug] [Thread-8  ]: Finished running node test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54
17:05:41.951676 [debug] [Thread-7  ]: Database Error in test not_null_stg_opportunities_is_closed (models\staging\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'IS_CLOSED'
  compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_opportunities_is_closed.sql
17:05:41.952672 [error] [Thread-7  ]: 7 of 11 ERROR not_null_stg_opportunities_is_closed ............................. [[31mERROR[0m in 2.26s]
17:05:41.953669 [debug] [Thread-7  ]: Finished running node test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7
17:05:42.155208 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.76 seconds
17:05:42.157469 [debug] [Thread-2  ]: finished collecting timing info
17:05:42.157469 [debug] [Thread-2  ]: On test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d: Close
17:05:42.253266 [info ] [Thread-2  ]: 11 of 11 PASS unique_stg_opportunities_lead_id ................................. [[32mPASS[0m in 0.89s]
17:05:42.255278 [debug] [Thread-2  ]: Finished running node test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d
17:05:42.258250 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:05:42.258250 [info ] [MainThread]: 
17:05:42.259284 [info ] [MainThread]: Finished running 11 tests in 3.52s.
17:05:42.260277 [debug] [MainThread]: Connection 'master' was properly closed.
17:05:42.260277 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
17:05:42.260277 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_leads_fleet_size.71b5adc2a3' was properly closed.
17:05:42.261274 [debug] [MainThread]: Connection 'test.prj_dbt.unique_stg_opportunities_lead_id.4b83d5313d' was properly closed.
17:05:42.261274 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_leads_job_title.11a2342ea9' was properly closed.
17:05:42.261274 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_leads_lead_id.2c6a8b754b' was properly closed.
17:05:42.262268 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_leads_source.4210778975' was properly closed.
17:05:42.262268 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_leads_state.9404fcc7f8' was properly closed.
17:05:42.262268 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_opportunities_is_closed.0654e097d7' was properly closed.
17:05:42.262268 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_opportunities_is_won.a5d965eb54' was properly closed.
17:05:42.263237 [debug] [MainThread]: Connection 'test.prj_dbt.not_null_stg_opportunities_lead_id.7ae6d92d21' was properly closed.
17:05:42.263237 [debug] [MainThread]: Connection 'test.prj_dbt.unique_stg_leads_lead_id.4eba5ab6bf' was properly closed.
17:05:42.273210 [info ] [MainThread]: 
17:05:42.274208 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
17:05:42.276206 [info ] [MainThread]: 
17:05:42.277200 [error] [MainThread]: [33mDatabase Error in test unique_stg_leads_lead_id (models\staging\schema.yml)[0m
17:05:42.278200 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 11 at position 4
17:05:42.279196 [error] [MainThread]:   invalid identifier 'LEAD_ID'
17:05:42.280194 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\schema.yml\unique_stg_leads_lead_id.sql
17:05:42.280194 [info ] [MainThread]: 
17:05:42.281191 [error] [MainThread]: [33mDatabase Error in test not_null_stg_leads_lead_id (models\staging\schema.yml)[0m
17:05:42.282188 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 12 at position 7
17:05:42.283186 [error] [MainThread]:   invalid identifier 'LEAD_ID'
17:05:42.283186 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_leads_lead_id.sql
17:05:42.284183 [info ] [MainThread]: 
17:05:42.285181 [error] [MainThread]: [33mDatabase Error in test not_null_stg_opportunities_is_won (models\staging\schema.yml)[0m
17:05:42.286179 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 12 at position 7
17:05:42.287175 [error] [MainThread]:   invalid identifier 'IS_WON'
17:05:42.288174 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_opportunities_is_won.sql
17:05:42.289169 [info ] [MainThread]: 
17:05:42.289169 [error] [MainThread]: [33mDatabase Error in test not_null_stg_opportunities_is_closed (models\staging\schema.yml)[0m
17:05:42.290176 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 12 at position 7
17:05:42.291165 [error] [MainThread]:   invalid identifier 'IS_CLOSED'
17:05:42.292161 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\staging\schema.yml\not_null_stg_opportunities_is_closed.sql
17:05:42.292161 [info ] [MainThread]: 
17:05:42.293158 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=4 SKIP=0 TOTAL=11
17:05:42.294156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE19637940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1C149520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1C149550>]}


============================== 2022-05-06 17:06:56.330794 | 695298db-8185-49e1-9e57-0499d066684a ==============================
17:06:56.330794 [info ] [MainThread]: Running with dbt=1.1.0
17:06:56.331809 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:06:56.332800 [debug] [MainThread]: Tracking: tracking
17:06:56.333787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024534E89BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024534E89C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024534E89C70>]}
17:06:56.417061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:06:56.417061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:06:56.418059 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

17:06:56.428003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '695298db-8185-49e1-9e57-0499d066684a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024534FA8700>]}
17:06:56.439977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '695298db-8185-49e1-9e57-0499d066684a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024534F948E0>]}
17:06:56.440970 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
17:06:56.442967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '695298db-8185-49e1-9e57-0499d066684a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024534F946D0>]}
17:06:56.445956 [info ] [MainThread]: 
17:06:56.447951 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:06:56.450944 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
17:06:56.469892 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
17:06:56.470917 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
17:06:56.470917 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:06:57.302140 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.83 seconds
17:06:57.304127 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
17:06:57.403525 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:06:57.413502 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:06:57.414499 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
17:06:57.414499 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:06:57.961574 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.55 seconds
17:06:57.963610 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
17:06:58.068861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '695298db-8185-49e1-9e57-0499d066684a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024535169D90>]}
17:06:58.069891 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:06:58.070887 [info ] [MainThread]: 
17:06:58.088807 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
17:06:58.089804 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
17:06:58.089804 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
17:06:58.089804 [info ] [Thread-1  ]: 1 of 5 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
17:06:58.090833 [info ] [Thread-2  ]: 2 of 5 START view model CUSTOMERS.stg_leads .................................... [RUN]
17:06:58.090833 [info ] [Thread-3  ]: 3 of 5 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
17:06:58.092797 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
17:06:58.094791 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
17:06:58.094791 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
17:06:58.095788 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
17:06:58.095788 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
17:06:58.095788 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
17:06:58.096785 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
17:06:58.096785 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
17:06:58.099777 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
17:06:58.099777 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
17:06:58.102783 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
17:06:58.106758 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
17:06:58.107756 [debug] [Thread-1  ]: finished collecting timing info
17:06:58.108756 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
17:06:58.122747 [debug] [Thread-2  ]: finished collecting timing info
17:06:58.145653 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
17:06:58.145653 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
17:06:58.149643 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
17:06:58.150640 [debug] [Thread-3  ]: finished collecting timing info
17:06:58.150640 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
17:06:58.152636 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
17:06:58.157622 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
17:06:58.157622 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as lead_id,
    converted_at,
    date_part('month', converted_at) as "month",
    date_part('week', converted_at) as "week",
    date_part('day', converted_at) as "day",
    to_char(converted_at, 'Mon') as "month_name",
    to_char(converted_at, 'Dy') as "day_name"
from leads
where converted_at is not null
  );
17:06:58.158622 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
17:06:58.159617 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:06:58.159617 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id as lead_id,
    case
        when converted_at is null then 0
        else 1
    end as "is_converted",
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
17:06:58.163620 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
17:06:58.165601 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:06:58.166598 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as "is_closed",
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as "is_won"
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
17:06:58.171589 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:06:59.072596 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.91 seconds
17:06:59.080602 [debug] [Thread-2  ]: finished collecting timing info
17:06:59.080602 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
17:06:59.093361 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.93 seconds
17:06:59.095390 [debug] [Thread-1  ]: finished collecting timing info
17:06:59.095390 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
17:06:59.200146 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '695298db-8185-49e1-9e57-0499d066684a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245352D7B80>]}
17:06:59.201144 [info ] [Thread-2  ]: 2 of 5 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.11s]
17:06:59.203110 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
17:06:59.221113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '695298db-8185-49e1-9e57-0499d066684a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245352D7670>]}
17:06:59.222108 [info ] [Thread-1  ]: 1 of 5 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.13s]
17:06:59.225067 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
17:06:59.227055 [debug] [Thread-5  ]: Began running node model.prj_dbt.count_converted_time_source
17:06:59.228053 [info ] [Thread-5  ]: 4 of 5 START view model CUSTOMERS.count_converted_time_source .................. [RUN]
17:06:59.230045 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time_source"
17:06:59.231129 [debug] [Thread-5  ]: Began compiling node model.prj_dbt.count_converted_time_source
17:06:59.231129 [debug] [Thread-5  ]: Compiling model.prj_dbt.count_converted_time_source
17:06:59.235030 [debug] [Thread-5  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time_source"
17:06:59.237024 [debug] [Thread-5  ]: finished collecting timing info
17:06:59.238022 [debug] [Thread-5  ]: Began executing node model.prj_dbt.count_converted_time_source
17:06:59.246000 [debug] [Thread-5  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time_source"
17:06:59.249990 [debug] [Thread-5  ]: Using snowflake connection "model.prj_dbt.count_converted_time_source"
17:06:59.250987 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time_source"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time_source
  
   as (
    --

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

)

select
    *
    leads.source,
from conversion_date
left join leads
    using (lead_id)
  );
17:06:59.251991 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:06:59.273956 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.1 seconds
17:06:59.275920 [debug] [Thread-3  ]: finished collecting timing info
17:06:59.275920 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
17:06:59.500783 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '695298db-8185-49e1-9e57-0499d066684a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002453533CEE0>]}
17:06:59.523092 [info ] [Thread-3  ]: 3 of 5 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.41s]
17:06:59.525087 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
17:06:59.527083 [debug] [Thread-7  ]: Began running node model.prj_dbt.leads_comprehensive
17:06:59.527083 [info ] [Thread-7  ]: 5 of 5 START view model CUSTOMERS.leads_comprehensive .......................... [RUN]
17:06:59.529078 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.prj_dbt.leads_comprehensive"
17:06:59.530075 [debug] [Thread-7  ]: Began compiling node model.prj_dbt.leads_comprehensive
17:06:59.530075 [debug] [Thread-7  ]: Compiling model.prj_dbt.leads_comprehensive
17:06:59.537189 [debug] [Thread-7  ]: Writing injected SQL for node "model.prj_dbt.leads_comprehensive"
17:06:59.540183 [debug] [Thread-7  ]: finished collecting timing info
17:06:59.541178 [debug] [Thread-7  ]: Began executing node model.prj_dbt.leads_comprehensive
17:06:59.546166 [debug] [Thread-7  ]: Writing runtime SQL for node "model.prj_dbt.leads_comprehensive"
17:06:59.552320 [debug] [Thread-7  ]: Using snowflake connection "model.prj_dbt.leads_comprehensive"
17:06:59.552320 [debug] [Thread-7  ]: On model.prj_dbt.leads_comprehensive: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.leads_comprehensive"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.leads_comprehensive
  
   as (
    -- MODEL TO FACILITATE REGRESSION AND ML ANALYSES

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select
      lead_id,
      month,
      week,
      day,
      month_name,
      day_name
    from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

),

opportunities as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_opportunities

)

select
    *
from leads
inner join conversion_date
    using (lead_id)
inner join stg_opportunities
    using (lead_id)
  );
17:06:59.553317 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:06:59.953926 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a416b9-0c03-020d-0002-4a1e0001209a
17:06:59.953926 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 4 unexpected 'leads'.
17:06:59.954924 [debug] [Thread-5  ]: finished collecting timing info
17:06:59.956177 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: Close
17:07:00.064477 [debug] [Thread-5  ]: Database Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'leads'.
  compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:07:00.064477 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '695298db-8185-49e1-9e57-0499d066684a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002453536E7C0>]}
17:07:00.065474 [error] [Thread-5  ]: 4 of 5 ERROR creating view model CUSTOMERS.count_converted_time_source ......... [[31mERROR[0m in 0.83s]
17:07:00.066673 [debug] [Thread-5  ]: Finished running node model.prj_dbt.count_converted_time_source
17:07:00.131856 [debug] [Thread-7  ]: Snowflake adapter: Snowflake query id: 01a416b9-0c03-02c8-0002-4a1e000130ba
17:07:00.131856 [debug] [Thread-7  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 6
invalid identifier 'MONTH'
17:07:00.132853 [debug] [Thread-7  ]: finished collecting timing info
17:07:00.132853 [debug] [Thread-7  ]: On model.prj_dbt.leads_comprehensive: Close
17:07:00.290251 [debug] [Thread-7  ]: Database Error in model leads_comprehensive (models\mart\regression_ML\leads_comprehensive.sql)
  000904 (42000): SQL compilation error: error line 16 at position 6
  invalid identifier 'MONTH'
  compiled SQL at target\run\prj_dbt\models\mart\regression_ML\leads_comprehensive.sql
17:07:00.291253 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '695298db-8185-49e1-9e57-0499d066684a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245352FF6A0>]}
17:07:00.292249 [error] [Thread-7  ]: 5 of 5 ERROR creating view model CUSTOMERS.leads_comprehensive ................. [[31mERROR[0m in 0.76s]
17:07:00.293532 [debug] [Thread-7  ]: Finished running node model.prj_dbt.leads_comprehensive
17:07:00.296529 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:07:00.297526 [info ] [MainThread]: 
17:07:00.298524 [info ] [MainThread]: Finished running 5 view models in 3.85s.
17:07:00.299520 [debug] [MainThread]: Connection 'master' was properly closed.
17:07:00.299520 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
17:07:00.299520 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
17:07:00.300527 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
17:07:00.300527 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
17:07:00.300527 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
17:07:00.301515 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time_source' was properly closed.
17:07:00.301515 [debug] [MainThread]: Connection 'model.prj_dbt.leads_comprehensive' was properly closed.
17:07:00.310490 [info ] [MainThread]: 
17:07:00.311488 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:07:00.312485 [info ] [MainThread]: 
17:07:00.313483 [error] [MainThread]: [33mDatabase Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)[0m
17:07:00.314480 [error] [MainThread]:   001003 (42000): SQL compilation error:
17:07:00.315478 [error] [MainThread]:   syntax error line 20 at position 4 unexpected 'leads'.
17:07:00.315478 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:07:00.316477 [info ] [MainThread]: 
17:07:00.317473 [error] [MainThread]: [33mDatabase Error in model leads_comprehensive (models\mart\regression_ML\leads_comprehensive.sql)[0m
17:07:00.318504 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 16 at position 6
17:07:00.319498 [error] [MainThread]:   invalid identifier 'MONTH'
17:07:00.320504 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\mart\regression_ML\leads_comprehensive.sql
17:07:00.321461 [info ] [MainThread]: 
17:07:00.321461 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
17:07:00.322491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245351C83D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024535169F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024534F940A0>]}


============================== 2022-05-06 17:08:37.907083 | 359c95f3-03bc-445c-b261-f21de6cf4af8 ==============================
17:08:37.907083 [info ] [MainThread]: Running with dbt=1.1.0
17:08:37.908083 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:08:37.909065 [debug] [MainThread]: Tracking: tracking
17:08:37.909065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD6FDF8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD6FDF8C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD6FDF8CD0>]}
17:08:38.000987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
17:08:38.001984 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_opportunities.sql
17:08:38.002984 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_conversion_date.sql
17:08:38.002984 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_leads.sql
17:08:38.015081 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_opportunities.sql
17:08:38.027321 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_conversion_date.sql
17:08:38.029315 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_leads.sql
17:08:38.080763 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

17:08:38.092730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '359c95f3-03bc-445c-b261-f21de6cf4af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD6FF84F10>]}
17:08:38.104695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '359c95f3-03bc-445c-b261-f21de6cf4af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD6FEFA850>]}
17:08:38.106691 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
17:08:38.107730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '359c95f3-03bc-445c-b261-f21de6cf4af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD6FEFAAC0>]}
17:08:38.109684 [info ] [MainThread]: 
17:08:38.110681 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:08:38.112687 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
17:08:38.133617 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
17:08:38.134617 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
17:08:38.134617 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:08:38.907057 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.77 seconds
17:08:38.909054 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
17:08:39.008865 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:08:39.015848 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:08:39.015848 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
17:08:39.015848 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:08:39.689505 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.67 seconds
17:08:39.691489 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
17:08:39.788041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '359c95f3-03bc-445c-b261-f21de6cf4af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD70120520>]}
17:08:39.790035 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:08:39.791035 [info ] [MainThread]: 
17:08:39.804947 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
17:08:39.804947 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
17:08:39.805975 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
17:08:39.805975 [info ] [Thread-1  ]: 1 of 5 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
17:08:39.806959 [info ] [Thread-2  ]: 2 of 5 START view model CUSTOMERS.stg_leads .................................... [RUN]
17:08:39.806959 [info ] [Thread-3  ]: 3 of 5 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
17:08:39.808935 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
17:08:39.809933 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
17:08:39.810967 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
17:08:39.810967 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
17:08:39.811927 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
17:08:39.811927 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
17:08:39.811927 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
17:08:39.812925 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
17:08:39.813948 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
17:08:39.814918 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
17:08:39.816939 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
17:08:39.818925 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
17:08:39.819906 [debug] [Thread-1  ]: finished collecting timing info
17:08:39.820906 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
17:08:39.840879 [debug] [Thread-2  ]: finished collecting timing info
17:08:39.856808 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
17:08:39.856808 [debug] [Thread-3  ]: finished collecting timing info
17:08:39.864785 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
17:08:39.867779 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
17:08:39.868776 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
17:08:39.874788 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
17:08:39.876754 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
17:08:39.877751 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as lead_id,
    converted_at,
    date_part('month', converted_at) as month,
    date_part('week', converted_at) as week,
    date_part('day', converted_at) as day,
    to_char(converted_at, 'Mon') as month_name,
    to_char(converted_at, 'Dy') as day_name
from leads
where converted_at is not null
  );
17:08:39.878749 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
17:08:39.880743 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
17:08:39.880743 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:08:39.881740 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id as lead_id,
    case
        when converted_at is null then 0
        else 1
    end as is_converted,
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
17:08:39.881740 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as is_closed,
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as is_won
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
17:08:39.884732 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:08:39.885732 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:08:40.861774 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.98 seconds
17:08:40.868739 [debug] [Thread-3  ]: finished collecting timing info
17:08:40.869736 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
17:08:40.881475 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
17:08:40.883470 [debug] [Thread-1  ]: finished collecting timing info
17:08:40.883470 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
17:08:41.006006 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '359c95f3-03bc-445c-b261-f21de6cf4af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD7015F5B0>]}
17:08:41.007002 [info ] [Thread-1  ]: 1 of 5 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.20s]
17:08:41.008022 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
17:08:41.009999 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '359c95f3-03bc-445c-b261-f21de6cf4af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD7015ECA0>]}
17:08:41.010998 [info ] [Thread-3  ]: 3 of 5 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.20s]
17:08:41.011980 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
17:08:41.099080 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.21 seconds
17:08:41.101075 [debug] [Thread-2  ]: finished collecting timing info
17:08:41.102073 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
17:08:41.201972 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '359c95f3-03bc-445c-b261-f21de6cf4af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD70285190>]}
17:08:41.201972 [info ] [Thread-2  ]: 2 of 5 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.39s]
17:08:41.203967 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
17:08:41.203967 [debug] [Thread-5  ]: Began running node model.prj_dbt.count_converted_time_source
17:08:41.204967 [debug] [Thread-6  ]: Began running node model.prj_dbt.leads_comprehensive
17:08:41.204967 [info ] [Thread-5  ]: 4 of 5 START view model CUSTOMERS.count_converted_time_source .................. [RUN]
17:08:41.205961 [info ] [Thread-6  ]: 5 of 5 START view model CUSTOMERS.leads_comprehensive .......................... [RUN]
17:08:41.207956 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time_source"
17:08:41.207956 [debug] [Thread-5  ]: Began compiling node model.prj_dbt.count_converted_time_source
17:08:41.208956 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.prj_dbt.leads_comprehensive"
17:08:41.208956 [debug] [Thread-5  ]: Compiling model.prj_dbt.count_converted_time_source
17:08:41.209954 [debug] [Thread-6  ]: Began compiling node model.prj_dbt.leads_comprehensive
17:08:41.213944 [debug] [Thread-5  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time_source"
17:08:41.214942 [debug] [Thread-6  ]: Compiling model.prj_dbt.leads_comprehensive
17:08:41.223914 [debug] [Thread-6  ]: Writing injected SQL for node "model.prj_dbt.leads_comprehensive"
17:08:41.225908 [debug] [Thread-5  ]: finished collecting timing info
17:08:41.225908 [debug] [Thread-5  ]: Began executing node model.prj_dbt.count_converted_time_source
17:08:41.231893 [debug] [Thread-5  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time_source"
17:08:41.232890 [debug] [Thread-6  ]: finished collecting timing info
17:08:41.233888 [debug] [Thread-6  ]: Began executing node model.prj_dbt.leads_comprehensive
17:08:41.239872 [debug] [Thread-6  ]: Writing runtime SQL for node "model.prj_dbt.leads_comprehensive"
17:08:41.243862 [debug] [Thread-5  ]: Using snowflake connection "model.prj_dbt.count_converted_time_source"
17:08:41.245855 [debug] [Thread-6  ]: Using snowflake connection "model.prj_dbt.leads_comprehensive"
17:08:41.246852 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time_source"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time_source
  
   as (
    --

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

)

select
    *
    leads.source,
from conversion_date
left join leads
    using (lead_id)
  );
17:08:41.246852 [debug] [Thread-6  ]: On model.prj_dbt.leads_comprehensive: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.leads_comprehensive"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.leads_comprehensive
  
   as (
    -- MODEL TO FACILITATE REGRESSION AND ML ANALYSES

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select
      lead_id,
      month,
      week,
      day,
      month_name,
      day_name
    from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

),

opportunities as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_opportunities

)

select
    *
from leads
inner join conversion_date
    using (lead_id)
inner join stg_opportunities
    using (lead_id)
  );
17:08:41.247850 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:08:41.248848 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:08:41.912252 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a416ba-0c03-0218-0002-4a1e0001405a
17:08:41.912252 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 4 unexpected 'leads'.
17:08:41.913282 [debug] [Thread-5  ]: finished collecting timing info
17:08:41.913282 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: Close
17:08:42.017366 [debug] [Thread-5  ]: Database Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'leads'.
  compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:08:42.017366 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '359c95f3-03bc-445c-b261-f21de6cf4af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD7029D700>]}
17:08:42.018363 [error] [Thread-5  ]: 4 of 5 ERROR creating view model CUSTOMERS.count_converted_time_source ......... [[31mERROR[0m in 0.81s]
17:08:42.019362 [debug] [Thread-5  ]: Finished running node model.prj_dbt.count_converted_time_source
17:08:42.322182 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.07 seconds
17:08:42.324176 [debug] [Thread-6  ]: finished collecting timing info
17:08:42.324176 [debug] [Thread-6  ]: On model.prj_dbt.leads_comprehensive: Close
17:08:42.463724 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '359c95f3-03bc-445c-b261-f21de6cf4af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD702F52B0>]}
17:08:42.463724 [info ] [Thread-6  ]: 5 of 5 OK created view model CUSTOMERS.leads_comprehensive ..................... [[32mSUCCESS 1[0m in 1.25s]
17:08:42.464721 [debug] [Thread-6  ]: Finished running node model.prj_dbt.leads_comprehensive
17:08:42.466681 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:08:42.467678 [info ] [MainThread]: 
17:08:42.468676 [info ] [MainThread]: Finished running 5 view models in 4.36s.
17:08:42.469674 [debug] [MainThread]: Connection 'master' was properly closed.
17:08:42.469674 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
17:08:42.469674 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
17:08:42.470670 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
17:08:42.470670 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
17:08:42.470670 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
17:08:42.470670 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time_source' was properly closed.
17:08:42.471667 [debug] [MainThread]: Connection 'model.prj_dbt.leads_comprehensive' was properly closed.
17:08:42.481849 [info ] [MainThread]: 
17:08:42.482847 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:08:42.483851 [info ] [MainThread]: 
17:08:42.484843 [error] [MainThread]: [33mDatabase Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)[0m
17:08:42.486855 [error] [MainThread]:   001003 (42000): SQL compilation error:
17:08:42.487014 [error] [MainThread]:   syntax error line 20 at position 4 unexpected 'leads'.
17:08:42.488021 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:08:42.489009 [info ] [MainThread]: 
17:08:42.490006 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
17:08:42.490006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD70174A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD6FF6EFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD6FEFA9A0>]}


============================== 2022-05-06 17:10:09.653393 | 21dcda58-d26a-4275-80b0-1a908c20429c ==============================
17:10:09.653393 [info ] [MainThread]: Running with dbt=1.1.0
17:10:09.655358 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:10:09.656354 [debug] [MainThread]: Tracking: tracking
17:10:09.656354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020507BBAAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020507BBAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020507BBABB0>]}
17:10:09.738386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:10:09.739381 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\mart\regression_ML\leads_comprehensive.sql
17:10:09.751526 [debug] [MainThread]: 1699: static parser successfully parsed mart\regression_ML\leads_comprehensive.sql
17:10:09.767767 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

17:10:09.778739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21dcda58-d26a-4275-80b0-1a908c20429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020507D16880>]}
17:10:09.790878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21dcda58-d26a-4275-80b0-1a908c20429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020507CC2C10>]}
17:10:09.791858 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
17:10:09.793854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21dcda58-d26a-4275-80b0-1a908c20429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020507CC2F70>]}
17:10:09.795851 [info ] [MainThread]: 
17:10:09.797841 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:10:09.800836 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
17:10:09.819783 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
17:10:09.820780 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
17:10:09.820780 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:10:10.754231 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.93 seconds
17:10:10.756223 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
17:10:11.677452 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:10:11.685465 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:10:11.685465 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
17:10:11.686459 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:10:12.683275 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 1.0 seconds
17:10:12.685259 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
17:10:12.796931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21dcda58-d26a-4275-80b0-1a908c20429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020507EC6BE0>]}
17:10:12.796931 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:10:12.797928 [info ] [MainThread]: 
17:10:12.811890 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
17:10:12.811890 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
17:10:12.811890 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
17:10:12.812889 [info ] [Thread-1  ]: 1 of 5 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
17:10:12.813886 [info ] [Thread-2  ]: 2 of 5 START view model CUSTOMERS.stg_leads .................................... [RUN]
17:10:12.813886 [info ] [Thread-3  ]: 3 of 5 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
17:10:12.815883 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
17:10:12.817878 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
17:10:12.817878 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
17:10:12.818872 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
17:10:12.819870 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
17:10:12.819870 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
17:10:12.820870 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
17:10:12.820870 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
17:10:12.822861 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
17:10:12.823858 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
17:10:12.825853 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
17:10:12.829843 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
17:10:12.830840 [debug] [Thread-1  ]: finished collecting timing info
17:10:12.830840 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
17:10:12.859765 [debug] [Thread-2  ]: finished collecting timing info
17:10:12.867743 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
17:10:12.868741 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
17:10:12.868741 [debug] [Thread-3  ]: finished collecting timing info
17:10:12.872727 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
17:10:12.873725 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
17:10:12.875720 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
17:10:12.880709 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
17:10:12.880709 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as lead_id,
    converted_at,
    date_part('month', converted_at) as month,
    date_part('week', converted_at) as week,
    date_part('day', converted_at) as day,
    to_char(converted_at, 'Mon') as month_name,
    to_char(converted_at, 'Dy') as day_name
from leads
where converted_at is not null
  );
17:10:12.882704 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
17:10:12.882704 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:10:12.883699 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id as lead_id,
    case
        when converted_at is null then 0
        else 1
    end as is_converted,
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
17:10:12.888689 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
17:10:12.888689 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:10:12.890682 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as is_closed,
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as is_won
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
17:10:12.896765 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:10:13.988555 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.11 seconds
17:10:13.995537 [debug] [Thread-1  ]: finished collecting timing info
17:10:13.996562 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
17:10:14.134192 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.24 seconds
17:10:14.136161 [debug] [Thread-3  ]: finished collecting timing info
17:10:14.136161 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
17:10:14.277473 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dcda58-d26a-4275-80b0-1a908c20429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205080B9CA0>]}
17:10:14.278464 [info ] [Thread-1  ]: 1 of 5 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.46s]
17:10:14.279462 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
17:10:14.345732 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dcda58-d26a-4275-80b0-1a908c20429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020508058520>]}
17:10:14.346889 [info ] [Thread-3  ]: 3 of 5 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.53s]
17:10:14.347896 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
17:10:14.444166 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.56 seconds
17:10:14.447400 [debug] [Thread-2  ]: finished collecting timing info
17:10:14.448387 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
17:10:14.821871 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dcda58-d26a-4275-80b0-1a908c20429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002050803AF40>]}
17:10:14.822860 [info ] [Thread-2  ]: 2 of 5 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 2.00s]
17:10:14.823828 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
17:10:14.824826 [debug] [Thread-5  ]: Began running node model.prj_dbt.count_converted_time_source
17:10:14.824826 [info ] [Thread-5  ]: 4 of 5 START view model CUSTOMERS.count_converted_time_source .................. [RUN]
17:10:14.824826 [debug] [Thread-6  ]: Began running node model.prj_dbt.leads_comprehensive
17:10:14.825836 [info ] [Thread-6  ]: 5 of 5 START view model CUSTOMERS.leads_comprehensive .......................... [RUN]
17:10:14.826853 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time_source"
17:10:14.827818 [debug] [Thread-5  ]: Began compiling node model.prj_dbt.count_converted_time_source
17:10:14.827818 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.prj_dbt.leads_comprehensive"
17:10:14.827818 [debug] [Thread-5  ]: Compiling model.prj_dbt.count_converted_time_source
17:10:14.828844 [debug] [Thread-6  ]: Began compiling node model.prj_dbt.leads_comprehensive
17:10:14.829826 [debug] [Thread-6  ]: Compiling model.prj_dbt.leads_comprehensive
17:10:14.833803 [debug] [Thread-5  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time_source"
17:10:14.837082 [debug] [Thread-6  ]: Writing injected SQL for node "model.prj_dbt.leads_comprehensive"
17:10:14.839080 [debug] [Thread-5  ]: finished collecting timing info
17:10:14.840074 [debug] [Thread-6  ]: finished collecting timing info
17:10:14.840074 [debug] [Thread-5  ]: Began executing node model.prj_dbt.count_converted_time_source
17:10:14.840074 [debug] [Thread-6  ]: Began executing node model.prj_dbt.leads_comprehensive
17:10:14.845061 [debug] [Thread-5  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time_source"
17:10:14.849054 [debug] [Thread-6  ]: Writing runtime SQL for node "model.prj_dbt.leads_comprehensive"
17:10:14.854071 [debug] [Thread-6  ]: Using snowflake connection "model.prj_dbt.leads_comprehensive"
17:10:14.856043 [debug] [Thread-5  ]: Using snowflake connection "model.prj_dbt.count_converted_time_source"
17:10:14.856043 [debug] [Thread-6  ]: On model.prj_dbt.leads_comprehensive: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.leads_comprehensive"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.leads_comprehensive
  
   as (
    -- MODEL TO FACILITATE REGRESSION AND ML ANALYSES

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select
      lead_id,
      month,
      week,
      day,
      month_name,
      day_name
    from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

),

opportunities as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_opportunities

)

select
    *
from leads
left join conversion_date
    using (lead_id)
left join stg_opportunities
    using (lead_id)
  );
17:10:14.857032 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time_source"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time_source
  
   as (
    --

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

)

select
    *
    leads.source,
from conversion_date
left join leads
    using (lead_id)
  );
17:10:14.857032 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:10:14.858027 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:10:15.642595 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a416bc-0c03-02c8-0002-4a1e000130ea
17:10:15.642595 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 4 unexpected 'leads'.
17:10:15.643602 [debug] [Thread-5  ]: finished collecting timing info
17:10:15.643602 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: Close
17:10:15.806842 [debug] [Thread-5  ]: Database Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'leads'.
  compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:10:15.807018 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dcda58-d26a-4275-80b0-1a908c20429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205080EBB20>]}
17:10:15.807018 [error] [Thread-5  ]: 4 of 5 ERROR creating view model CUSTOMERS.count_converted_time_source ......... [[31mERROR[0m in 0.98s]
17:10:15.808547 [debug] [Thread-5  ]: Finished running node model.prj_dbt.count_converted_time_source
17:10:16.236560 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.38 seconds
17:10:16.242596 [debug] [Thread-6  ]: finished collecting timing info
17:10:16.243595 [debug] [Thread-6  ]: On model.prj_dbt.leads_comprehensive: Close
17:10:16.388915 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dcda58-d26a-4275-80b0-1a908c20429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205080C2A60>]}
17:10:16.388915 [info ] [Thread-6  ]: 5 of 5 OK created view model CUSTOMERS.leads_comprehensive ..................... [[32mSUCCESS 1[0m in 1.56s]
17:10:16.389942 [debug] [Thread-6  ]: Finished running node model.prj_dbt.leads_comprehensive
17:10:16.393906 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:10:16.394930 [info ] [MainThread]: 
17:10:16.395929 [info ] [MainThread]: Finished running 5 view models in 6.60s.
17:10:16.396925 [debug] [MainThread]: Connection 'master' was properly closed.
17:10:16.396925 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
17:10:16.396925 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
17:10:16.396925 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
17:10:16.397922 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
17:10:16.397922 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
17:10:16.397922 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time_source' was properly closed.
17:10:16.398890 [debug] [MainThread]: Connection 'model.prj_dbt.leads_comprehensive' was properly closed.
17:10:16.408864 [info ] [MainThread]: 
17:10:16.409860 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:10:16.410857 [info ] [MainThread]: 
17:10:16.412866 [error] [MainThread]: [33mDatabase Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)[0m
17:10:16.413848 [error] [MainThread]:   001003 (42000): SQL compilation error:
17:10:16.413848 [error] [MainThread]:   syntax error line 20 at position 4 unexpected 'leads'.
17:10:16.414846 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:10:16.415845 [info ] [MainThread]: 
17:10:16.417838 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
17:10:16.418892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020507EC6CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020507CBAA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020507F318E0>]}


============================== 2022-05-06 17:17:36.542870 | fd8cfb27-ca71-4314-b356-27a1ec667bc4 ==============================
17:17:36.542870 [info ] [MainThread]: Running with dbt=1.1.0
17:17:36.543867 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:17:36.543867 [debug] [MainThread]: Tracking: tracking
17:17:36.544892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD648C9BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD648C9C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD648C9C70>]}
17:17:36.631151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:17:36.632117 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:17:36.633114 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

17:17:36.642093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd8cfb27-ca71-4314-b356-27a1ec667bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD649E9700>]}
17:17:36.654058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd8cfb27-ca71-4314-b356-27a1ec667bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD648F4AC0>]}
17:17:36.655056 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
17:17:36.656054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd8cfb27-ca71-4314-b356-27a1ec667bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD648F4A30>]}
17:17:36.658078 [info ] [MainThread]: 
17:17:36.659047 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:17:36.661042 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
17:17:36.679990 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
17:17:36.681020 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
17:17:36.681020 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:17:37.500501 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.82 seconds
17:17:37.502494 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
17:17:37.705032 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:17:37.712043 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:17:37.712043 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
17:17:37.712043 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:17:38.494994 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.78 seconds
17:17:38.497959 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
17:17:38.652329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd8cfb27-ca71-4314-b356-27a1ec667bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD64BA7D90>]}
17:17:38.652329 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:17:38.653363 [info ] [MainThread]: 
17:17:38.663307 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
17:17:38.663307 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
17:17:38.663307 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
17:17:38.664299 [info ] [Thread-1  ]: 1 of 5 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
17:17:38.665299 [info ] [Thread-2  ]: 2 of 5 START view model CUSTOMERS.stg_leads .................................... [RUN]
17:17:38.665299 [info ] [Thread-3  ]: 3 of 5 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
17:17:38.667310 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
17:17:38.669319 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
17:17:38.669319 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
17:17:38.670286 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
17:17:38.670286 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
17:17:38.671282 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
17:17:38.671282 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
17:17:38.671282 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
17:17:38.673277 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
17:17:38.674277 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
17:17:38.677267 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
17:17:38.679259 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
17:17:38.681257 [debug] [Thread-1  ]: finished collecting timing info
17:17:38.681257 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
17:17:38.692292 [debug] [Thread-2  ]: finished collecting timing info
17:17:38.706203 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
17:17:38.706203 [debug] [Thread-3  ]: finished collecting timing info
17:17:38.718183 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
17:17:38.721155 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
17:17:38.722147 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
17:17:38.726135 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
17:17:38.730153 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
17:17:38.730153 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as lead_id,
    converted_at,
    date_part('month', converted_at) as month,
    date_part('week', converted_at) as week,
    date_part('day', converted_at) as day,
    to_char(converted_at, 'Mon') as month_name,
    to_char(converted_at, 'Dy') as day_name
from leads
where converted_at is not null
  );
17:17:38.731156 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:17:38.733144 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
17:17:38.736110 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
17:17:38.737107 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id as lead_id,
    case
        when converted_at is null then 0
        else 1
    end as is_converted,
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
17:17:38.737107 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as is_closed,
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as is_won
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
17:17:38.739099 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:17:38.739099 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:17:39.699278 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.96 seconds
17:17:39.707252 [debug] [Thread-3  ]: finished collecting timing info
17:17:39.708256 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.98 seconds
17:17:39.709227 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
17:17:39.710243 [debug] [Thread-1  ]: finished collecting timing info
17:17:39.712211 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
17:17:39.839868 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8cfb27-ca71-4314-b356-27a1ec667bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD64C0E6D0>]}
17:17:39.839868 [info ] [Thread-3  ]: 3 of 5 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.17s]
17:17:39.841863 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
17:17:39.879066 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8cfb27-ca71-4314-b356-27a1ec667bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD64D84DF0>]}
17:17:39.879066 [info ] [Thread-1  ]: 1 of 5 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.21s]
17:17:39.880063 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
17:17:39.887013 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.15 seconds
17:17:39.889007 [debug] [Thread-2  ]: finished collecting timing info
17:17:39.890005 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
17:17:40.033359 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8cfb27-ca71-4314-b356-27a1ec667bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD64D17D00>]}
17:17:40.034356 [info ] [Thread-2  ]: 2 of 5 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.37s]
17:17:40.035561 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
17:17:40.036570 [debug] [Thread-5  ]: Began running node model.prj_dbt.count_converted_time_source
17:17:40.036570 [debug] [Thread-6  ]: Began running node model.prj_dbt.leads_comprehensive
17:17:40.037558 [info ] [Thread-5  ]: 4 of 5 START view model CUSTOMERS.count_converted_time_source .................. [RUN]
17:17:40.037558 [info ] [Thread-6  ]: 5 of 5 START view model CUSTOMERS.leads_comprehensive .......................... [RUN]
17:17:40.038581 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time_source"
17:17:40.039578 [debug] [Thread-5  ]: Began compiling node model.prj_dbt.count_converted_time_source
17:17:40.039578 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.prj_dbt.leads_comprehensive"
17:17:40.039578 [debug] [Thread-5  ]: Compiling model.prj_dbt.count_converted_time_source
17:17:40.039578 [debug] [Thread-6  ]: Began compiling node model.prj_dbt.leads_comprehensive
17:17:40.042551 [debug] [Thread-6  ]: Compiling model.prj_dbt.leads_comprehensive
17:17:40.046987 [debug] [Thread-5  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time_source"
17:17:40.049947 [debug] [Thread-6  ]: Writing injected SQL for node "model.prj_dbt.leads_comprehensive"
17:17:40.052939 [debug] [Thread-5  ]: finished collecting timing info
17:17:40.052939 [debug] [Thread-6  ]: finished collecting timing info
17:17:40.053939 [debug] [Thread-5  ]: Began executing node model.prj_dbt.count_converted_time_source
17:17:40.053939 [debug] [Thread-6  ]: Began executing node model.prj_dbt.leads_comprehensive
17:17:40.057076 [debug] [Thread-5  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time_source"
17:17:40.061096 [debug] [Thread-6  ]: Writing runtime SQL for node "model.prj_dbt.leads_comprehensive"
17:17:40.064060 [debug] [Thread-5  ]: Using snowflake connection "model.prj_dbt.count_converted_time_source"
17:17:40.064060 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time_source"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time_source
  
   as (
    --

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

)

select
    *
    leads.source,
from conversion_date
left join leads
    using (lead_id)
  );
17:17:40.066084 [debug] [Thread-6  ]: Using snowflake connection "model.prj_dbt.leads_comprehensive"
17:17:40.066084 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:17:40.067078 [debug] [Thread-6  ]: On model.prj_dbt.leads_comprehensive: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.leads_comprehensive"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.leads_comprehensive
  
   as (
    -- MODEL TO FACILITATE REGRESSION AND ML ANALYSES

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select
      lead_id,
      month,
      week,
      day,
      month_name,
      day_name
    from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

),

opportunities as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_opportunities

)

select
    *
from leads
left join conversion_date
    using (lead_id)
left join stg_opportunities
    using (lead_id)
  );
17:17:40.069075 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:17:41.047407 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a416c3-0c03-01d5-0002-4a1e00015006
17:17:41.047407 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 4 unexpected 'leads'.
17:17:41.048404 [debug] [Thread-5  ]: finished collecting timing info
17:17:41.048404 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: Close
17:17:41.163706 [debug] [Thread-5  ]: Database Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'leads'.
  compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:17:41.163706 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8cfb27-ca71-4314-b356-27a1ec667bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD64DE2B50>]}
17:17:41.164702 [error] [Thread-5  ]: 4 of 5 ERROR creating view model CUSTOMERS.count_converted_time_source ......... [[31mERROR[0m in 1.13s]
17:17:41.165713 [debug] [Thread-5  ]: Finished running node model.prj_dbt.count_converted_time_source
17:17:41.570876 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.5 seconds
17:17:41.574834 [debug] [Thread-6  ]: finished collecting timing info
17:17:41.575830 [debug] [Thread-6  ]: On model.prj_dbt.leads_comprehensive: Close
17:17:41.682427 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8cfb27-ca71-4314-b356-27a1ec667bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD64DDAD00>]}
17:17:41.682427 [info ] [Thread-6  ]: 5 of 5 OK created view model CUSTOMERS.leads_comprehensive ..................... [[32mSUCCESS 1[0m in 1.64s]
17:17:41.683997 [debug] [Thread-6  ]: Finished running node model.prj_dbt.leads_comprehensive
17:17:41.685993 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:17:41.686991 [info ] [MainThread]: 
17:17:41.687988 [info ] [MainThread]: Finished running 5 view models in 5.03s.
17:17:41.687988 [debug] [MainThread]: Connection 'master' was properly closed.
17:17:41.687988 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
17:17:41.689016 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
17:17:41.689016 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
17:17:41.689016 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
17:17:41.689016 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
17:17:41.690013 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time_source' was properly closed.
17:17:41.690013 [debug] [MainThread]: Connection 'model.prj_dbt.leads_comprehensive' was properly closed.
17:17:41.701953 [info ] [MainThread]: 
17:17:41.703946 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:17:41.704944 [info ] [MainThread]: 
17:17:41.705957 [error] [MainThread]: [33mDatabase Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)[0m
17:17:41.707945 [error] [MainThread]:   001003 (42000): SQL compilation error:
17:17:41.707945 [error] [MainThread]:   syntax error line 20 at position 4 unexpected 'leads'.
17:17:41.708935 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:17:41.709930 [info ] [MainThread]: 
17:17:41.711937 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
17:17:41.712953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD64D481C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD64D7F610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD64A25C40>]}


============================== 2022-05-06 17:22:10.809532 | 5f521d03-760e-4ef8-bd9b-fda67244ebc0 ==============================
17:22:10.809532 [info ] [MainThread]: Running with dbt=1.1.0
17:22:10.810540 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:22:10.811525 [debug] [MainThread]: Tracking: tracking
17:22:10.811525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016400378CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016400378D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016400378D90>]}
17:22:10.893287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:22:10.894284 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\mart\regression_ML\leads_comprehensive.sql
17:22:10.906549 [debug] [MainThread]: 1699: static parser successfully parsed mart\regression_ML\leads_comprehensive.sql
17:22:10.923641 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

17:22:10.932615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f521d03-760e-4ef8-bd9b-fda67244ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164014A6A30>]}
17:22:10.944750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f521d03-760e-4ef8-bd9b-fda67244ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016401414A00>]}
17:22:10.945745 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
17:22:10.946975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f521d03-760e-4ef8-bd9b-fda67244ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016401452E50>]}
17:22:10.948978 [info ] [MainThread]: 
17:22:10.950965 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:22:10.952959 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
17:22:10.974902 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
17:22:10.974902 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
17:22:10.974902 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:22:11.768988 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.79 seconds
17:22:11.770982 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
17:22:12.213593 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:22:12.220577 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:22:12.220577 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
17:22:12.220577 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:22:13.132569 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.91 seconds
17:22:13.136558 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
17:22:14.256694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f521d03-760e-4ef8-bd9b-fda67244ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016401616730>]}
17:22:14.256812 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:22:14.257843 [info ] [MainThread]: 
17:22:14.267784 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
17:22:14.267784 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
17:22:14.268781 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
17:22:14.268781 [info ] [Thread-1  ]: 1 of 5 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
17:22:14.269818 [info ] [Thread-2  ]: 2 of 5 START view model CUSTOMERS.stg_leads .................................... [RUN]
17:22:14.270777 [info ] [Thread-3  ]: 3 of 5 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
17:22:14.271775 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
17:22:14.272772 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
17:22:14.272772 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
17:22:14.273768 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
17:22:14.273768 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
17:22:14.273768 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
17:22:14.274779 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
17:22:14.274779 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
17:22:14.276794 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
17:22:14.276794 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
17:22:14.278789 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
17:22:14.281748 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
17:22:14.282743 [debug] [Thread-1  ]: finished collecting timing info
17:22:14.282743 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
17:22:14.316653 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
17:22:14.317650 [debug] [Thread-2  ]: finished collecting timing info
17:22:14.318650 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
17:22:14.318650 [debug] [Thread-3  ]: finished collecting timing info
17:22:14.322664 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
17:22:14.323636 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
17:22:14.324646 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
17:22:14.324646 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as lead_id,
    converted_at,
    date_part('month', converted_at) as month,
    date_part('week', converted_at) as week,
    date_part('day', converted_at) as day,
    to_char(converted_at, 'Mon') as month_name,
    to_char(converted_at, 'Dy') as day_name
from leads
where converted_at is not null
  );
17:22:14.328648 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
17:22:14.329649 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:22:14.331611 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
17:22:14.333609 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id as lead_id,
    case
        when converted_at is null then 0
        else 1
    end as is_converted,
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
17:22:14.338750 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
17:22:14.338750 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:22:14.340748 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as is_closed,
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as is_won
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
17:22:14.344709 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:22:15.357728 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.03 seconds
17:22:15.364739 [debug] [Thread-1  ]: finished collecting timing info
17:22:15.364739 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
17:22:15.460145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f521d03-760e-4ef8-bd9b-fda67244ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164017CAC10>]}
17:22:15.461141 [info ] [Thread-1  ]: 1 of 5 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.19s]
17:22:15.461985 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
17:22:15.554259 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.22 seconds
17:22:15.557588 [debug] [Thread-2  ]: finished collecting timing info
17:22:15.557588 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
17:22:15.588988 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.24 seconds
17:22:15.594974 [debug] [Thread-3  ]: finished collecting timing info
17:22:15.596054 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
17:22:15.705691 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f521d03-760e-4ef8-bd9b-fda67244ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016401841D00>]}
17:22:15.706688 [info ] [Thread-2  ]: 2 of 5 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.43s]
17:22:15.707837 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
17:22:15.708836 [debug] [Thread-5  ]: Began running node model.prj_dbt.count_converted_time_source
17:22:15.708836 [info ] [Thread-5  ]: 4 of 5 START view model CUSTOMERS.count_converted_time_source .................. [RUN]
17:22:15.709869 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time_source"
17:22:15.710862 [debug] [Thread-5  ]: Began compiling node model.prj_dbt.count_converted_time_source
17:22:15.710862 [debug] [Thread-5  ]: Compiling model.prj_dbt.count_converted_time_source
17:22:15.713851 [debug] [Thread-5  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time_source"
17:22:15.717819 [debug] [Thread-5  ]: finished collecting timing info
17:22:15.717819 [debug] [Thread-5  ]: Began executing node model.prj_dbt.count_converted_time_source
17:22:15.721833 [debug] [Thread-5  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time_source"
17:22:15.828839 [debug] [Thread-5  ]: Using snowflake connection "model.prj_dbt.count_converted_time_source"
17:22:15.859239 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time_source"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time_source
  
   as (
    --

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

)

select
    *
    leads.source,
from conversion_date
left join leads
    using (lead_id)
  );
17:22:15.873392 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:22:16.075369 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f521d03-760e-4ef8-bd9b-fda67244ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164017CAD90>]}
17:22:16.123241 [info ] [Thread-3  ]: 3 of 5 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.80s]
17:22:16.153162 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
17:22:16.167124 [debug] [Thread-7  ]: Began running node model.prj_dbt.leads_comprehensive
17:22:16.168121 [info ] [Thread-7  ]: 5 of 5 START view model CUSTOMERS.leads_comprehensive .......................... [RUN]
17:22:16.174105 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.prj_dbt.leads_comprehensive"
17:22:16.175103 [debug] [Thread-7  ]: Began compiling node model.prj_dbt.leads_comprehensive
17:22:16.175103 [debug] [Thread-7  ]: Compiling model.prj_dbt.leads_comprehensive
17:22:16.208015 [debug] [Thread-7  ]: Writing injected SQL for node "model.prj_dbt.leads_comprehensive"
17:22:16.210009 [debug] [Thread-7  ]: finished collecting timing info
17:22:16.211007 [debug] [Thread-7  ]: Began executing node model.prj_dbt.leads_comprehensive
17:22:16.213999 [debug] [Thread-7  ]: Writing runtime SQL for node "model.prj_dbt.leads_comprehensive"
17:22:16.219983 [debug] [Thread-7  ]: Using snowflake connection "model.prj_dbt.leads_comprehensive"
17:22:16.220980 [debug] [Thread-7  ]: On model.prj_dbt.leads_comprehensive: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.leads_comprehensive"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.leads_comprehensive
  
   as (
    -- MODEL TO FACILITATE REGRESSION AND ML ANALYSES

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select
      lead_id,
      month,
      week,
      day,
      month_name,
      day_name
    from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

),

opportunities as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_opportunities

)

select
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
right join conversion_date
    using (lead_id)
right join stg_opportunities
    using (lead_id)
  );
17:22:16.221978 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:22:16.668212 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a416c8-0c03-020d-0002-4a1e000120fe
17:22:16.668212 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 4 unexpected 'leads'.
17:22:16.669210 [debug] [Thread-5  ]: finished collecting timing info
17:22:16.670187 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: Close
17:22:16.775828 [debug] [Thread-5  ]: Database Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'leads'.
  compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:22:16.776825 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f521d03-760e-4ef8-bd9b-fda67244ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016401873250>]}
17:22:16.778820 [error] [Thread-5  ]: 4 of 5 ERROR creating view model CUSTOMERS.count_converted_time_source ......... [[31mERROR[0m in 1.07s]
17:22:16.781264 [debug] [Thread-5  ]: Finished running node model.prj_dbt.count_converted_time_source
17:22:16.946216 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 0.72 seconds
17:22:16.948214 [debug] [Thread-7  ]: finished collecting timing info
17:22:16.949195 [debug] [Thread-7  ]: On model.prj_dbt.leads_comprehensive: Close
17:22:17.049990 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f521d03-760e-4ef8-bd9b-fda67244ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001640185D4F0>]}
17:22:17.050986 [info ] [Thread-7  ]: 5 of 5 OK created view model CUSTOMERS.leads_comprehensive ..................... [[32mSUCCESS 1[0m in 0.88s]
17:22:17.051983 [debug] [Thread-7  ]: Finished running node model.prj_dbt.leads_comprehensive
17:22:17.055978 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:22:17.057970 [info ] [MainThread]: 
17:22:17.058968 [info ] [MainThread]: Finished running 5 view models in 6.11s.
17:22:17.058968 [debug] [MainThread]: Connection 'master' was properly closed.
17:22:17.059984 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
17:22:17.060987 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
17:22:17.060987 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
17:22:17.060987 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
17:22:17.060987 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
17:22:17.061985 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time_source' was properly closed.
17:22:17.061985 [debug] [MainThread]: Connection 'model.prj_dbt.leads_comprehensive' was properly closed.
17:22:17.077969 [info ] [MainThread]: 
17:22:17.078965 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:22:17.079963 [info ] [MainThread]: 
17:22:17.080971 [error] [MainThread]: [33mDatabase Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)[0m
17:22:17.081956 [error] [MainThread]:   001003 (42000): SQL compilation error:
17:22:17.082957 [error] [MainThread]:   syntax error line 20 at position 4 unexpected 'leads'.
17:22:17.082957 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:22:17.083952 [info ] [MainThread]: 
17:22:17.084948 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
17:22:17.085946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001640144ABE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001640144ACA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001640188CB50>]}


============================== 2022-05-06 17:23:17.004711 | b2f534c6-bae9-440e-9fc2-49dfb81e7453 ==============================
17:23:17.004711 [info ] [MainThread]: Running with dbt=1.1.0
17:23:17.006698 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:23:17.007695 [debug] [MainThread]: Tracking: tracking
17:23:17.007695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027368CB6BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027368CB6C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027368CB6C70>]}
17:23:17.095835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:23:17.096870 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\mart\regression_ML\leads_comprehensive.sql
17:23:17.109083 [debug] [MainThread]: 1699: static parser successfully parsed mart\regression_ML\leads_comprehensive.sql
17:23:17.127589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

17:23:17.136577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2f534c6-bae9-440e-9fc2-49dfb81e7453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027368E17940>]}
17:23:17.149530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2f534c6-bae9-440e-9fc2-49dfb81e7453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027368D85910>]}
17:23:17.150527 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
17:23:17.151526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f534c6-bae9-440e-9fc2-49dfb81e7453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027368DC1D60>]}
17:23:17.153552 [info ] [MainThread]: 
17:23:17.155515 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:23:17.156543 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
17:23:17.173504 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
17:23:17.173504 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
17:23:17.174494 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:23:18.136629 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.96 seconds
17:23:18.142648 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
17:23:18.254796 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:23:18.263772 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:23:18.264769 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
17:23:18.264769 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:23:18.925068 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.66 seconds
17:23:18.927063 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
17:23:19.053709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f534c6-bae9-440e-9fc2-49dfb81e7453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027368E838E0>]}
17:23:19.054707 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:23:19.055703 [info ] [MainThread]: 
17:23:19.066676 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
17:23:19.066676 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
17:23:19.066676 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
17:23:19.067672 [info ] [Thread-1  ]: 1 of 5 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
17:23:19.067672 [info ] [Thread-2  ]: 2 of 5 START view model CUSTOMERS.stg_leads .................................... [RUN]
17:23:19.067672 [info ] [Thread-3  ]: 3 of 5 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
17:23:19.069667 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
17:23:19.070669 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
17:23:19.070669 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
17:23:19.071680 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
17:23:19.071680 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
17:23:19.072660 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
17:23:19.072660 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
17:23:19.073658 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
17:23:19.075651 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
17:23:19.075651 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
17:23:19.078642 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
17:23:19.081636 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
17:23:19.082634 [debug] [Thread-1  ]: finished collecting timing info
17:23:19.082634 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
17:23:19.121547 [debug] [Thread-2  ]: finished collecting timing info
17:23:19.126515 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
17:23:19.126515 [debug] [Thread-3  ]: finished collecting timing info
17:23:19.126515 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
17:23:19.127543 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
17:23:19.131502 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
17:23:19.134495 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
17:23:19.136488 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
17:23:19.137488 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as lead_id,
    converted_at,
    date_part('month', converted_at) as month,
    date_part('week', converted_at) as week,
    date_part('day', converted_at) as day,
    to_char(converted_at, 'Mon') as month_name,
    to_char(converted_at, 'Dy') as day_name
from leads
where converted_at is not null
  );
17:23:19.137488 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:23:19.140477 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
17:23:19.141477 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id as lead_id,
    case
        when converted_at is null then 0
        else 1
    end as is_converted,
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
17:23:19.143468 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
17:23:19.145463 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:23:19.146574 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as is_closed,
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as is_won
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
17:23:19.150564 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:23:20.248006 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.1 seconds
17:23:20.256995 [debug] [Thread-2  ]: finished collecting timing info
17:23:20.256995 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
17:23:20.366687 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.22 seconds
17:23:20.368690 [debug] [Thread-3  ]: finished collecting timing info
17:23:20.369681 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
17:23:20.371701 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f534c6-bae9-440e-9fc2-49dfb81e7453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273691B6B20>]}
17:23:20.371701 [info ] [Thread-2  ]: 2 of 5 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.30s]
17:23:20.374666 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
17:23:20.379653 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.24 seconds
17:23:20.381674 [debug] [Thread-1  ]: finished collecting timing info
17:23:20.381674 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
17:23:20.502962 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f534c6-bae9-440e-9fc2-49dfb81e7453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736915CCD0>]}
17:23:20.502962 [info ] [Thread-3  ]: 3 of 5 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.43s]
17:23:20.503960 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
17:23:20.508916 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f534c6-bae9-440e-9fc2-49dfb81e7453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273691BAE20>]}
17:23:20.509913 [info ] [Thread-1  ]: 1 of 5 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.44s]
17:23:20.510911 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
17:23:20.511908 [debug] [Thread-5  ]: Began running node model.prj_dbt.count_converted_time_source
17:23:20.511908 [info ] [Thread-5  ]: 4 of 5 START view model CUSTOMERS.count_converted_time_source .................. [RUN]
17:23:20.512905 [debug] [Thread-6  ]: Began running node model.prj_dbt.leads_comprehensive
17:23:20.512905 [info ] [Thread-6  ]: 5 of 5 START view model CUSTOMERS.leads_comprehensive .......................... [RUN]
17:23:20.513902 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time_source"
17:23:20.513902 [debug] [Thread-5  ]: Began compiling node model.prj_dbt.count_converted_time_source
17:23:20.514900 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.prj_dbt.leads_comprehensive"
17:23:20.514900 [debug] [Thread-5  ]: Compiling model.prj_dbt.count_converted_time_source
17:23:20.514900 [debug] [Thread-6  ]: Began compiling node model.prj_dbt.leads_comprehensive
17:23:20.517110 [debug] [Thread-6  ]: Compiling model.prj_dbt.leads_comprehensive
17:23:20.519143 [debug] [Thread-5  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time_source"
17:23:20.522128 [debug] [Thread-6  ]: Writing injected SQL for node "model.prj_dbt.leads_comprehensive"
17:23:20.524091 [debug] [Thread-5  ]: finished collecting timing info
17:23:20.524091 [debug] [Thread-6  ]: finished collecting timing info
17:23:20.525091 [debug] [Thread-5  ]: Began executing node model.prj_dbt.count_converted_time_source
17:23:20.525091 [debug] [Thread-6  ]: Began executing node model.prj_dbt.leads_comprehensive
17:23:20.528266 [debug] [Thread-5  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time_source"
17:23:20.531258 [debug] [Thread-6  ]: Writing runtime SQL for node "model.prj_dbt.leads_comprehensive"
17:23:20.535247 [debug] [Thread-5  ]: Using snowflake connection "model.prj_dbt.count_converted_time_source"
17:23:20.536403 [debug] [Thread-6  ]: Using snowflake connection "model.prj_dbt.leads_comprehensive"
17:23:20.536403 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time_source"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time_source
  
   as (
    --

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

)

select
    *
    leads.source,
from conversion_date
left join leads
    using (lead_id)
  );
17:23:20.537396 [debug] [Thread-6  ]: On model.prj_dbt.leads_comprehensive: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.leads_comprehensive"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.leads_comprehensive
  
   as (
    -- MODEL TO FACILITATE REGRESSION AND ML ANALYSES

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select
      lead_id,
      month,
      week,
      day,
      month_name,
      day_name
    from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

),

opportunities as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_opportunities

)

select
    lead_id,
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
right join conversion_date
    using (lead_id)
right join stg_opportunities
    using (lead_id)
  );
17:23:20.537396 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:23:20.538383 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:23:21.374904 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a416c9-0c03-02fe-0000-00024a1ef105
17:23:21.375931 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 4 unexpected 'leads'.
17:23:21.375931 [debug] [Thread-5  ]: finished collecting timing info
17:23:21.375931 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: Close
17:23:21.471235 [debug] [Thread-5  ]: Database Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'leads'.
  compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:23:21.472219 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f534c6-bae9-440e-9fc2-49dfb81e7453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273691E5040>]}
17:23:21.472219 [error] [Thread-5  ]: 4 of 5 ERROR creating view model CUSTOMERS.count_converted_time_source ......... [[31mERROR[0m in 0.96s]
17:23:21.473176 [debug] [Thread-5  ]: Finished running node model.prj_dbt.count_converted_time_source
17:23:21.534382 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.0 seconds
17:23:21.539322 [debug] [Thread-6  ]: finished collecting timing info
17:23:21.541317 [debug] [Thread-6  ]: On model.prj_dbt.leads_comprehensive: Close
17:23:21.915819 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f534c6-bae9-440e-9fc2-49dfb81e7453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273691F5490>]}
17:23:21.916854 [info ] [Thread-6  ]: 5 of 5 OK created view model CUSTOMERS.leads_comprehensive ..................... [[32mSUCCESS 1[0m in 1.40s]
17:23:21.917817 [debug] [Thread-6  ]: Finished running node model.prj_dbt.leads_comprehensive
17:23:21.919810 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:23:21.920805 [info ] [MainThread]: 
17:23:21.920805 [info ] [MainThread]: Finished running 5 view models in 4.77s.
17:23:21.921810 [debug] [MainThread]: Connection 'master' was properly closed.
17:23:21.921810 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
17:23:21.922839 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
17:23:21.922839 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
17:23:21.922839 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
17:23:21.923798 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
17:23:21.923798 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time_source' was properly closed.
17:23:21.923798 [debug] [MainThread]: Connection 'model.prj_dbt.leads_comprehensive' was properly closed.
17:23:21.935766 [info ] [MainThread]: 
17:23:21.937862 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:23:21.938860 [info ] [MainThread]: 
17:23:21.939860 [error] [MainThread]: [33mDatabase Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)[0m
17:23:21.940857 [error] [MainThread]:   001003 (42000): SQL compilation error:
17:23:21.941859 [error] [MainThread]:   syntax error line 20 at position 4 unexpected 'leads'.
17:23:21.943849 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:23:21.943849 [info ] [MainThread]: 
17:23:21.944846 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
17:23:21.946845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027368DBBBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027368DBBB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273691D11C0>]}


============================== 2022-05-06 17:33:39.407113 | c3f08a67-ad09-4835-8b3f-5f5bf87aae71 ==============================
17:33:39.407113 [info ] [MainThread]: Running with dbt=1.1.0
17:33:39.408106 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:33:39.410090 [debug] [MainThread]: Tracking: tracking
17:33:39.410090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC0679BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC0679C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC0679C70>]}
17:33:39.495524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:33:39.495524 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\mart\regression_ML\leads_comprehensive.sql
17:33:39.508662 [debug] [MainThread]: 1699: static parser successfully parsed mart\regression_ML\leads_comprehensive.sql
17:33:39.524814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

17:33:39.535318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3f08a67-ad09-4835-8b3f-5f5bf87aae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC07D7910>]}
17:33:39.546750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3f08a67-ad09-4835-8b3f-5f5bf87aae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC07448E0>]}
17:33:39.547730 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
17:33:39.549726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f08a67-ad09-4835-8b3f-5f5bf87aae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC0782D30>]}
17:33:39.553714 [info ] [MainThread]: 
17:33:39.554718 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:33:39.556707 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
17:33:39.577650 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
17:33:39.577650 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
17:33:39.578647 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:33:40.457606 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.88 seconds
17:33:40.461595 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
17:33:40.593378 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:33:40.603348 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:33:40.603348 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
17:33:40.603348 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:33:41.315413 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.71 seconds
17:33:41.318407 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
17:33:41.418195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f08a67-ad09-4835-8b3f-5f5bf87aae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC0986310>]}
17:33:41.419193 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:33:41.420190 [info ] [MainThread]: 
17:33:41.435150 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
17:33:41.436147 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
17:33:41.436147 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
17:33:41.437144 [info ] [Thread-1  ]: 1 of 5 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
17:33:41.437144 [info ] [Thread-2  ]: 2 of 5 START view model CUSTOMERS.stg_leads .................................... [RUN]
17:33:41.438152 [info ] [Thread-3  ]: 3 of 5 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
17:33:41.440154 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
17:33:41.442134 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
17:33:41.442134 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
17:33:41.442134 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
17:33:41.443132 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
17:33:41.443132 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
17:33:41.444129 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
17:33:41.444129 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
17:33:41.447120 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
17:33:41.447120 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
17:33:41.449115 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
17:33:41.453103 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
17:33:41.454099 [debug] [Thread-1  ]: finished collecting timing info
17:33:41.455097 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
17:33:41.471055 [debug] [Thread-2  ]: finished collecting timing info
17:33:41.472052 [debug] [Thread-3  ]: finished collecting timing info
17:33:41.487012 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
17:33:41.499976 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
17:33:41.501007 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
17:33:41.502998 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
17:33:41.506967 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
17:33:41.508953 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
17:33:41.508953 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as lead_id,
    converted_at,
    date_part('month', converted_at) as month,
    date_part('week', converted_at) as week,
    date_part('day', converted_at) as day,
    to_char(converted_at, 'Mon') as month_name,
    to_char(converted_at, 'Dy') as day_name
from leads
where converted_at is not null
  );
17:33:41.509950 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:33:41.510947 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
17:33:41.513942 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
17:33:41.514939 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id as lead_id,
    case
        when converted_at is null then 0
        else 1
    end as is_converted,
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
17:33:41.516931 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as is_closed,
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as is_won
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
17:33:41.519952 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:33:41.519952 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:33:42.204482 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.68 seconds
17:33:42.210648 [debug] [Thread-3  ]: finished collecting timing info
17:33:42.211642 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
17:33:42.303521 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f08a67-ad09-4835-8b3f-5f5bf87aae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC0B7A6D0>]}
17:33:42.303521 [info ] [Thread-3  ]: 3 of 5 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 0.86s]
17:33:42.304521 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
17:33:42.466962 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.96 seconds
17:33:42.468955 [debug] [Thread-1  ]: finished collecting timing info
17:33:42.469954 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
17:33:42.609527 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f08a67-ad09-4835-8b3f-5f5bf87aae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC0B7ACA0>]}
17:33:42.609527 [info ] [Thread-1  ]: 1 of 5 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.17s]
17:33:42.611493 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
17:33:42.881010 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.36 seconds
17:33:42.886344 [debug] [Thread-2  ]: finished collecting timing info
17:33:42.887383 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
17:33:43.008200 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f08a67-ad09-4835-8b3f-5f5bf87aae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC0B93280>]}
17:33:43.009205 [info ] [Thread-2  ]: 2 of 5 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.57s]
17:33:43.011154 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
17:33:43.013154 [debug] [Thread-5  ]: Began running node model.prj_dbt.count_converted_time_source
17:33:43.013154 [debug] [Thread-6  ]: Began running node model.prj_dbt.leads_comprehensive
17:33:43.014178 [info ] [Thread-5  ]: 4 of 5 START view model CUSTOMERS.count_converted_time_source .................. [RUN]
17:33:43.015177 [info ] [Thread-6  ]: 5 of 5 START view model CUSTOMERS.leads_comprehensive .......................... [RUN]
17:33:43.017136 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time_source"
17:33:43.017136 [debug] [Thread-5  ]: Began compiling node model.prj_dbt.count_converted_time_source
17:33:43.018134 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.prj_dbt.leads_comprehensive"
17:33:43.018134 [debug] [Thread-5  ]: Compiling model.prj_dbt.count_converted_time_source
17:33:43.018134 [debug] [Thread-6  ]: Began compiling node model.prj_dbt.leads_comprehensive
17:33:43.020158 [debug] [Thread-6  ]: Compiling model.prj_dbt.leads_comprehensive
17:33:43.023126 [debug] [Thread-5  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time_source"
17:33:43.026420 [debug] [Thread-6  ]: Writing injected SQL for node "model.prj_dbt.leads_comprehensive"
17:33:43.028415 [debug] [Thread-5  ]: finished collecting timing info
17:33:43.029412 [debug] [Thread-6  ]: finished collecting timing info
17:33:43.029412 [debug] [Thread-5  ]: Began executing node model.prj_dbt.count_converted_time_source
17:33:43.030409 [debug] [Thread-6  ]: Began executing node model.prj_dbt.leads_comprehensive
17:33:43.036395 [debug] [Thread-5  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time_source"
17:33:43.040429 [debug] [Thread-6  ]: Writing runtime SQL for node "model.prj_dbt.leads_comprehensive"
17:33:43.043376 [debug] [Thread-5  ]: Using snowflake connection "model.prj_dbt.count_converted_time_source"
17:33:43.045371 [debug] [Thread-6  ]: Using snowflake connection "model.prj_dbt.leads_comprehensive"
17:33:43.045371 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time_source"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time_source
  
   as (
    --

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

)

select
    *
    leads.source,
from conversion_date
left join leads
    using (lead_id)
  );
17:33:43.045371 [debug] [Thread-6  ]: On model.prj_dbt.leads_comprehensive: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.leads_comprehensive"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.leads_comprehensive
  
   as (
    -- MODEL TO FACILITATE REGRESSION AND ML ANALYSES

with leads as (

    select
      lead_id,
      source,
      job_title,
      state,
      industry,
      fleet_size
    from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select
      lead_id,
      month,
      week,
      day,
      month_name,
      day_name
    from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

),

opportunities as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_opportunities

)

select *
   from leads
   inner join opportunities
       using (lead_id)
   inner join conversion_date
       using (lead_id)
  );
17:33:43.046413 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:33:43.046413 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:33:43.633216 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a416d3-0c03-01d5-0002-4a1e0001505a
17:33:43.633216 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 4 unexpected 'leads'.
17:33:43.633216 [debug] [Thread-5  ]: finished collecting timing info
17:33:43.634202 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: Close
17:33:43.765863 [debug] [Thread-5  ]: Database Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'leads'.
  compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:33:43.767079 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f08a67-ad09-4835-8b3f-5f5bf87aae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC0B9EC70>]}
17:33:43.767079 [error] [Thread-5  ]: 4 of 5 ERROR creating view model CUSTOMERS.count_converted_time_source ......... [[31mERROR[0m in 0.75s]
17:33:43.768127 [debug] [Thread-5  ]: Finished running node model.prj_dbt.count_converted_time_source
17:33:43.908932 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 0.86 seconds
17:33:43.911913 [debug] [Thread-6  ]: finished collecting timing info
17:33:43.912892 [debug] [Thread-6  ]: On model.prj_dbt.leads_comprehensive: Close
17:33:44.451554 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f08a67-ad09-4835-8b3f-5f5bf87aae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC08190A0>]}
17:33:44.452554 [info ] [Thread-6  ]: 5 of 5 OK created view model CUSTOMERS.leads_comprehensive ..................... [[32mSUCCESS 1[0m in 1.43s]
17:33:44.454546 [debug] [Thread-6  ]: Finished running node model.prj_dbt.leads_comprehensive
17:33:44.458536 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:33:44.459533 [info ] [MainThread]: 
17:33:44.460528 [info ] [MainThread]: Finished running 5 view models in 4.90s.
17:33:44.461527 [debug] [MainThread]: Connection 'master' was properly closed.
17:33:44.461527 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
17:33:44.461527 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
17:33:44.462555 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
17:33:44.462555 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
17:33:44.462555 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
17:33:44.463521 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time_source' was properly closed.
17:33:44.463521 [debug] [MainThread]: Connection 'model.prj_dbt.leads_comprehensive' was properly closed.
17:33:44.473496 [info ] [MainThread]: 
17:33:44.474494 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:33:44.475492 [info ] [MainThread]: 
17:33:44.476489 [error] [MainThread]: [33mDatabase Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)[0m
17:33:44.477496 [error] [MainThread]:   001003 (42000): SQL compilation error:
17:33:44.478484 [error] [MainThread]:   syntax error line 20 at position 4 unexpected 'leads'.
17:33:44.478484 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:33:44.479481 [info ] [MainThread]: 
17:33:44.480511 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
17:33:44.481497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC09E9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC077AAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC077AB80>]}


============================== 2022-05-06 17:38:37.102752 | a0bf5288-35f7-4c81-ae5d-07889a3bf681 ==============================
17:38:37.102752 [info ] [MainThread]: Running with dbt=1.1.0
17:38:37.103750 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:38:37.104748 [debug] [MainThread]: Tracking: tracking
17:38:37.104748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F26E7CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F26E7D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F26E7D60>]}
17:38:37.187990 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
17:38:37.188988 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\regression_ML\converted_comprehensive.sql
17:38:37.189984 [debug] [MainThread]: Partial parsing: deleted file: prj_dbt://models\mart\regression_ML\leads_comprehensive.sql
17:38:37.189984 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\mart\dashboard\count_converted_time_source.sql
17:38:37.202114 [debug] [MainThread]: 1699: static parser successfully parsed mart\regression_ML\converted_comprehensive.sql
17:38:37.214245 [debug] [MainThread]: 1699: static parser successfully parsed mart\dashboard\count_converted_time_source.sql
17:38:37.221332 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

17:38:37.232333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0bf5288-35f7-4c81-ae5d-07889a3bf681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F284BF40>]}
17:38:37.244301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0bf5288-35f7-4c81-ae5d-07889a3bf681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F274DEE0>]}
17:38:37.245294 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
17:38:37.246263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0bf5288-35f7-4c81-ae5d-07889a3bf681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F27B4A30>]}
17:38:37.248268 [info ] [MainThread]: 
17:38:37.250252 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:38:37.253275 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
17:38:37.273190 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
17:38:37.274187 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
17:38:37.274187 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:38:38.236889 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.96 seconds
17:38:38.238914 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
17:38:39.343940 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:38:39.351928 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:38:39.351928 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
17:38:39.352919 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:38:40.129848 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.78 seconds
17:38:40.131876 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
17:38:40.237737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0bf5288-35f7-4c81-ae5d-07889a3bf681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F29F66D0>]}
17:38:40.239740 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:38:40.241728 [info ] [MainThread]: 
17:38:40.264620 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
17:38:40.265618 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
17:38:40.265618 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
17:38:40.266616 [info ] [Thread-1  ]: 1 of 5 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
17:38:40.267614 [info ] [Thread-2  ]: 2 of 5 START view model CUSTOMERS.stg_leads .................................... [RUN]
17:38:40.267614 [info ] [Thread-3  ]: 3 of 5 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
17:38:40.269607 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
17:38:40.270604 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
17:38:40.270604 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
17:38:40.271603 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
17:38:40.271603 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
17:38:40.272635 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
17:38:40.272635 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
17:38:40.272635 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
17:38:40.274595 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
17:38:40.275621 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
17:38:40.277585 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
17:38:40.281574 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
17:38:40.283569 [debug] [Thread-1  ]: finished collecting timing info
17:38:40.283569 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
17:38:40.290551 [debug] [Thread-3  ]: finished collecting timing info
17:38:40.317479 [debug] [Thread-2  ]: finished collecting timing info
17:38:40.341414 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
17:38:40.341414 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
17:38:40.342414 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
17:38:40.348396 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
17:38:40.355377 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
17:38:40.357372 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
17:38:40.359367 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as lead_id,
    converted_at,
    date_part('month', converted_at) as month,
    date_part('week', converted_at) as week,
    date_part('day', converted_at) as day,
    to_char(converted_at, 'Mon') as month_name,
    to_char(converted_at, 'Dy') as day_name
from leads
where converted_at is not null
  );
17:38:40.360364 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:38:40.366461 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
17:38:40.368458 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
17:38:40.368458 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id as lead_id,
    case
        when converted_at is null then 0
        else 1
    end as is_converted,
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
17:38:40.370450 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as is_closed,
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as is_won
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
17:38:40.371448 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:38:40.372445 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:38:41.266253 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.89 seconds
17:38:41.273257 [debug] [Thread-3  ]: finished collecting timing info
17:38:41.274262 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
17:38:41.401455 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bf5288-35f7-4c81-ae5d-07889a3bf681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F2B8B130>]}
17:38:41.403450 [info ] [Thread-3  ]: 3 of 5 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.13s]
17:38:41.406405 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
17:38:41.432067 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.07 seconds
17:38:41.434031 [debug] [Thread-1  ]: finished collecting timing info
17:38:41.435064 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
17:38:41.543320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bf5288-35f7-4c81-ae5d-07889a3bf681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F2A4BEB0>]}
17:38:41.544317 [info ] [Thread-1  ]: 1 of 5 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.27s]
17:38:41.545315 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
17:38:41.580221 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.21 seconds
17:38:41.582215 [debug] [Thread-2  ]: finished collecting timing info
17:38:41.583213 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
17:38:41.676962 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bf5288-35f7-4c81-ae5d-07889a3bf681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F2B7D250>]}
17:38:41.676962 [info ] [Thread-2  ]: 2 of 5 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.41s]
17:38:41.677959 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
17:38:41.678957 [debug] [Thread-5  ]: Began running node model.prj_dbt.converted_comprehensive
17:38:41.678957 [debug] [Thread-6  ]: Began running node model.prj_dbt.count_converted_time_source
17:38:41.678957 [info ] [Thread-5  ]: 4 of 5 START view model CUSTOMERS.converted_comprehensive ...................... [RUN]
17:38:41.679954 [info ] [Thread-6  ]: 5 of 5 START view model CUSTOMERS.count_converted_time_source .................. [RUN]
17:38:41.680951 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.prj_dbt.converted_comprehensive"
17:38:41.680951 [debug] [Thread-5  ]: Began compiling node model.prj_dbt.converted_comprehensive
17:38:41.680951 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time_source"
17:38:41.680951 [debug] [Thread-5  ]: Compiling model.prj_dbt.converted_comprehensive
17:38:41.681949 [debug] [Thread-6  ]: Began compiling node model.prj_dbt.count_converted_time_source
17:38:41.682946 [debug] [Thread-6  ]: Compiling model.prj_dbt.count_converted_time_source
17:38:41.684941 [debug] [Thread-5  ]: Writing injected SQL for node "model.prj_dbt.converted_comprehensive"
17:38:41.687933 [debug] [Thread-6  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time_source"
17:38:41.689938 [debug] [Thread-5  ]: finished collecting timing info
17:38:41.689938 [debug] [Thread-5  ]: Began executing node model.prj_dbt.converted_comprehensive
17:38:41.690925 [debug] [Thread-6  ]: finished collecting timing info
17:38:41.693917 [debug] [Thread-5  ]: Writing runtime SQL for node "model.prj_dbt.converted_comprehensive"
17:38:41.693917 [debug] [Thread-6  ]: Began executing node model.prj_dbt.count_converted_time_source
17:38:41.699749 [debug] [Thread-6  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time_source"
17:38:41.701760 [debug] [Thread-5  ]: Using snowflake connection "model.prj_dbt.converted_comprehensive"
17:38:41.702741 [debug] [Thread-5  ]: On model.prj_dbt.converted_comprehensive: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.converted_comprehensive"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.converted_comprehensive
  
   as (
    -- MODEL TO FACILITATE REGRESSION AND ML ANALYSES

with leads as (

    select
      lead_id,
      source,
      job_title,
      state,
      industry,
      fleet_size
    from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select
      lead_id,
      month,
      week,
      day,
      month_name,
      day_name
    from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

),

opportunities as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_opportunities

)

select *
   from leads
   inner join opportunities
       using (lead_id)
   inner join conversion_date
       using (lead_id)
  );
17:38:41.702741 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:38:41.703743 [debug] [Thread-6  ]: Using snowflake connection "model.prj_dbt.count_converted_time_source"
17:38:41.706730 [debug] [Thread-6  ]: On model.prj_dbt.count_converted_time_source: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time_source"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time_source
  
   as (
    --

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

)

select
    leads.lead_id,
    leads.source,
    conversion_date.month,
    conversion_date.week,
    conversion_date.day,
    conversion_date.month_name,
    conversion_date.week_name
from conversion_date
left join leads
    using (lead_id)
  );
17:38:41.706730 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:38:42.554889 [debug] [Thread-6  ]: Snowflake adapter: Snowflake query id: 01a416d8-0c03-02c6-0002-4a1e00011186
17:38:42.556046 [debug] [Thread-6  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 4
invalid identifier 'CONVERSION_DATE.WEEK_NAME'
17:38:42.556046 [debug] [Thread-6  ]: finished collecting timing info
17:38:42.556046 [debug] [Thread-6  ]: On model.prj_dbt.count_converted_time_source: Close
17:38:42.644498 [debug] [Thread-6  ]: Database Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)
  000904 (42000): SQL compilation error: error line 25 at position 4
  invalid identifier 'CONVERSION_DATE.WEEK_NAME'
  compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:38:42.646929 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bf5288-35f7-4c81-ae5d-07889a3bf681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F2BF6BB0>]}
17:38:42.648182 [error] [Thread-6  ]: 5 of 5 ERROR creating view model CUSTOMERS.count_converted_time_source ......... [[31mERROR[0m in 0.97s]
17:38:42.651146 [debug] [Thread-6  ]: Finished running node model.prj_dbt.count_converted_time_source
17:38:42.837192 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.13 seconds
17:38:42.839180 [debug] [Thread-5  ]: finished collecting timing info
17:38:42.839180 [debug] [Thread-5  ]: On model.prj_dbt.converted_comprehensive: Close
17:38:42.934349 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bf5288-35f7-4c81-ae5d-07889a3bf681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F2BED760>]}
17:38:42.934349 [info ] [Thread-5  ]: 4 of 5 OK created view model CUSTOMERS.converted_comprehensive ................. [[32mSUCCESS 1[0m in 1.25s]
17:38:42.935345 [debug] [Thread-5  ]: Finished running node model.prj_dbt.converted_comprehensive
17:38:42.938338 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:38:42.939332 [info ] [MainThread]: 
17:38:42.940362 [info ] [MainThread]: Finished running 5 view models in 5.69s.
17:38:42.940362 [debug] [MainThread]: Connection 'master' was properly closed.
17:38:42.941361 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
17:38:42.941361 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
17:38:42.941361 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
17:38:42.942357 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
17:38:42.942357 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
17:38:42.942357 [debug] [MainThread]: Connection 'model.prj_dbt.converted_comprehensive' was properly closed.
17:38:42.942357 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time_source' was properly closed.
17:38:42.955292 [info ] [MainThread]: 
17:38:42.956289 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:38:42.957285 [info ] [MainThread]: 
17:38:42.958283 [error] [MainThread]: [33mDatabase Error in model count_converted_time_source (models\mart\dashboard\count_converted_time_source.sql)[0m
17:38:42.959280 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 25 at position 4
17:38:42.960278 [error] [MainThread]:   invalid identifier 'CONVERSION_DATE.WEEK_NAME'
17:38:42.961276 [error] [MainThread]:   compiled SQL at target\run\prj_dbt\models\mart\dashboard\count_converted_time_source.sql
17:38:42.963273 [info ] [MainThread]: 
17:38:42.964295 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
17:38:42.966264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F2A62E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F2A62850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F27EAD00>]}


============================== 2022-05-06 17:39:05.766139 | c37cb9f5-ee9c-4206-b2fc-097488808170 ==============================
17:39:05.766139 [info ] [MainThread]: Running with dbt=1.1.0
17:39:05.767166 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:39:05.768133 [debug] [MainThread]: Tracking: tracking
17:39:05.768133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE4B8BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE4B8C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE4B8CA0>]}
17:39:05.846254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:39:05.847282 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\mart\dashboard\count_converted_time_source.sql
17:39:05.859350 [debug] [MainThread]: 1699: static parser successfully parsed mart\dashboard\count_converted_time_source.sql
17:39:05.875441 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

17:39:05.885632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c37cb9f5-ee9c-4206-b2fc-097488808170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE63E940>]}
17:39:05.897036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c37cb9f5-ee9c-4206-b2fc-097488808170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE585700>]}
17:39:05.898034 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
17:39:05.899030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c37cb9f5-ee9c-4206-b2fc-097488808170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE4B69A0>]}
17:39:05.901026 [info ] [MainThread]: 
17:39:05.902023 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:39:05.904017 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
17:39:05.922966 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
17:39:05.922966 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
17:39:05.923982 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:39:06.660161 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.74 seconds
17:39:06.661158 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
17:39:06.844741 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:39:06.856076 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
17:39:06.856076 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
17:39:06.857101 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:39:07.640953 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.78 seconds
17:39:07.643945 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
17:39:07.743181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c37cb9f5-ee9c-4206-b2fc-097488808170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE6868E0>]}
17:39:07.744151 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:39:07.745148 [info ] [MainThread]: 
17:39:07.756118 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
17:39:07.756118 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
17:39:07.757116 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
17:39:07.757116 [info ] [Thread-1  ]: 1 of 5 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
17:39:07.758113 [info ] [Thread-2  ]: 2 of 5 START view model CUSTOMERS.stg_leads .................................... [RUN]
17:39:07.758113 [info ] [Thread-3  ]: 3 of 5 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
17:39:07.760122 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
17:39:07.761107 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
17:39:07.761107 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
17:39:07.762102 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
17:39:07.762102 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
17:39:07.763100 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
17:39:07.763100 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
17:39:07.764118 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
17:39:07.766094 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
17:39:07.767091 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
17:39:07.769087 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
17:39:07.772076 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
17:39:07.773076 [debug] [Thread-1  ]: finished collecting timing info
17:39:07.774073 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
17:39:07.784044 [debug] [Thread-2  ]: finished collecting timing info
17:39:07.800007 [debug] [Thread-3  ]: finished collecting timing info
17:39:07.813965 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
17:39:07.813965 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
17:39:07.814963 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
17:39:07.819951 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
17:39:07.822941 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
17:39:07.824937 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
17:39:07.825934 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as lead_id,
    converted_at,
    date_part('month', converted_at) as month,
    date_part('week', converted_at) as week,
    date_part('day', converted_at) as day,
    to_char(converted_at, 'Mon') as month_name,
    to_char(converted_at, 'Dy') as day_name
from leads
where converted_at is not null
  );
17:39:07.825934 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:39:07.827930 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
17:39:07.829924 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id as lead_id,
    case
        when converted_at is null then 0
        else 1
    end as is_converted,
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
17:39:07.830922 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
17:39:07.832915 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:39:07.833915 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as is_closed,
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as is_won
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
17:39:07.837020 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:39:09.186494 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.36 seconds
17:39:09.189490 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.36 seconds
17:39:09.201445 [debug] [Thread-1  ]: finished collecting timing info
17:39:09.203441 [debug] [Thread-2  ]: finished collecting timing info
17:39:09.203441 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
17:39:09.204439 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
17:39:09.367838 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c37cb9f5-ee9c-4206-b2fc-097488808170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE939CA0>]}
17:39:09.367838 [info ] [Thread-1  ]: 1 of 5 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.61s]
17:39:09.368836 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
17:39:09.398754 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.56 seconds
17:39:09.400749 [debug] [Thread-3  ]: finished collecting timing info
17:39:09.400749 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
17:39:09.498232 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c37cb9f5-ee9c-4206-b2fc-097488808170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE9B3AC0>]}
17:39:09.498232 [info ] [Thread-2  ]: 2 of 5 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.74s]
17:39:09.500198 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
17:39:09.500198 [debug] [Thread-5  ]: Began running node model.prj_dbt.count_converted_time_source
17:39:09.501195 [info ] [Thread-5  ]: 4 of 5 START view model CUSTOMERS.count_converted_time_source .................. [RUN]
17:39:09.502193 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.prj_dbt.count_converted_time_source"
17:39:09.502193 [debug] [Thread-5  ]: Began compiling node model.prj_dbt.count_converted_time_source
17:39:09.503190 [debug] [Thread-5  ]: Compiling model.prj_dbt.count_converted_time_source
17:39:09.508177 [debug] [Thread-5  ]: Writing injected SQL for node "model.prj_dbt.count_converted_time_source"
17:39:09.510171 [debug] [Thread-5  ]: finished collecting timing info
17:39:09.511186 [debug] [Thread-5  ]: Began executing node model.prj_dbt.count_converted_time_source
17:39:09.517152 [debug] [Thread-5  ]: Writing runtime SQL for node "model.prj_dbt.count_converted_time_source"
17:39:09.521143 [debug] [Thread-5  ]: Using snowflake connection "model.prj_dbt.count_converted_time_source"
17:39:09.522139 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.count_converted_time_source"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.count_converted_time_source
  
   as (
    --

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

)

select
    leads.lead_id,
    leads.source,
    conversion_date.month,
    conversion_date.week,
    conversion_date.day,
    conversion_date.month_name,
    conversion_date.day_name
from conversion_date
left join leads
    using (lead_id)
  );
17:39:09.522139 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:39:09.599147 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c37cb9f5-ee9c-4206-b2fc-097488808170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE939E20>]}
17:39:09.599147 [info ] [Thread-3  ]: 3 of 5 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 1.84s]
17:39:09.600171 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
17:39:09.601141 [debug] [Thread-7  ]: Began running node model.prj_dbt.converted_comprehensive
17:39:09.602168 [info ] [Thread-7  ]: 5 of 5 START view model CUSTOMERS.converted_comprehensive ...................... [RUN]
17:39:09.603135 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.prj_dbt.converted_comprehensive"
17:39:09.603135 [debug] [Thread-7  ]: Began compiling node model.prj_dbt.converted_comprehensive
17:39:09.603135 [debug] [Thread-7  ]: Compiling model.prj_dbt.converted_comprehensive
17:39:09.607126 [debug] [Thread-7  ]: Writing injected SQL for node "model.prj_dbt.converted_comprehensive"
17:39:09.609119 [debug] [Thread-7  ]: finished collecting timing info
17:39:09.609119 [debug] [Thread-7  ]: Began executing node model.prj_dbt.converted_comprehensive
17:39:09.614106 [debug] [Thread-7  ]: Writing runtime SQL for node "model.prj_dbt.converted_comprehensive"
17:39:09.618095 [debug] [Thread-7  ]: Using snowflake connection "model.prj_dbt.converted_comprehensive"
17:39:09.618095 [debug] [Thread-7  ]: On model.prj_dbt.converted_comprehensive: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.converted_comprehensive"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.converted_comprehensive
  
   as (
    -- MODEL TO FACILITATE REGRESSION AND ML ANALYSES

with leads as (

    select
      lead_id,
      source,
      job_title,
      state,
      industry,
      fleet_size
    from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select
      lead_id,
      month,
      week,
      day,
      month_name,
      day_name
    from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

),

opportunities as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_opportunities

)

select *
   from leads
   inner join opportunities
       using (lead_id)
   inner join conversion_date
       using (lead_id)
  );
17:39:09.619093 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:39:10.563211 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.04 seconds
17:39:10.566294 [debug] [Thread-5  ]: finished collecting timing info
17:39:10.566294 [debug] [Thread-5  ]: On model.prj_dbt.count_converted_time_source: Close
17:39:10.732845 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c37cb9f5-ee9c-4206-b2fc-097488808170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE9C2850>]}
17:39:10.734835 [info ] [Thread-5  ]: 4 of 5 OK created view model CUSTOMERS.count_converted_time_source ............. [[32mSUCCESS 1[0m in 1.23s]
17:39:10.737792 [debug] [Thread-5  ]: Finished running node model.prj_dbt.count_converted_time_source
17:39:11.336968 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.72 seconds
17:39:11.338963 [debug] [Thread-7  ]: finished collecting timing info
17:39:11.338963 [debug] [Thread-7  ]: On model.prj_dbt.converted_comprehensive: Close
17:39:11.478984 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c37cb9f5-ee9c-4206-b2fc-097488808170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE94DC70>]}
17:39:11.479997 [info ] [Thread-7  ]: 5 of 5 OK created view model CUSTOMERS.converted_comprehensive ................. [[32mSUCCESS 1[0m in 1.88s]
17:39:11.480995 [debug] [Thread-7  ]: Finished running node model.prj_dbt.converted_comprehensive
17:39:11.483959 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:39:11.483959 [info ] [MainThread]: 
17:39:11.484953 [info ] [MainThread]: Finished running 5 view models in 5.58s.
17:39:11.485981 [debug] [MainThread]: Connection 'master' was properly closed.
17:39:11.485981 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
17:39:11.486948 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
17:39:11.486948 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
17:39:11.487947 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
17:39:11.487947 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
17:39:11.488942 [debug] [MainThread]: Connection 'model.prj_dbt.count_converted_time_source' was properly closed.
17:39:11.488942 [debug] [MainThread]: Connection 'model.prj_dbt.converted_comprehensive' was properly closed.
17:39:11.507893 [info ] [MainThread]: 
17:39:11.508889 [info ] [MainThread]: [32mCompleted successfully[0m
17:39:11.509890 [info ] [MainThread]: 
17:39:11.511887 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
17:39:11.512882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE5BB8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE5BB9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADE7DA9D0>]}


============================== 2022-05-06 18:00:51.466090 | 5cbff1a3-d77c-4971-ba1c-35c843027dee ==============================
18:00:51.466090 [info ] [MainThread]: Running with dbt=1.1.0
18:00:51.467098 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:00:51.468084 [debug] [MainThread]: Tracking: tracking
18:00:51.469081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020261058B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020261058BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020261058C40>]}
18:00:51.568849 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 4 files changed.
18:00:51.569845 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\dashboard\converted_drivers_closed_won.sql
18:00:51.570843 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\dashboard\converted_counts_time_source.sql
18:00:51.570843 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\dashboard\converted_drivers_converted.sql
18:00:51.570843 [debug] [MainThread]: Partial parsing: deleted file: prj_dbt://models\mart\dashboard\count_converted_time_source.sql
18:00:51.571840 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\mart\regression_ML\converted_comprehensive.sql
18:00:51.572818 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_conversion_date.sql
18:00:51.573806 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_opportunities.sql
18:00:51.573806 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_leads.sql
18:00:51.588463 [debug] [MainThread]: 1699: static parser successfully parsed mart\dashboard\converted_drivers_closed_won.sql
18:00:51.606762 [debug] [MainThread]: 1699: static parser successfully parsed mart\dashboard\converted_counts_time_source.sql
18:00:51.610740 [debug] [MainThread]: 1699: static parser successfully parsed mart\dashboard\converted_drivers_converted.sql
18:00:51.613715 [debug] [MainThread]: 1699: static parser successfully parsed mart\regression_ML\converted_comprehensive.sql
18:00:51.619877 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_conversion_date.sql
18:00:51.625965 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_opportunities.sql
18:00:51.631981 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_leads.sql
18:00:51.683622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020261041670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202611CAC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202611CACD0>]}


============================== 2022-05-06 18:01:28.742573 | c7ced75e-19dd-41b4-a48e-9578adabb9e7 ==============================
18:01:28.742573 [info ] [MainThread]: Running with dbt=1.1.0
18:01:28.744109 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ssantavicca3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:01:28.744109 [debug] [MainThread]: Tracking: tracking
18:01:28.745141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1BEE8CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1BEE8D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1BEE8D60>]}
18:01:28.825258 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 4 files changed.
18:01:28.825258 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\dashboard\converted_drivers_converted.sql
18:01:28.826406 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\dashboard\converted_counts_time_source.sql
18:01:28.826406 [debug] [MainThread]: Partial parsing: added file: prj_dbt://models\mart\dashboard\converted_drivers_closed_won.sql
18:01:28.827405 [debug] [MainThread]: Partial parsing: deleted file: prj_dbt://models\mart\dashboard\count_converted_time_source.sql
18:01:28.827405 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_opportunities.sql
18:01:28.827405 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\mart\regression_ML\converted_comprehensive.sql
18:01:28.828402 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_conversion_date.sql
18:01:28.828402 [debug] [MainThread]: Partial parsing: updated file: prj_dbt://models\staging\stg_leads.sql
18:01:28.844547 [debug] [MainThread]: 1699: static parser successfully parsed mart\dashboard\converted_drivers_converted.sql
18:01:28.862508 [debug] [MainThread]: 1699: static parser successfully parsed mart\dashboard\converted_counts_time_source.sql
18:01:28.864526 [debug] [MainThread]: 1699: static parser successfully parsed mart\dashboard\converted_drivers_closed_won.sql
18:01:28.867485 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_opportunities.sql
18:01:28.870507 [debug] [MainThread]: 1699: static parser successfully parsed mart\regression_ML\converted_comprehensive.sql
18:01:28.873501 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_conversion_date.sql
18:01:28.876496 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_leads.sql
18:01:28.928890 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.prj_dbt.example

18:01:28.939885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7ced75e-19dd-41b4-a48e-9578adabb9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1CFEF1C0>]}
18:01:28.951819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7ced75e-19dd-41b4-a48e-9578adabb9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1CFBB9A0>]}
18:01:28.951819 [info ] [MainThread]: Found 7 models, 11 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
18:01:28.952816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7ced75e-19dd-41b4-a48e-9578adabb9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1CFBBAF0>]}
18:01:28.954849 [info ] [MainThread]: 
18:01:28.956856 [debug] [MainThread]: Acquiring new snowflake connection "master"
18:01:28.958835 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT"
18:01:28.973792 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT"
18:01:28.973792 [debug] [ThreadPool]: On list_FLEETIO_DBT: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT"} */

    show terse schemas in database FLEETIO_DBT
    limit 10000
18:01:28.974788 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:01:29.901066 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.93 seconds
18:01:29.907047 [debug] [ThreadPool]: On list_FLEETIO_DBT: Close
18:01:30.022560 [debug] [ThreadPool]: Acquiring new snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
18:01:30.032641 [debug] [ThreadPool]: Using snowflake connection "list_FLEETIO_DBT_CUSTOMERS"
18:01:30.033635 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "connection_name": "list_FLEETIO_DBT_CUSTOMERS"} */

    show terse objects in FLEETIO_DBT.CUSTOMERS
18:01:30.033635 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:01:30.755947 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 0.72 seconds
18:01:30.758164 [debug] [ThreadPool]: On list_FLEETIO_DBT_CUSTOMERS: Close
18:01:30.853094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7ced75e-19dd-41b4-a48e-9578adabb9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1D1C79D0>]}
18:01:30.854092 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:01:30.855137 [info ] [MainThread]: 
18:01:30.867264 [debug] [Thread-1  ]: Began running node model.prj_dbt.stg_conversion_date
18:01:30.868184 [debug] [Thread-2  ]: Began running node model.prj_dbt.stg_leads
18:01:30.868184 [debug] [Thread-3  ]: Began running node model.prj_dbt.stg_opportunities
18:01:30.868184 [info ] [Thread-1  ]: 1 of 7 START view model CUSTOMERS.stg_conversion_date .......................... [RUN]
18:01:30.869184 [info ] [Thread-2  ]: 2 of 7 START view model CUSTOMERS.stg_leads .................................... [RUN]
18:01:30.869184 [info ] [Thread-3  ]: 3 of 7 START view model CUSTOMERS.stg_opportunities ............................ [RUN]
18:01:30.871176 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.prj_dbt.stg_conversion_date"
18:01:30.872174 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.prj_dbt.stg_leads"
18:01:30.873171 [debug] [Thread-1  ]: Began compiling node model.prj_dbt.stg_conversion_date
18:01:30.873171 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.prj_dbt.stg_opportunities"
18:01:30.874177 [debug] [Thread-2  ]: Began compiling node model.prj_dbt.stg_leads
18:01:30.875166 [debug] [Thread-1  ]: Compiling model.prj_dbt.stg_conversion_date
18:01:30.875166 [debug] [Thread-3  ]: Began compiling node model.prj_dbt.stg_opportunities
18:01:30.876163 [debug] [Thread-2  ]: Compiling model.prj_dbt.stg_leads
18:01:30.878157 [debug] [Thread-1  ]: Writing injected SQL for node "model.prj_dbt.stg_conversion_date"
18:01:30.879157 [debug] [Thread-3  ]: Compiling model.prj_dbt.stg_opportunities
18:01:30.882149 [debug] [Thread-2  ]: Writing injected SQL for node "model.prj_dbt.stg_leads"
18:01:30.885139 [debug] [Thread-3  ]: Writing injected SQL for node "model.prj_dbt.stg_opportunities"
18:01:30.886142 [debug] [Thread-1  ]: finished collecting timing info
18:01:30.886142 [debug] [Thread-1  ]: Began executing node model.prj_dbt.stg_conversion_date
18:01:30.920073 [debug] [Thread-1  ]: Writing runtime SQL for node "model.prj_dbt.stg_conversion_date"
18:01:30.921043 [debug] [Thread-2  ]: finished collecting timing info
18:01:30.922041 [debug] [Thread-3  ]: finished collecting timing info
18:01:30.922041 [debug] [Thread-2  ]: Began executing node model.prj_dbt.stg_leads
18:01:30.922041 [debug] [Thread-3  ]: Began executing node model.prj_dbt.stg_opportunities
18:01:30.926029 [debug] [Thread-2  ]: Writing runtime SQL for node "model.prj_dbt.stg_leads"
18:01:30.928024 [debug] [Thread-1  ]: Using snowflake connection "model.prj_dbt.stg_conversion_date"
18:01:30.931016 [debug] [Thread-3  ]: Writing runtime SQL for node "model.prj_dbt.stg_opportunities"
18:01:30.932013 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_conversion_date"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_conversion_date
  
   as (
    -- DATE/TIME GRAINS TABLE

select
    ID as lead_id,
    converted_at,
    date_part('month', converted_at) as month,
    date_part('week', converted_at) as week,
    date_part('day', converted_at) as day,
    to_char(converted_at, 'Mon') as month_name,
    to_char(converted_at, 'Dy') as day_name
from leads
where converted_at is not null
  );
18:01:30.933011 [debug] [Thread-1  ]: Opening a new connection, currently in state init
18:01:30.936003 [debug] [Thread-2  ]: Using snowflake connection "model.prj_dbt.stg_leads"
18:01:30.937001 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_leads"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_leads
  
   as (
    -- BASELINE TABLE

select
    id as lead_id,
    case
        when converted_at is null then 0
        else 1
    end as is_converted,
    source,
    job_title,
    state,
    industry,
    fleet_size
from leads
  );
18:01:30.937998 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:01:30.940991 [debug] [Thread-3  ]: Using snowflake connection "model.prj_dbt.stg_opportunities"
18:01:30.945985 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.stg_opportunities"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.stg_opportunities
  
   as (
    -- OPPORTUNITIES-BASED TABLE

select
    contacts.lead_id,
    case
        when opportunities.is_closed = TRUE
            then 1
            else 0
        end as is_closed,
    case
        when opportunities.is_won = TRUE
            then 1
            else 0
        end as is_won
from leads
inner join contacts
    on leads.id = contacts.lead_id
inner join opportunities
    using (account_id)
  );
18:01:30.946974 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:01:31.638386 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.69 seconds
18:01:31.654574 [debug] [Thread-3  ]: finished collecting timing info
18:01:31.657759 [debug] [Thread-3  ]: On model.prj_dbt.stg_opportunities: Close
18:01:31.776724 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ced75e-19dd-41b4-a48e-9578adabb9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1D334C10>]}
18:01:31.777774 [info ] [Thread-3  ]: 3 of 7 OK created view model CUSTOMERS.stg_opportunities ....................... [[32mSUCCESS 1[0m in 0.90s]
18:01:31.780715 [debug] [Thread-3  ]: Finished running node model.prj_dbt.stg_opportunities
18:01:31.925489 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.99 seconds
18:01:31.928810 [debug] [Thread-1  ]: finished collecting timing info
18:01:31.928810 [debug] [Thread-1  ]: On model.prj_dbt.stg_conversion_date: Close
18:01:32.060656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ced75e-19dd-41b4-a48e-9578adabb9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1D334C40>]}
18:01:32.061653 [info ] [Thread-1  ]: 1 of 7 OK created view model CUSTOMERS.stg_conversion_date ..................... [[32mSUCCESS 1[0m in 1.19s]
18:01:32.062653 [debug] [Thread-1  ]: Finished running node model.prj_dbt.stg_conversion_date
18:01:32.118660 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.18 seconds
18:01:32.119660 [debug] [Thread-2  ]: finished collecting timing info
18:01:32.120690 [debug] [Thread-2  ]: On model.prj_dbt.stg_leads: Close
18:01:32.230171 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ced75e-19dd-41b4-a48e-9578adabb9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1D3BBD00>]}
18:01:32.230171 [info ] [Thread-2  ]: 2 of 7 OK created view model CUSTOMERS.stg_leads ............................... [[32mSUCCESS 1[0m in 1.36s]
18:01:32.231196 [debug] [Thread-2  ]: Finished running node model.prj_dbt.stg_leads
18:01:32.233164 [debug] [Thread-5  ]: Began running node model.prj_dbt.converted_comprehensive
18:01:32.233164 [debug] [Thread-6  ]: Began running node model.prj_dbt.converted_counts_time_source
18:01:32.233164 [debug] [Thread-7  ]: Began running node model.prj_dbt.converted_drivers_closed_won
18:01:32.234163 [debug] [Thread-8  ]: Began running node model.prj_dbt.converted_drivers_converted
18:01:32.234163 [info ] [Thread-5  ]: 4 of 7 START view model CUSTOMERS.converted_comprehensive ...................... [RUN]
18:01:32.235160 [info ] [Thread-6  ]: 5 of 7 START view model CUSTOMERS.converted_counts_time_source ................. [RUN]
18:01:32.235160 [info ] [Thread-7  ]: 6 of 7 START view model CUSTOMERS.converted_drivers_closed_won ................. [RUN]
18:01:32.236157 [info ] [Thread-8  ]: 7 of 7 START view model CUSTOMERS.converted_drivers_converted .................. [RUN]
18:01:32.237154 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.prj_dbt.converted_comprehensive"
18:01:32.238151 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.prj_dbt.converted_counts_time_source"
18:01:32.239150 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.prj_dbt.converted_drivers_closed_won"
18:01:32.239150 [debug] [Thread-5  ]: Began compiling node model.prj_dbt.converted_comprehensive
18:01:32.240165 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.prj_dbt.converted_drivers_converted"
18:01:32.241143 [debug] [Thread-6  ]: Began compiling node model.prj_dbt.converted_counts_time_source
18:01:32.241143 [debug] [Thread-7  ]: Began compiling node model.prj_dbt.converted_drivers_closed_won
18:01:32.242142 [debug] [Thread-5  ]: Compiling model.prj_dbt.converted_comprehensive
18:01:32.242142 [debug] [Thread-8  ]: Began compiling node model.prj_dbt.converted_drivers_converted
18:01:32.243137 [debug] [Thread-6  ]: Compiling model.prj_dbt.converted_counts_time_source
18:01:32.243137 [debug] [Thread-7  ]: Compiling model.prj_dbt.converted_drivers_closed_won
18:01:32.248125 [debug] [Thread-5  ]: Writing injected SQL for node "model.prj_dbt.converted_comprehensive"
18:01:32.248125 [debug] [Thread-8  ]: Compiling model.prj_dbt.converted_drivers_converted
18:01:32.253110 [debug] [Thread-6  ]: Writing injected SQL for node "model.prj_dbt.converted_counts_time_source"
18:01:32.256102 [debug] [Thread-7  ]: Writing injected SQL for node "model.prj_dbt.converted_drivers_closed_won"
18:01:32.261092 [debug] [Thread-8  ]: Writing injected SQL for node "model.prj_dbt.converted_drivers_converted"
18:01:32.262089 [debug] [Thread-5  ]: finished collecting timing info
18:01:32.263085 [debug] [Thread-5  ]: Began executing node model.prj_dbt.converted_comprehensive
18:01:32.269068 [debug] [Thread-5  ]: Writing runtime SQL for node "model.prj_dbt.converted_comprehensive"
18:01:32.269068 [debug] [Thread-6  ]: finished collecting timing info
18:01:32.270065 [debug] [Thread-8  ]: finished collecting timing info
18:01:32.270065 [debug] [Thread-6  ]: Began executing node model.prj_dbt.converted_counts_time_source
18:01:32.270065 [debug] [Thread-7  ]: finished collecting timing info
18:01:32.271063 [debug] [Thread-8  ]: Began executing node model.prj_dbt.converted_drivers_converted
18:01:32.278048 [debug] [Thread-6  ]: Writing runtime SQL for node "model.prj_dbt.converted_counts_time_source"
18:01:32.280038 [debug] [Thread-5  ]: Using snowflake connection "model.prj_dbt.converted_comprehensive"
18:01:32.280038 [debug] [Thread-7  ]: Began executing node model.prj_dbt.converted_drivers_closed_won
18:01:32.285028 [debug] [Thread-8  ]: Writing runtime SQL for node "model.prj_dbt.converted_drivers_converted"
18:01:32.286022 [debug] [Thread-5  ]: On model.prj_dbt.converted_comprehensive: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.converted_comprehensive"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.converted_comprehensive
  
   as (
    -- MODEL TO FACILITATE REGRESSION AND ML ANALYSES

with leads as (

    select
      lead_id,
      source,
      job_title,
      state,
      industry,
      fleet_size
    from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select
      lead_id,
      month,
      week,
      day,
      month_name,
      day_name
    from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

),

opportunities as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_opportunities

)

select *
   from leads
   inner join opportunities
       using (lead_id)
   inner join conversion_date
       using (lead_id)
  );
18:01:32.292025 [debug] [Thread-7  ]: Writing runtime SQL for node "model.prj_dbt.converted_drivers_closed_won"
18:01:32.294998 [debug] [Thread-6  ]: Using snowflake connection "model.prj_dbt.converted_counts_time_source"
18:01:32.296017 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:01:32.296994 [debug] [Thread-6  ]: On model.prj_dbt.converted_counts_time_source: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.converted_counts_time_source"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.converted_counts_time_source
  
   as (
    --

with leads as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_leads

),

conversion_date as (

    select * from FLEETIO_DBT.CUSTOMERS.stg_conversion_date

)

select
    leads.lead_id,
    leads.source,
    conversion_date.month,
    conversion_date.week,
    conversion_date.day,
    conversion_date.month_name,
    conversion_date.day_name
from conversion_date
left join leads
    using (lead_id)
  );
18:01:32.299985 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:01:32.300985 [debug] [Thread-8  ]: Using snowflake connection "model.prj_dbt.converted_drivers_converted"
18:01:32.304971 [debug] [Thread-7  ]: Using snowflake connection "model.prj_dbt.converted_drivers_closed_won"
18:01:32.306966 [debug] [Thread-8  ]: On model.prj_dbt.converted_drivers_converted: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.converted_drivers_converted"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.converted_drivers_converted
  
   as (
    --

select * from FLEETIO_DBT.CUSTOMERS.stg_leads
  );
18:01:32.308962 [debug] [Thread-7  ]: On model.prj_dbt.converted_drivers_closed_won: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "prj_dbt", "target_name": "dev", "node_id": "model.prj_dbt.converted_drivers_closed_won"} */

  create or replace  view FLEETIO_DBT.CUSTOMERS.converted_drivers_closed_won
  
   as (
    --

with opportunities as (

  select * from FLEETIO_DBT.CUSTOMERS.stg_opportunities

),

leads as (

  select *
  from FLEETIO_DBT.CUSTOMERS.stg_leads
  where is_converted = 1

)

select
  *
from opportunities
inner join leads
  using (lead_id)
  );
18:01:32.311954 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:01:32.312951 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:01:33.069511 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 0.77 seconds
18:01:33.071535 [debug] [Thread-6  ]: finished collecting timing info
18:01:33.071535 [debug] [Thread-6  ]: On model.prj_dbt.converted_counts_time_source: Close
18:01:33.243163 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 0.93 seconds
18:01:33.245188 [debug] [Thread-8  ]: finished collecting timing info
18:01:33.245188 [debug] [Thread-8  ]: On model.prj_dbt.converted_drivers_converted: Close
18:01:33.253140 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ced75e-19dd-41b4-a48e-9578adabb9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1D42C7F0>]}
18:01:33.253140 [info ] [Thread-6  ]: 5 of 7 OK created view model CUSTOMERS.converted_counts_time_source ............ [[32mSUCCESS 1[0m in 1.01s]
18:01:33.255133 [debug] [Thread-6  ]: Finished running node model.prj_dbt.converted_counts_time_source
18:01:33.369881 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ced75e-19dd-41b4-a48e-9578adabb9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1D4361F0>]}
18:01:33.369881 [info ] [Thread-8  ]: 7 of 7 OK created view model CUSTOMERS.converted_drivers_converted ............. [[32mSUCCESS 1[0m in 1.13s]
18:01:33.370878 [debug] [Thread-8  ]: Finished running node model.prj_dbt.converted_drivers_converted
18:01:33.400732 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.09 seconds
18:01:33.401729 [debug] [Thread-7  ]: finished collecting timing info
18:01:33.402728 [debug] [Thread-7  ]: On model.prj_dbt.converted_drivers_closed_won: Close
18:01:34.022042 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ced75e-19dd-41b4-a48e-9578adabb9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1D436C40>]}
18:01:34.024066 [info ] [Thread-7  ]: 6 of 7 OK created view model CUSTOMERS.converted_drivers_closed_won ............ [[32mSUCCESS 1[0m in 1.78s]
18:01:34.027439 [debug] [Thread-7  ]: Finished running node model.prj_dbt.converted_drivers_closed_won
18:01:34.512435 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.22 seconds
18:01:34.514463 [debug] [Thread-5  ]: finished collecting timing info
18:01:34.514463 [debug] [Thread-5  ]: On model.prj_dbt.converted_comprehensive: Close
18:01:34.613662 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ced75e-19dd-41b4-a48e-9578adabb9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1D4625B0>]}
18:01:34.613662 [info ] [Thread-5  ]: 4 of 7 OK created view model CUSTOMERS.converted_comprehensive ................. [[32mSUCCESS 1[0m in 2.38s]
18:01:34.614659 [debug] [Thread-5  ]: Finished running node model.prj_dbt.converted_comprehensive
18:01:34.617654 [debug] [MainThread]: Acquiring new snowflake connection "master"
18:01:34.617654 [info ] [MainThread]: 
18:01:34.618649 [info ] [MainThread]: Finished running 7 view models in 5.66s.
18:01:34.619646 [debug] [MainThread]: Connection 'master' was properly closed.
18:01:34.619646 [debug] [MainThread]: Connection 'list_FLEETIO_DBT' was properly closed.
18:01:34.620644 [debug] [MainThread]: Connection 'list_FLEETIO_DBT_CUSTOMERS' was properly closed.
18:01:34.620644 [debug] [MainThread]: Connection 'model.prj_dbt.stg_conversion_date' was properly closed.
18:01:34.620644 [debug] [MainThread]: Connection 'model.prj_dbt.stg_leads' was properly closed.
18:01:34.621641 [debug] [MainThread]: Connection 'model.prj_dbt.stg_opportunities' was properly closed.
18:01:34.621641 [debug] [MainThread]: Connection 'model.prj_dbt.converted_comprehensive' was properly closed.
18:01:34.621641 [debug] [MainThread]: Connection 'model.prj_dbt.converted_counts_time_source' was properly closed.
18:01:34.622638 [debug] [MainThread]: Connection 'model.prj_dbt.converted_drivers_closed_won' was properly closed.
18:01:34.622638 [debug] [MainThread]: Connection 'model.prj_dbt.converted_drivers_converted' was properly closed.
18:01:34.634606 [info ] [MainThread]: 
18:01:34.636601 [info ] [MainThread]: [32mCompleted successfully[0m
18:01:34.637599 [info ] [MainThread]: 
18:01:34.638596 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:01:34.639593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1CFBBA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1CFBBA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C1CF85610>]}
